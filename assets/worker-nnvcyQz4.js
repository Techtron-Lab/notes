var pr=Object.defineProperty;var $t=ve=>{throw TypeError(ve)};var hr=(ve,ke,Fe)=>ke in ve?pr(ve,ke,{enumerable:!0,configurable:!0,writable:!0,value:Fe}):ve[ke]=Fe;var Qe=(ve,ke,Fe)=>hr(ve,typeof ke!="symbol"?ke+"":ke,Fe),At=(ve,ke,Fe)=>ke.has(ve)||$t("Cannot "+Fe);var ee=(ve,ke,Fe)=>(At(ve,ke,"read from private field"),Fe?Fe.call(ve):ke.get(ve)),Ue=(ve,ke,Fe)=>ke.has(ve)?$t("Cannot add the same private member more than once"):ke instanceof WeakSet?ke.add(ve):ke.set(ve,Fe),He=(ve,ke,Fe,De)=>(At(ve,ke,"write to private field"),De?De.call(ve,Fe):ke.set(ve,Fe),Fe),ht=(ve,ke,Fe)=>(At(ve,ke,"access private method"),Fe);(function(){"use strict";async function ve(Te={}){var Vt;var ie,_=Te,Oe=typeof window=="object",Le=typeof WorkerGlobalScope<"u";typeof process=="object"&&((Vt=process.versions)!=null&&Vt.node)&&process.type!="renderer",(function(e){const n=globalThis.sqlite3InitModuleState||Object.assign(Object.create(null),{debugModule:()=>{console.warn("globalThis.sqlite3InitModuleState is missing")}});delete globalThis.sqlite3InitModuleState,n.debugModule("pre-js.js sqlite3InitModuleState =",n),e.locateFile=(function(s,t){return new URL(s,self.location.href).href}).bind(n),e.instantiateWasm=(function(t,c){const i=this,r=e.locateFile(i.wasmFilename,typeof Me>"u"?"":Me);i.debugModule("instantiateWasm() uri =",r,"sIMS =",this);const u=()=>fetch(r,{credentials:"same-origin"}),T=J=>{J.imports=t,i.instantiateWasm=J,c(J.instance,J.module)};return(WebAssembly.instantiateStreaming?async()=>WebAssembly.instantiateStreaming(u(),t).then(T):async()=>u().then(J=>J.arrayBuffer()).then(J=>WebAssembly.instantiate(J,t)).then(T))()}).bind(n)})(_);var Ee="./this.program",Ae=self.location.href,Me="";function Je(e){return _.locateFile?_.locateFile(e,Me):Me+e}var Ve,Xe;if(Oe||Le){try{Me=new URL(".",Ae).href}catch{}Le&&(Xe=e=>{var n=new XMLHttpRequest;return n.open("GET",e,!1),n.responseType="arraybuffer",n.send(null),new Uint8Array(n.response)}),Ve=async e=>{var n=await fetch(e,{credentials:"same-origin"});if(n.ok)return n.arrayBuffer();throw new Error(n.status+" : "+n.url)}}var _e=console.log.bind(console),Ie=console.error.bind(console),We,nt=!1,rt,it,$e,ze,Ye,at,ge,Pe,je,kt=!1;function Tt(){var e=$e.buffer;ze=new Int8Array(e),at=new Int16Array(e),Ye=new Uint8Array(e),ge=new Int32Array(e),Pe=new Uint32Array(e),je=new BigInt64Array(e),new BigUint64Array(e)}function Kt(){if(_.wasmMemory)$e=_.wasmMemory;else{var e=_.INITIAL_MEMORY||8388608;$e=new WebAssembly.Memory({initial:e/65536,maximum:32768})}Tt()}function Jt(){if(_.preRun)for(typeof _.preRun=="function"&&(_.preRun=[_.preRun]);_.preRun.length;)cn(_.preRun.shift());Ft(Pt)}function Xt(){kt=!0,!_.noFSInit&&!a.initialized&&a.init(),lt.__wasm_call_ctors(),a.ignorePermissions=!1}function Yt(){if(_.postRun)for(typeof _.postRun=="function"&&(_.postRun=[_.postRun]);_.postRun.length;)an(_.postRun.shift());Ft(Ot)}var Ze=0,ct=null;function xt(e){var n;Ze++,(n=_.monitorRunDependencies)==null||n.call(_,Ze)}function gt(e){var s;if(Ze--,(s=_.monitorRunDependencies)==null||s.call(_,Ze),Ze==0&&ct){var n=ct;ct=null,n()}}function Zt(e){var s;(s=_.onAbort)==null||s.call(_,e),e="Aborted("+e+")",Ie(e),nt=!0,e+=". Build with -sASSERTIONS for more info.";var n=new WebAssembly.RuntimeError(e);throw it==null||it(n),n}var bt;function en(){return _.locateFile?Je("sqlite3.wasm"):new URL(""+new URL("sqlite3-1f8bVu-G.wasm",self.location.href).href,self.location.href).href}function tn(e){if(e==bt&&We)return new Uint8Array(We);if(Xe)return Xe(e);throw"both async and sync fetching of the wasm failed"}async function nn(e){if(!We)try{var n=await Ve(e);return new Uint8Array(n)}catch{}return tn(e)}async function rn(e,n){try{var s=await nn(e),t=await WebAssembly.instantiate(s,n);return t}catch(c){Ie(`failed to asynchronously prepare wasm: ${c}`),Zt(c)}}async function sn(e,n,s){if(!e)try{var t=fetch(n,{credentials:"same-origin"}),c=await WebAssembly.instantiateStreaming(t,s);return c}catch(i){Ie(`wasm streaming compile failed: ${i}`),Ie("falling back to ArrayBuffer instantiation")}return rn(n,s)}function on(){return{env:Ht,wasi_snapshot_preview1:Ht}}async function ln(){function e(i,r){return lt=i.exports,cr(lt),gt(),lt}xt();function n(i){return e(i.instance)}var s=on();if(_.instantiateWasm)return new Promise((i,r)=>{_.instantiateWasm(s,(u,T)=>{i(e(u))})});bt??(bt=en());var t=await sn(We,bt,s),c=n(t);return c}var Ft=e=>{for(;e.length>0;)e.shift()(_)},Ot=[],an=e=>Ot.push(e),Pt=[],cn=e=>Pt.push(e),qe={isAbs:e=>e.charAt(0)==="/",splitPath:e=>{var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return n.exec(e).slice(1)},normalizeArray:(e,n)=>{for(var s=0,t=e.length-1;t>=0;t--){var c=e[t];c==="."?e.splice(t,1):c===".."?(e.splice(t,1),s++):s&&(e.splice(t,1),s--)}if(n)for(;s;s--)e.unshift("..");return e},normalize:e=>{var n=qe.isAbs(e),s=e.slice(-1)==="/";return e=qe.normalizeArray(e.split("/").filter(t=>!!t),!n).join("/"),!e&&!n&&(e="."),e&&s&&(e+="/"),(n?"/":"")+e},dirname:e=>{var n=qe.splitPath(e),s=n[0],t=n[1];return!s&&!t?".":(t&&(t=t.slice(0,-1)),s+t)},basename:e=>e&&e.match(/([^\/]+|\/)\/*$/)[1],join:(...e)=>qe.normalize(e.join("/")),join2:(e,n)=>qe.normalize(e+"/"+n)},un=()=>e=>crypto.getRandomValues(e),Lt=e=>{(Lt=un())(e)},st={resolve:(...e)=>{for(var n="",s=!1,t=e.length-1;t>=-1&&!s;t--){var c=t>=0?e[t]:a.cwd();if(typeof c!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!c)return"";n=c+"/"+n,s=qe.isAbs(c)}return n=qe.normalizeArray(n.split("/").filter(i=>!!i),!s).join("/"),(s?"/":"")+n||"."},relative:(e,n)=>{e=st.resolve(e).slice(1),n=st.resolve(n).slice(1);function s(P){for(var J=0;J<P.length&&P[J]==="";J++);for(var j=P.length-1;j>=0&&P[j]==="";j--);return J>j?[]:P.slice(J,j-J+1)}for(var t=s(e.split("/")),c=s(n.split("/")),i=Math.min(t.length,c.length),r=i,u=0;u<i;u++)if(t[u]!==c[u]){r=u;break}for(var T=[],u=r;u<t.length;u++)T.push("..");return T=T.concat(c.slice(r)),T.join("/")}},Nt=new TextDecoder,Ct=(e,n,s,t)=>{for(var c=n+s;e[n]&&!(n>=c);)++n;return n},ut=(e,n=0,s,t)=>{var c=Ct(e,n,s);return Nt.decode(e.buffer?e.subarray(n,c):new Uint8Array(e.slice(n,c)))},yt=[],dt=e=>{for(var n=0,s=0;s<e.length;++s){var t=e.charCodeAt(s);t<=127?n++:t<=2047?n+=2:t>=55296&&t<=57343?(n+=4,++s):n+=3}return n},Rt=(e,n,s,t)=>{if(!(t>0))return 0;for(var c=s,i=s+t-1,r=0;r<e.length;++r){var u=e.codePointAt(r);if(u<=127){if(s>=i)break;n[s++]=u}else if(u<=2047){if(s+1>=i)break;n[s++]=192|u>>6,n[s++]=128|u&63}else if(u<=65535){if(s+2>=i)break;n[s++]=224|u>>12,n[s++]=128|u>>6&63,n[s++]=128|u&63}else{if(s+3>=i)break;n[s++]=240|u>>18,n[s++]=128|u>>12&63,n[s++]=128|u>>6&63,n[s++]=128|u&63,r++}}return n[s]=0,s-c},qt=(e,n,s)=>{var t=dt(e)+1,c=new Array(t),i=Rt(e,c,0,c.length);return c.length=i,c},_n=()=>{if(!yt.length){var e=null;if(typeof window<"u"&&typeof window.prompt=="function"&&(e=window.prompt("Input: "),e!==null&&(e+=`
`)),!e)return null;yt=qt(e)}return yt.shift()},et={ttys:[],init(){},shutdown(){},register(e,n){et.ttys[e]={input:[],output:[],ops:n},a.registerDevice(e,et.stream_ops)},stream_ops:{open(e){var n=et.ttys[e.node.rdev];if(!n)throw new a.ErrnoError(43);e.tty=n,e.seekable=!1},close(e){e.tty.ops.fsync(e.tty)},fsync(e){e.tty.ops.fsync(e.tty)},read(e,n,s,t,c){if(!e.tty||!e.tty.ops.get_char)throw new a.ErrnoError(60);for(var i=0,r=0;r<t;r++){var u;try{u=e.tty.ops.get_char(e.tty)}catch{throw new a.ErrnoError(29)}if(u===void 0&&i===0)throw new a.ErrnoError(6);if(u==null)break;i++,n[s+r]=u}return i&&(e.node.atime=Date.now()),i},write(e,n,s,t,c){if(!e.tty||!e.tty.ops.put_char)throw new a.ErrnoError(60);try{for(var i=0;i<t;i++)e.tty.ops.put_char(e.tty,n[s+i])}catch{throw new a.ErrnoError(29)}return t&&(e.node.mtime=e.node.ctime=Date.now()),i}},default_tty_ops:{get_char(e){return _n()},put_char(e,n){n===null||n===10?(_e(ut(e.output)),e.output=[]):n!=0&&e.output.push(n)},fsync(e){var n;((n=e.output)==null?void 0:n.length)>0&&(_e(ut(e.output)),e.output=[])},ioctl_tcgets(e){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(e,n,s){return 0},ioctl_tiocgwinsz(e){return[24,80]}},default_tty1_ops:{put_char(e,n){n===null||n===10?(Ie(ut(e.output)),e.output=[]):n!=0&&e.output.push(n)},fsync(e){var n;((n=e.output)==null?void 0:n.length)>0&&(Ie(ut(e.output)),e.output=[])}}},fn=(e,n)=>Ye.fill(0,e,e+n),Dt=(e,n)=>Math.ceil(e/n)*n,Mt=e=>{e=Dt(e,65536);var n=Qt(65536,e);return n&&fn(n,e),n},de={ops_table:null,mount(e){return de.createNode(null,"/",16895,0)},createNode(e,n,s,t){if(a.isBlkdev(s)||a.isFIFO(s))throw new a.ErrnoError(63);de.ops_table||(de.ops_table={dir:{node:{getattr:de.node_ops.getattr,setattr:de.node_ops.setattr,lookup:de.node_ops.lookup,mknod:de.node_ops.mknod,rename:de.node_ops.rename,unlink:de.node_ops.unlink,rmdir:de.node_ops.rmdir,readdir:de.node_ops.readdir,symlink:de.node_ops.symlink},stream:{llseek:de.stream_ops.llseek}},file:{node:{getattr:de.node_ops.getattr,setattr:de.node_ops.setattr},stream:{llseek:de.stream_ops.llseek,read:de.stream_ops.read,write:de.stream_ops.write,mmap:de.stream_ops.mmap,msync:de.stream_ops.msync}},link:{node:{getattr:de.node_ops.getattr,setattr:de.node_ops.setattr,readlink:de.node_ops.readlink},stream:{}},chrdev:{node:{getattr:de.node_ops.getattr,setattr:de.node_ops.setattr},stream:a.chrdev_stream_ops}});var c=a.createNode(e,n,s,t);return a.isDir(c.mode)?(c.node_ops=de.ops_table.dir.node,c.stream_ops=de.ops_table.dir.stream,c.contents={}):a.isFile(c.mode)?(c.node_ops=de.ops_table.file.node,c.stream_ops=de.ops_table.file.stream,c.usedBytes=0,c.contents=null):a.isLink(c.mode)?(c.node_ops=de.ops_table.link.node,c.stream_ops=de.ops_table.link.stream):a.isChrdev(c.mode)&&(c.node_ops=de.ops_table.chrdev.node,c.stream_ops=de.ops_table.chrdev.stream),c.atime=c.mtime=c.ctime=Date.now(),e&&(e.contents[n]=c,e.atime=e.mtime=e.ctime=c.atime),c},getFileDataAsTypedArray(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage(e,n){var s=e.contents?e.contents.length:0;if(!(s>=n)){var t=1024*1024;n=Math.max(n,s*(s<t?2:1.125)>>>0),s!=0&&(n=Math.max(n,256));var c=e.contents;e.contents=new Uint8Array(n),e.usedBytes>0&&e.contents.set(c.subarray(0,e.usedBytes),0)}},resizeFileStorage(e,n){if(e.usedBytes!=n)if(n==0)e.contents=null,e.usedBytes=0;else{var s=e.contents;e.contents=new Uint8Array(n),s&&e.contents.set(s.subarray(0,Math.min(n,e.usedBytes))),e.usedBytes=n}},node_ops:{getattr(e){var n={};return n.dev=a.isChrdev(e.mode)?e.id:1,n.ino=e.id,n.mode=e.mode,n.nlink=1,n.uid=0,n.gid=0,n.rdev=e.rdev,a.isDir(e.mode)?n.size=4096:a.isFile(e.mode)?n.size=e.usedBytes:a.isLink(e.mode)?n.size=e.link.length:n.size=0,n.atime=new Date(e.atime),n.mtime=new Date(e.mtime),n.ctime=new Date(e.ctime),n.blksize=4096,n.blocks=Math.ceil(n.size/n.blksize),n},setattr(e,n){for(const s of["mode","atime","mtime","ctime"])n[s]!=null&&(e[s]=n[s]);n.size!==void 0&&de.resizeFileStorage(e,n.size)},lookup(e,n){throw de.doesNotExistError||(de.doesNotExistError=new a.ErrnoError(44),de.doesNotExistError.stack="<generic error, no stack>"),de.doesNotExistError},mknod(e,n,s,t){return de.createNode(e,n,s,t)},rename(e,n,s){var t;try{t=a.lookupNode(n,s)}catch{}if(t){if(a.isDir(e.mode))for(var c in t.contents)throw new a.ErrnoError(55);a.hashRemoveNode(t)}delete e.parent.contents[e.name],n.contents[s]=e,e.name=s,n.ctime=n.mtime=e.parent.ctime=e.parent.mtime=Date.now()},unlink(e,n){delete e.contents[n],e.ctime=e.mtime=Date.now()},rmdir(e,n){var s=a.lookupNode(e,n);for(var t in s.contents)throw new a.ErrnoError(55);delete e.contents[n],e.ctime=e.mtime=Date.now()},readdir(e){return[".","..",...Object.keys(e.contents)]},symlink(e,n,s){var t=de.createNode(e,n,41471,0);return t.link=s,t},readlink(e){if(!a.isLink(e.mode))throw new a.ErrnoError(28);return e.link}},stream_ops:{read(e,n,s,t,c){var i=e.node.contents;if(c>=e.node.usedBytes)return 0;var r=Math.min(e.node.usedBytes-c,t);if(r>8&&i.subarray)n.set(i.subarray(c,c+r),s);else for(var u=0;u<r;u++)n[s+u]=i[c+u];return r},write(e,n,s,t,c,i){if(n.buffer===ze.buffer&&(i=!1),!t)return 0;var r=e.node;if(r.mtime=r.ctime=Date.now(),n.subarray&&(!r.contents||r.contents.subarray)){if(i)return r.contents=n.subarray(s,s+t),r.usedBytes=t,t;if(r.usedBytes===0&&c===0)return r.contents=n.slice(s,s+t),r.usedBytes=t,t;if(c+t<=r.usedBytes)return r.contents.set(n.subarray(s,s+t),c),t}if(de.expandFileStorage(r,c+t),r.contents.subarray&&n.subarray)r.contents.set(n.subarray(s,s+t),c);else for(var u=0;u<t;u++)r.contents[c+u]=n[s+u];return r.usedBytes=Math.max(r.usedBytes,c+t),t},llseek(e,n,s){var t=n;if(s===1?t+=e.position:s===2&&a.isFile(e.node.mode)&&(t+=e.node.usedBytes),t<0)throw new a.ErrnoError(28);return t},mmap(e,n,s,t,c){if(!a.isFile(e.node.mode))throw new a.ErrnoError(43);var i,r,u=e.node.contents;if(!(c&2)&&u&&u.buffer===ze.buffer)r=!1,i=u.byteOffset;else{if(r=!0,i=Mt(n),!i)throw new a.ErrnoError(48);u&&((s>0||s+n<u.length)&&(u.subarray?u=u.subarray(s,s+n):u=Array.prototype.slice.call(u,s,s+n)),ze.set(u,i))}return{ptr:i,allocated:r}},msync(e,n,s,t,c){return de.stream_ops.write(e,n,0,t,s,!1),0}}},dn=async e=>{var n=await Ve(e);return new Uint8Array(n)},pn=(...e)=>a.createDataFile(...e),jt=[],hn=(e,n,s,t)=>{typeof Browser<"u"&&Browser.init();var c=!1;return jt.forEach(i=>{c||i.canHandle(n)&&(i.handle(e,n,s,t),c=!0)}),c},mn=(e,n,s,t,c,i,r,u,T,P)=>{var J=n?st.resolve(qe.join2(e,n)):e;function j(I){function F(x){P==null||P(),u||pn(e,n,x,t,c,T),i==null||i(),gt()}hn(I,J,F,()=>{r==null||r(),gt()})||F(I)}xt(),typeof s=="string"?dn(s).then(j,r):j(s)},gn=e=>{var n={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},s=n[e];if(typeof s>"u")throw new Error(`Unknown file open mode: ${e}`);return s},vt=(e,n)=>{var s=0;return e&&(s|=365),n&&(s|=146),s},a={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,filesystems:null,syncFSRequests:0,readFiles:{},ErrnoError:class{constructor(e){Qe(this,"name","ErrnoError");this.errno=e}},FSStream:class{constructor(){Qe(this,"shared",{})}get object(){return this.node}set object(e){this.node=e}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(e){this.shared.flags=e}get position(){return this.shared.position}set position(e){this.shared.position=e}},FSNode:class{constructor(e,n,s,t){Qe(this,"node_ops",{});Qe(this,"stream_ops",{});Qe(this,"readMode",365);Qe(this,"writeMode",146);Qe(this,"mounted",null);e||(e=this),this.parent=e,this.mount=e.mount,this.id=a.nextInode++,this.name=n,this.mode=s,this.rdev=t,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&this.readMode)===this.readMode}set read(e){e?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(e){e?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return a.isDir(this.mode)}get isDevice(){return a.isChrdev(this.mode)}},lookupPath(e,n={}){if(!e)throw new a.ErrnoError(44);n.follow_mount??(n.follow_mount=!0),qe.isAbs(e)||(e=a.cwd()+"/"+e);e:for(var s=0;s<40;s++){for(var t=e.split("/").filter(P=>!!P),c=a.root,i="/",r=0;r<t.length;r++){var u=r===t.length-1;if(u&&n.parent)break;if(t[r]!=="."){if(t[r]===".."){if(i=qe.dirname(i),a.isRoot(c)){e=i+"/"+t.slice(r+1).join("/"),s--;continue e}else c=c.parent;continue}i=qe.join2(i,t[r]);try{c=a.lookupNode(c,t[r])}catch(P){if((P==null?void 0:P.errno)===44&&u&&n.noent_okay)return{path:i};throw P}if(a.isMountpoint(c)&&(!u||n.follow_mount)&&(c=c.mounted.root),a.isLink(c.mode)&&(!u||n.follow)){if(!c.node_ops.readlink)throw new a.ErrnoError(52);var T=c.node_ops.readlink(c);qe.isAbs(T)||(T=qe.dirname(i)+"/"+T),e=T+"/"+t.slice(r+1).join("/");continue e}}}return{path:i,node:c}}throw new a.ErrnoError(32)},getPath(e){for(var n;;){if(a.isRoot(e)){var s=e.mount.mountpoint;return n?s[s.length-1]!=="/"?`${s}/${n}`:s+n:s}n=n?`${e.name}/${n}`:e.name,e=e.parent}},hashName(e,n){for(var s=0,t=0;t<n.length;t++)s=(s<<5)-s+n.charCodeAt(t)|0;return(e+s>>>0)%a.nameTable.length},hashAddNode(e){var n=a.hashName(e.parent.id,e.name);e.name_next=a.nameTable[n],a.nameTable[n]=e},hashRemoveNode(e){var n=a.hashName(e.parent.id,e.name);if(a.nameTable[n]===e)a.nameTable[n]=e.name_next;else for(var s=a.nameTable[n];s;){if(s.name_next===e){s.name_next=e.name_next;break}s=s.name_next}},lookupNode(e,n){var s=a.mayLookup(e);if(s)throw new a.ErrnoError(s);for(var t=a.hashName(e.id,n),c=a.nameTable[t];c;c=c.name_next){var i=c.name;if(c.parent.id===e.id&&i===n)return c}return a.lookup(e,n)},createNode(e,n,s,t){var c=new a.FSNode(e,n,s,t);return a.hashAddNode(c),c},destroyNode(e){a.hashRemoveNode(e)},isRoot(e){return e===e.parent},isMountpoint(e){return!!e.mounted},isFile(e){return(e&61440)===32768},isDir(e){return(e&61440)===16384},isLink(e){return(e&61440)===40960},isChrdev(e){return(e&61440)===8192},isBlkdev(e){return(e&61440)===24576},isFIFO(e){return(e&61440)===4096},isSocket(e){return(e&49152)===49152},flagsToPermissionString(e){var n=["r","w","rw"][e&3];return e&512&&(n+="w"),n},nodePermissions(e,n){return a.ignorePermissions?0:n.includes("r")&&!(e.mode&292)||n.includes("w")&&!(e.mode&146)||n.includes("x")&&!(e.mode&73)?2:0},mayLookup(e){if(!a.isDir(e.mode))return 54;var n=a.nodePermissions(e,"x");return n||(e.node_ops.lookup?0:2)},mayCreate(e,n){if(!a.isDir(e.mode))return 54;try{var s=a.lookupNode(e,n);return 20}catch{}return a.nodePermissions(e,"wx")},mayDelete(e,n,s){var t;try{t=a.lookupNode(e,n)}catch(i){return i.errno}var c=a.nodePermissions(e,"wx");if(c)return c;if(s){if(!a.isDir(t.mode))return 54;if(a.isRoot(t)||a.getPath(t)===a.cwd())return 10}else if(a.isDir(t.mode))return 31;return 0},mayOpen(e,n){return e?a.isLink(e.mode)?32:a.isDir(e.mode)&&(a.flagsToPermissionString(n)!=="r"||n&576)?31:a.nodePermissions(e,a.flagsToPermissionString(n)):44},checkOpExists(e,n){if(!e)throw new a.ErrnoError(n);return e},MAX_OPEN_FDS:4096,nextfd(){for(var e=0;e<=a.MAX_OPEN_FDS;e++)if(!a.streams[e])return e;throw new a.ErrnoError(33)},getStreamChecked(e){var n=a.getStream(e);if(!n)throw new a.ErrnoError(8);return n},getStream:e=>a.streams[e],createStream(e,n=-1){return e=Object.assign(new a.FSStream,e),n==-1&&(n=a.nextfd()),e.fd=n,a.streams[n]=e,e},closeStream(e){a.streams[e]=null},dupStream(e,n=-1){var t,c;var s=a.createStream(e,n);return(c=(t=s.stream_ops)==null?void 0:t.dup)==null||c.call(t,s),s},doSetAttr(e,n,s){var t=e==null?void 0:e.stream_ops.setattr,c=t?e:n;t??(t=n.node_ops.setattr),a.checkOpExists(t,63),t(c,s)},chrdev_stream_ops:{open(e){var s,t;var n=a.getDevice(e.node.rdev);e.stream_ops=n.stream_ops,(t=(s=e.stream_ops).open)==null||t.call(s,e)},llseek(){throw new a.ErrnoError(70)}},major:e=>e>>8,minor:e=>e&255,makedev:(e,n)=>e<<8|n,registerDevice(e,n){a.devices[e]={stream_ops:n}},getDevice:e=>a.devices[e],getMounts(e){for(var n=[],s=[e];s.length;){var t=s.pop();n.push(t),s.push(...t.mounts)}return n},syncfs(e,n){typeof e=="function"&&(n=e,e=!1),a.syncFSRequests++,a.syncFSRequests>1&&Ie(`warning: ${a.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var s=a.getMounts(a.root.mount),t=0;function c(r){return a.syncFSRequests--,n(r)}function i(r){if(r)return i.errored?void 0:(i.errored=!0,c(r));++t>=s.length&&c(null)}s.forEach(r=>{if(!r.type.syncfs)return i(null);r.type.syncfs(r,e,i)})},mount(e,n,s){var t=s==="/",c=!s,i;if(t&&a.root)throw new a.ErrnoError(10);if(!t&&!c){var r=a.lookupPath(s,{follow_mount:!1});if(s=r.path,i=r.node,a.isMountpoint(i))throw new a.ErrnoError(10);if(!a.isDir(i.mode))throw new a.ErrnoError(54)}var u={type:e,opts:n,mountpoint:s,mounts:[]},T=e.mount(u);return T.mount=u,u.root=T,t?a.root=T:i&&(i.mounted=u,i.mount&&i.mount.mounts.push(u)),T},unmount(e){var n=a.lookupPath(e,{follow_mount:!1});if(!a.isMountpoint(n.node))throw new a.ErrnoError(28);var s=n.node,t=s.mounted,c=a.getMounts(t);Object.keys(a.nameTable).forEach(r=>{for(var u=a.nameTable[r];u;){var T=u.name_next;c.includes(u.mount)&&a.destroyNode(u),u=T}}),s.mounted=null;var i=s.mount.mounts.indexOf(t);s.mount.mounts.splice(i,1)},lookup(e,n){return e.node_ops.lookup(e,n)},mknod(e,n,s){var t=a.lookupPath(e,{parent:!0}),c=t.node,i=qe.basename(e);if(!i)throw new a.ErrnoError(28);if(i==="."||i==="..")throw new a.ErrnoError(20);var r=a.mayCreate(c,i);if(r)throw new a.ErrnoError(r);if(!c.node_ops.mknod)throw new a.ErrnoError(63);return c.node_ops.mknod(c,i,n,s)},statfs(e){return a.statfsNode(a.lookupPath(e,{follow:!0}).node)},statfsStream(e){return a.statfsNode(e.node)},statfsNode(e){var n={bsize:4096,frsize:4096,blocks:1e6,bfree:5e5,bavail:5e5,files:a.nextInode,ffree:a.nextInode-1,fsid:42,flags:2,namelen:255};return e.node_ops.statfs&&Object.assign(n,e.node_ops.statfs(e.mount.opts.root)),n},create(e,n=438){return n&=4095,n|=32768,a.mknod(e,n,0)},mkdir(e,n=511){return n&=1023,n|=16384,a.mknod(e,n,0)},mkdirTree(e,n){var s=e.split("/"),t="";for(var c of s)if(c){(t||qe.isAbs(e))&&(t+="/"),t+=c;try{a.mkdir(t,n)}catch(i){if(i.errno!=20)throw i}}},mkdev(e,n,s){return typeof s>"u"&&(s=n,n=438),n|=8192,a.mknod(e,n,s)},symlink(e,n){if(!st.resolve(e))throw new a.ErrnoError(44);var s=a.lookupPath(n,{parent:!0}),t=s.node;if(!t)throw new a.ErrnoError(44);var c=qe.basename(n),i=a.mayCreate(t,c);if(i)throw new a.ErrnoError(i);if(!t.node_ops.symlink)throw new a.ErrnoError(63);return t.node_ops.symlink(t,c,e)},rename(e,n){var s=qe.dirname(e),t=qe.dirname(n),c=qe.basename(e),i=qe.basename(n),r,u,T;if(r=a.lookupPath(e,{parent:!0}),u=r.node,r=a.lookupPath(n,{parent:!0}),T=r.node,!u||!T)throw new a.ErrnoError(44);if(u.mount!==T.mount)throw new a.ErrnoError(75);var P=a.lookupNode(u,c),J=st.relative(e,t);if(J.charAt(0)!==".")throw new a.ErrnoError(28);if(J=st.relative(n,s),J.charAt(0)!==".")throw new a.ErrnoError(55);var j;try{j=a.lookupNode(T,i)}catch{}if(P!==j){var I=a.isDir(P.mode),F=a.mayDelete(u,c,I);if(F)throw new a.ErrnoError(F);if(F=j?a.mayDelete(T,i,I):a.mayCreate(T,i),F)throw new a.ErrnoError(F);if(!u.node_ops.rename)throw new a.ErrnoError(63);if(a.isMountpoint(P)||j&&a.isMountpoint(j))throw new a.ErrnoError(10);if(T!==u&&(F=a.nodePermissions(u,"w"),F))throw new a.ErrnoError(F);a.hashRemoveNode(P);try{u.node_ops.rename(P,T,i),P.parent=T}catch(x){throw x}finally{a.hashAddNode(P)}}},rmdir(e){var n=a.lookupPath(e,{parent:!0}),s=n.node,t=qe.basename(e),c=a.lookupNode(s,t),i=a.mayDelete(s,t,!0);if(i)throw new a.ErrnoError(i);if(!s.node_ops.rmdir)throw new a.ErrnoError(63);if(a.isMountpoint(c))throw new a.ErrnoError(10);s.node_ops.rmdir(s,t),a.destroyNode(c)},readdir(e){var n=a.lookupPath(e,{follow:!0}),s=n.node,t=a.checkOpExists(s.node_ops.readdir,54);return t(s)},unlink(e){var n=a.lookupPath(e,{parent:!0}),s=n.node;if(!s)throw new a.ErrnoError(44);var t=qe.basename(e),c=a.lookupNode(s,t),i=a.mayDelete(s,t,!1);if(i)throw new a.ErrnoError(i);if(!s.node_ops.unlink)throw new a.ErrnoError(63);if(a.isMountpoint(c))throw new a.ErrnoError(10);s.node_ops.unlink(s,t),a.destroyNode(c)},readlink(e){var n=a.lookupPath(e),s=n.node;if(!s)throw new a.ErrnoError(44);if(!s.node_ops.readlink)throw new a.ErrnoError(28);return s.node_ops.readlink(s)},stat(e,n){var s=a.lookupPath(e,{follow:!n}),t=s.node,c=a.checkOpExists(t.node_ops.getattr,63);return c(t)},fstat(e){var n=a.getStreamChecked(e),s=n.node,t=n.stream_ops.getattr,c=t?n:s;return t??(t=s.node_ops.getattr),a.checkOpExists(t,63),t(c)},lstat(e){return a.stat(e,!0)},doChmod(e,n,s,t){a.doSetAttr(e,n,{mode:s&4095|n.mode&-4096,ctime:Date.now(),dontFollow:t})},chmod(e,n,s){var t;if(typeof e=="string"){var c=a.lookupPath(e,{follow:!s});t=c.node}else t=e;a.doChmod(null,t,n,s)},lchmod(e,n){a.chmod(e,n,!0)},fchmod(e,n){var s=a.getStreamChecked(e);a.doChmod(s,s.node,n,!1)},doChown(e,n,s){a.doSetAttr(e,n,{timestamp:Date.now(),dontFollow:s})},chown(e,n,s,t){var c;if(typeof e=="string"){var i=a.lookupPath(e,{follow:!t});c=i.node}else c=e;a.doChown(null,c,t)},lchown(e,n,s){a.chown(e,n,s,!0)},fchown(e,n,s){var t=a.getStreamChecked(e);a.doChown(t,t.node,!1)},doTruncate(e,n,s){if(a.isDir(n.mode))throw new a.ErrnoError(31);if(!a.isFile(n.mode))throw new a.ErrnoError(28);var t=a.nodePermissions(n,"w");if(t)throw new a.ErrnoError(t);a.doSetAttr(e,n,{size:s,timestamp:Date.now()})},truncate(e,n){if(n<0)throw new a.ErrnoError(28);var s;if(typeof e=="string"){var t=a.lookupPath(e,{follow:!0});s=t.node}else s=e;a.doTruncate(null,s,n)},ftruncate(e,n){var s=a.getStreamChecked(e);if(n<0||(s.flags&2097155)===0)throw new a.ErrnoError(28);a.doTruncate(s,s.node,n)},utime(e,n,s){var t=a.lookupPath(e,{follow:!0}),c=t.node,i=a.checkOpExists(c.node_ops.setattr,63);i(c,{atime:n,mtime:s})},open(e,n,s=438){if(e==="")throw new a.ErrnoError(44);n=typeof n=="string"?gn(n):n,n&64?s=s&4095|32768:s=0;var t,c;if(typeof e=="object")t=e;else{c=e.endsWith("/");var i=a.lookupPath(e,{follow:!(n&131072),noent_okay:!0});t=i.node,e=i.path}var r=!1;if(n&64)if(t){if(n&128)throw new a.ErrnoError(20)}else{if(c)throw new a.ErrnoError(31);t=a.mknod(e,s|511,0),r=!0}if(!t)throw new a.ErrnoError(44);if(a.isChrdev(t.mode)&&(n&=-513),n&65536&&!a.isDir(t.mode))throw new a.ErrnoError(54);if(!r){var u=a.mayOpen(t,n);if(u)throw new a.ErrnoError(u)}n&512&&!r&&a.truncate(t,0),n&=-131713;var T=a.createStream({node:t,path:a.getPath(t),flags:n,seekable:!0,position:0,stream_ops:t.stream_ops,ungotten:[],error:!1});return T.stream_ops.open&&T.stream_ops.open(T),r&&a.chmod(t,s&511),_.logReadFiles&&!(n&1)&&(e in a.readFiles||(a.readFiles[e]=1)),T},close(e){if(a.isClosed(e))throw new a.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(n){throw n}finally{a.closeStream(e.fd)}e.fd=null},isClosed(e){return e.fd===null},llseek(e,n,s){if(a.isClosed(e))throw new a.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new a.ErrnoError(70);if(s!=0&&s!=1&&s!=2)throw new a.ErrnoError(28);return e.position=e.stream_ops.llseek(e,n,s),e.ungotten=[],e.position},read(e,n,s,t,c){if(t<0||c<0)throw new a.ErrnoError(28);if(a.isClosed(e))throw new a.ErrnoError(8);if((e.flags&2097155)===1)throw new a.ErrnoError(8);if(a.isDir(e.node.mode))throw new a.ErrnoError(31);if(!e.stream_ops.read)throw new a.ErrnoError(28);var i=typeof c<"u";if(!i)c=e.position;else if(!e.seekable)throw new a.ErrnoError(70);var r=e.stream_ops.read(e,n,s,t,c);return i||(e.position+=r),r},write(e,n,s,t,c,i){if(t<0||c<0)throw new a.ErrnoError(28);if(a.isClosed(e))throw new a.ErrnoError(8);if((e.flags&2097155)===0)throw new a.ErrnoError(8);if(a.isDir(e.node.mode))throw new a.ErrnoError(31);if(!e.stream_ops.write)throw new a.ErrnoError(28);e.seekable&&e.flags&1024&&a.llseek(e,0,2);var r=typeof c<"u";if(!r)c=e.position;else if(!e.seekable)throw new a.ErrnoError(70);var u=e.stream_ops.write(e,n,s,t,c,i);return r||(e.position+=u),u},mmap(e,n,s,t,c){if((t&2)!==0&&(c&2)===0&&(e.flags&2097155)!==2)throw new a.ErrnoError(2);if((e.flags&2097155)===1)throw new a.ErrnoError(2);if(!e.stream_ops.mmap)throw new a.ErrnoError(43);if(!n)throw new a.ErrnoError(28);return e.stream_ops.mmap(e,n,s,t,c)},msync(e,n,s,t,c){return e.stream_ops.msync?e.stream_ops.msync(e,n,s,t,c):0},ioctl(e,n,s){if(!e.stream_ops.ioctl)throw new a.ErrnoError(59);return e.stream_ops.ioctl(e,n,s)},readFile(e,n={}){if(n.flags=n.flags||0,n.encoding=n.encoding||"binary",n.encoding!=="utf8"&&n.encoding!=="binary")throw new Error(`Invalid encoding type "${n.encoding}"`);var s=a.open(e,n.flags),t=a.stat(e),c=t.size,i=new Uint8Array(c);return a.read(s,i,0,c,0),n.encoding==="utf8"&&(i=ut(i)),a.close(s),i},writeFile(e,n,s={}){s.flags=s.flags||577;var t=a.open(e,s.flags,s.mode);if(typeof n=="string"&&(n=new Uint8Array(qt(n))),ArrayBuffer.isView(n))a.write(t,n,0,n.byteLength,void 0,s.canOwn);else throw new Error("Unsupported data type");a.close(t)},cwd:()=>a.currentPath,chdir(e){var n=a.lookupPath(e,{follow:!0});if(n.node===null)throw new a.ErrnoError(44);if(!a.isDir(n.node.mode))throw new a.ErrnoError(54);var s=a.nodePermissions(n.node,"x");if(s)throw new a.ErrnoError(s);a.currentPath=n.path},createDefaultDirectories(){a.mkdir("/tmp"),a.mkdir("/home"),a.mkdir("/home/web_user")},createDefaultDevices(){a.mkdir("/dev"),a.registerDevice(a.makedev(1,3),{read:()=>0,write:(t,c,i,r,u)=>r,llseek:()=>0}),a.mkdev("/dev/null",a.makedev(1,3)),et.register(a.makedev(5,0),et.default_tty_ops),et.register(a.makedev(6,0),et.default_tty1_ops),a.mkdev("/dev/tty",a.makedev(5,0)),a.mkdev("/dev/tty1",a.makedev(6,0));var e=new Uint8Array(1024),n=0,s=()=>(n===0&&(Lt(e),n=e.byteLength),e[--n]);a.createDevice("/dev","random",s),a.createDevice("/dev","urandom",s),a.mkdir("/dev/shm"),a.mkdir("/dev/shm/tmp")},createSpecialDirectories(){a.mkdir("/proc");var e=a.mkdir("/proc/self");a.mkdir("/proc/self/fd"),a.mount({mount(){var n=a.createNode(e,"fd",16895,73);return n.stream_ops={llseek:de.stream_ops.llseek},n.node_ops={lookup(s,t){var c=+t,i=a.getStreamChecked(c),r={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>i.path},id:c+1};return r.parent=r,r},readdir(){return Array.from(a.streams.entries()).filter(([s,t])=>t).map(([s,t])=>s.toString())}},n}},{},"/proc/self/fd")},createStandardStreams(e,n,s){e?a.createDevice("/dev","stdin",e):a.symlink("/dev/tty","/dev/stdin"),n?a.createDevice("/dev","stdout",null,n):a.symlink("/dev/tty","/dev/stdout"),s?a.createDevice("/dev","stderr",null,s):a.symlink("/dev/tty1","/dev/stderr"),a.open("/dev/stdin",0),a.open("/dev/stdout",1),a.open("/dev/stderr",1)},staticInit(){a.nameTable=new Array(4096),a.mount(de,{},"/"),a.createDefaultDirectories(),a.createDefaultDevices(),a.createSpecialDirectories(),a.filesystems={MEMFS:de}},init(e,n,s){a.initialized=!0,e??(e=_.stdin),n??(n=_.stdout),s??(s=_.stderr),a.createStandardStreams(e,n,s)},quit(){a.initialized=!1;for(var e of a.streams)e&&a.close(e)},findObject(e,n){var s=a.analyzePath(e,n);return s.exists?s.object:null},analyzePath(e,n){try{var s=a.lookupPath(e,{follow:!n});e=s.path}catch{}var t={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var s=a.lookupPath(e,{parent:!0});t.parentExists=!0,t.parentPath=s.path,t.parentObject=s.node,t.name=qe.basename(e),s=a.lookupPath(e,{follow:!n}),t.exists=!0,t.path=s.path,t.object=s.node,t.name=s.node.name,t.isRoot=s.path==="/"}catch(c){t.error=c.errno}return t},createPath(e,n,s,t){e=typeof e=="string"?e:a.getPath(e);for(var c=n.split("/").reverse();c.length;){var i=c.pop();if(i){var r=qe.join2(e,i);try{a.mkdir(r)}catch(u){if(u.errno!=20)throw u}e=r}}return r},createFile(e,n,s,t,c){var i=qe.join2(typeof e=="string"?e:a.getPath(e),n),r=vt(t,c);return a.create(i,r)},createDataFile(e,n,s,t,c,i){var r=n;e&&(e=typeof e=="string"?e:a.getPath(e),r=n?qe.join2(e,n):e);var u=vt(t,c),T=a.create(r,u);if(s){if(typeof s=="string"){for(var P=new Array(s.length),J=0,j=s.length;J<j;++J)P[J]=s.charCodeAt(J);s=P}a.chmod(T,u|146);var I=a.open(T,577);a.write(I,s,0,s.length,0,i),a.close(I),a.chmod(T,u)}},createDevice(e,n,s,t){var u;var c=qe.join2(typeof e=="string"?e:a.getPath(e),n),i=vt(!!s,!!t);(u=a.createDevice).major??(u.major=64);var r=a.makedev(a.createDevice.major++,0);return a.registerDevice(r,{open(T){T.seekable=!1},close(T){var P;(P=t==null?void 0:t.buffer)!=null&&P.length&&t(10)},read(T,P,J,j,I){for(var F=0,x=0;x<j;x++){var L;try{L=s()}catch{throw new a.ErrnoError(29)}if(L===void 0&&F===0)throw new a.ErrnoError(6);if(L==null)break;F++,P[J+x]=L}return F&&(T.node.atime=Date.now()),F},write(T,P,J,j,I){for(var F=0;F<j;F++)try{t(P[J+F])}catch{throw new a.ErrnoError(29)}return j&&(T.node.mtime=T.node.ctime=Date.now()),F}}),a.mkdev(c,i,r)},forceLoadFile(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");try{e.contents=Xe(e.url),e.usedBytes=e.contents.length}catch{throw new a.ErrnoError(29)}},createLazyFile(e,n,s,t,c){class i{constructor(){Qe(this,"lengthKnown",!1);Qe(this,"chunks",[])}get(F){if(!(F>this.length-1||F<0)){var x=F%this.chunkSize,L=F/this.chunkSize|0;return this.getter(L)[x]}}setDataGetter(F){this.getter=F}cacheLength(){var F=new XMLHttpRequest;if(F.open("HEAD",s,!1),F.send(null),!(F.status>=200&&F.status<300||F.status===304))throw new Error("Couldn't load "+s+". Status: "+F.status);var x=Number(F.getResponseHeader("Content-length")),L,K=(L=F.getResponseHeader("Accept-Ranges"))&&L==="bytes",U=(L=F.getResponseHeader("Content-Encoding"))&&L==="gzip",g=1024*1024;K||(g=x);var q=(O,E)=>{if(O>E)throw new Error("invalid range ("+O+", "+E+") or no bytes requested!");if(E>x-1)throw new Error("only "+x+" bytes available! programmer error!");var A=new XMLHttpRequest;if(A.open("GET",s,!1),x!==g&&A.setRequestHeader("Range","bytes="+O+"-"+E),A.responseType="arraybuffer",A.overrideMimeType&&A.overrideMimeType("text/plain; charset=x-user-defined"),A.send(null),!(A.status>=200&&A.status<300||A.status===304))throw new Error("Couldn't load "+s+". Status: "+A.status);return A.response!==void 0?new Uint8Array(A.response||[]):qt(A.responseText||"")},w=this;w.setDataGetter(O=>{var E=O*g,A=(O+1)*g-1;if(A=Math.min(A,x-1),typeof w.chunks[O]>"u"&&(w.chunks[O]=q(E,A)),typeof w.chunks[O]>"u")throw new Error("doXHR failed!");return w.chunks[O]}),(U||!x)&&(g=x=1,x=this.getter(0).length,g=x,_e("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=x,this._chunkSize=g,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(typeof XMLHttpRequest<"u"){if(!Le)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var r=new i,u={isDevice:!1,contents:r}}else var u={isDevice:!1,url:s};var T=a.createFile(e,n,u,t,c);u.contents?T.contents=u.contents:u.url&&(T.contents=null,T.url=u.url),Object.defineProperties(T,{usedBytes:{get:function(){return this.contents.length}}});var P={},J=Object.keys(T.stream_ops);J.forEach(I=>{var F=T.stream_ops[I];P[I]=(...x)=>(a.forceLoadFile(T),F(...x))});function j(I,F,x,L,K){var U=I.node.contents;if(K>=U.length)return 0;var g=Math.min(U.length-K,L);if(U.slice)for(var q=0;q<g;q++)F[x+q]=U[K+q];else for(var q=0;q<g;q++)F[x+q]=U.get(K+q);return g}return P.read=(I,F,x,L,K)=>(a.forceLoadFile(T),j(I,F,x,L,K)),P.mmap=(I,F,x,L,K)=>{a.forceLoadFile(T);var U=Mt(F);if(!U)throw new a.ErrnoError(48);return j(I,ze,U,F,x),{ptr:U,allocated:!0}},T.stream_ops=P,T}},bn=(e,n,s)=>{if(!e)return"";var t=Ct(Ye,e,n);return Nt.decode(Ye.subarray(e,t))},he={DEFAULT_POLLMASK:5,calculateAt(e,n,s){if(qe.isAbs(n))return n;var t;if(e===-100)t=a.cwd();else{var c=he.getStreamFromFD(e);t=c.path}if(n.length==0){if(!s)throw new a.ErrnoError(44);return t}return t+"/"+n},writeStat(e,n){ge[e>>2]=n.dev,ge[e+4>>2]=n.mode,Pe[e+8>>2]=n.nlink,ge[e+12>>2]=n.uid,ge[e+16>>2]=n.gid,ge[e+20>>2]=n.rdev,je[e+24>>3]=BigInt(n.size),ge[e+32>>2]=4096,ge[e+36>>2]=n.blocks;var s=n.atime.getTime(),t=n.mtime.getTime(),c=n.ctime.getTime();return je[e+40>>3]=BigInt(Math.floor(s/1e3)),Pe[e+48>>2]=s%1e3*1e3*1e3,je[e+56>>3]=BigInt(Math.floor(t/1e3)),Pe[e+64>>2]=t%1e3*1e3*1e3,je[e+72>>3]=BigInt(Math.floor(c/1e3)),Pe[e+80>>2]=c%1e3*1e3*1e3,je[e+88>>3]=BigInt(n.ino),0},writeStatFs(e,n){ge[e+4>>2]=n.bsize,ge[e+60>>2]=n.bsize,je[e+8>>3]=BigInt(n.blocks),je[e+16>>3]=BigInt(n.bfree),je[e+24>>3]=BigInt(n.bavail),je[e+32>>3]=BigInt(n.files),je[e+40>>3]=BigInt(n.ffree),ge[e+48>>2]=n.fsid,ge[e+64>>2]=n.flags,ge[e+56>>2]=n.namelen},doMsync(e,n,s,t,c){if(!a.isFile(n.node.mode))throw new a.ErrnoError(43);if(t&2)return 0;var i=Ye.slice(e,e+s);a.msync(n,i,c,s,t)},getStreamFromFD(e){var n=a.getStreamChecked(e);return n},varargs:void 0,getStr(e){var n=bn(e);return n}};function yn(e,n){try{return e=he.getStr(e),a.chmod(e,n),0}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function qn(e,n,s,t){try{if(n=he.getStr(n),n=he.calculateAt(e,n),s&-8)return-28;var c=a.lookupPath(n,{follow:!0}),i=c.node;if(!i)return-44;var r="";return s&4&&(r+="r"),s&2&&(r+="w"),s&1&&(r+="x"),r&&a.nodePermissions(i,r)?-2:0}catch(u){if(typeof a>"u"||u.name!=="ErrnoError")throw u;return-u.errno}}function vn(e,n){try{return a.fchmod(e,n),0}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function wn(e,n,s){try{return a.fchown(e,n,s),0}catch(t){if(typeof a>"u"||t.name!=="ErrnoError")throw t;return-t.errno}}var pt=()=>{var e=ge[+he.varargs>>2];return he.varargs+=4,e},ot=pt;function Sn(e,n,s){he.varargs=s;try{var t=he.getStreamFromFD(e);switch(n){case 0:{var c=pt();if(c<0)return-28;for(;a.streams[c];)c++;var i;return i=a.dupStream(t,c),i.fd}case 1:case 2:return 0;case 3:return t.flags;case 4:{var c=pt();return t.flags|=c,0}case 12:{var c=ot(),r=0;return at[c+r>>1]=2,0}case 13:case 14:return 0}return-28}catch(u){if(typeof a>"u"||u.name!=="ErrnoError")throw u;return-u.errno}}function En(e,n){try{return he.writeStat(n,a.fstat(e))}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}var An=9007199254740992,In=-9007199254740992,_t=e=>e<In||e>An?NaN:Number(e);function kn(e,n){n=_t(n);try{return isNaN(n)?-61:(a.ftruncate(e,n),0)}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}var tt=(e,n,s)=>Rt(e,Ye,n,s);function Tn(e,n){try{if(n===0)return-28;var s=a.cwd(),t=dt(s)+1;return n<t?-68:(tt(s,e,n),t)}catch(c){if(typeof a>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}function xn(e,n,s){he.varargs=s;try{var t=he.getStreamFromFD(e);switch(n){case 21509:return t.tty?0:-59;case 21505:{if(!t.tty)return-59;if(t.tty.ops.ioctl_tcgets){var c=t.tty.ops.ioctl_tcgets(t),i=ot();ge[i>>2]=c.c_iflag||0,ge[i+4>>2]=c.c_oflag||0,ge[i+8>>2]=c.c_cflag||0,ge[i+12>>2]=c.c_lflag||0;for(var r=0;r<32;r++)ze[i+r+17]=c.c_cc[r]||0;return 0}return 0}case 21510:case 21511:case 21512:return t.tty?0:-59;case 21506:case 21507:case 21508:{if(!t.tty)return-59;if(t.tty.ops.ioctl_tcsets){for(var i=ot(),u=ge[i>>2],T=ge[i+4>>2],P=ge[i+8>>2],J=ge[i+12>>2],j=[],r=0;r<32;r++)j.push(ze[i+r+17]);return t.tty.ops.ioctl_tcsets(t.tty,n,{c_iflag:u,c_oflag:T,c_cflag:P,c_lflag:J,c_cc:j})}return 0}case 21519:{if(!t.tty)return-59;var i=ot();return ge[i>>2]=0,0}case 21520:return t.tty?-28:-59;case 21537:case 21531:{var i=ot();return a.ioctl(t,n,i)}case 21523:{if(!t.tty)return-59;if(t.tty.ops.ioctl_tiocgwinsz){var I=t.tty.ops.ioctl_tiocgwinsz(t.tty),i=ot();at[i>>1]=I[0],at[i+2>>1]=I[1]}return 0}case 21524:return t.tty?0:-59;case 21515:return t.tty?0:-59;default:return-28}}catch(F){if(typeof a>"u"||F.name!=="ErrnoError")throw F;return-F.errno}}function Fn(e,n){try{return e=he.getStr(e),he.writeStat(n,a.lstat(e))}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function On(e,n,s){try{return n=he.getStr(n),n=he.calculateAt(e,n),a.mkdir(n,s,0),0}catch(t){if(typeof a>"u"||t.name!=="ErrnoError")throw t;return-t.errno}}function Pn(e,n,s,t){try{n=he.getStr(n);var c=t&256,i=t&4096;return t=t&-6401,n=he.calculateAt(e,n,i),he.writeStat(s,c?a.lstat(n):a.stat(n))}catch(r){if(typeof a>"u"||r.name!=="ErrnoError")throw r;return-r.errno}}function Ln(e,n,s,t){he.varargs=t;try{n=he.getStr(n),n=he.calculateAt(e,n);var c=t?pt():0;return a.open(n,s,c).fd}catch(i){if(typeof a>"u"||i.name!=="ErrnoError")throw i;return-i.errno}}function Nn(e,n,s,t){try{if(n=he.getStr(n),n=he.calculateAt(e,n),t<=0)return-28;var c=a.readlink(n),i=Math.min(t,dt(c)),r=ze[s+i];return tt(c,s,t+1),ze[s+i]=r,i}catch(u){if(typeof a>"u"||u.name!=="ErrnoError")throw u;return-u.errno}}function Cn(e){try{return e=he.getStr(e),a.rmdir(e),0}catch(n){if(typeof a>"u"||n.name!=="ErrnoError")throw n;return-n.errno}}function Rn(e,n){try{return e=he.getStr(e),he.writeStat(n,a.stat(e))}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function Dn(e,n,s){try{if(n=he.getStr(n),n=he.calculateAt(e,n),!s)a.unlink(n);else if(s===512)a.rmdir(n);else return-28;return 0}catch(t){if(typeof a>"u"||t.name!=="ErrnoError")throw t;return-t.errno}}var Bt=e=>Pe[e>>2]+ge[e+4>>2]*4294967296;function Mn(e,n,s,t){try{n=he.getStr(n),n=he.calculateAt(e,n,!0);var c=Date.now(),i,r;if(!s)i=c,r=c;else{var u=Bt(s),T=ge[s+8>>2];T==1073741823?i=c:T==1073741822?i=null:i=u*1e3+T/(1e3*1e3),s+=16,u=Bt(s),T=ge[s+8>>2],T==1073741823?r=c:T==1073741822?r=null:r=u*1e3+T/(1e3*1e3)}return(r??i)!==null&&a.utime(n,i,r),0}catch(P){if(typeof a>"u"||P.name!=="ErrnoError")throw P;return-P.errno}}var jn=e=>e%4===0&&(e%100!==0||e%400===0),Bn=[0,31,60,91,121,152,182,213,244,274,305,335],Un=[0,31,59,90,120,151,181,212,243,273,304,334],Wn=e=>{var n=jn(e.getFullYear()),s=n?Bn:Un,t=s[e.getMonth()]+e.getDate()-1;return t};function zn(e,n){e=_t(e);var s=new Date(e*1e3);ge[n>>2]=s.getSeconds(),ge[n+4>>2]=s.getMinutes(),ge[n+8>>2]=s.getHours(),ge[n+12>>2]=s.getDate(),ge[n+16>>2]=s.getMonth(),ge[n+20>>2]=s.getFullYear()-1900,ge[n+24>>2]=s.getDay();var t=Wn(s)|0;ge[n+28>>2]=t,ge[n+36>>2]=-(s.getTimezoneOffset()*60);var c=new Date(s.getFullYear(),0,1),i=new Date(s.getFullYear(),6,1).getTimezoneOffset(),r=c.getTimezoneOffset(),u=(i!=r&&s.getTimezoneOffset()==Math.min(r,i))|0;ge[n+32>>2]=u}function Qn(e,n,s,t,c,i,r){c=_t(c);try{var u=he.getStreamFromFD(t),T=a.mmap(u,e,c,n,s),P=T.ptr;return ge[i>>2]=T.allocated,Pe[r>>2]=P,0}catch(J){if(typeof a>"u"||J.name!=="ErrnoError")throw J;return-J.errno}}function Hn(e,n,s,t,c,i){i=_t(i);try{var r=he.getStreamFromFD(c);s&2&&he.doMsync(e,r,n,t,i)}catch(u){if(typeof a>"u"||u.name!=="ErrnoError")throw u;return-u.errno}}var Vn=(e,n,s,t)=>{var c=new Date().getFullYear(),i=new Date(c,0,1),r=new Date(c,6,1),u=i.getTimezoneOffset(),T=r.getTimezoneOffset(),P=Math.max(u,T);Pe[e>>2]=P*60,ge[n>>2]=+(u!=T);var J=F=>{var x=F>=0?"-":"+",L=Math.abs(F),K=String(Math.floor(L/60)).padStart(2,"0"),U=String(L%60).padStart(2,"0");return`UTC${x}${K}${U}`},j=J(u),I=J(T);T<u?(tt(j,s,17),tt(I,t,17)):(tt(j,t,17),tt(I,s,17))},Ut=()=>performance.now(),Wt=()=>Date.now(),Gn=e=>e>=0&&e<=3;function $n(e,n,s){if(!Gn(e))return 28;var t;e===0?t=Wt():t=Ut();var c=Math.round(t*1e3*1e3);return je[s>>3]=BigInt(c),0}var zt=()=>2147483648,Kn=()=>zt(),Jn=e=>{var n=$e.buffer.byteLength,s=(e-n+65535)/65536|0;try{return $e.grow(s),Tt(),1}catch{}},Xn=e=>{var n=Ye.length;e>>>=0;var s=zt();if(e>s)return!1;for(var t=1;t<=4;t*=2){var c=n*(1+.2/t);c=Math.min(c,e+100663296);var i=Math.min(s,Dt(Math.max(e,c),65536)),r=Jn(i);if(r)return!0}return!1},wt={},Yn=()=>Ee||"./this.program",ft=()=>{if(!ft.strings){var e=(typeof navigator=="object"&&navigator.language||"C").replace("-","_")+".UTF-8",n={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:Yn()};for(var s in wt)wt[s]===void 0?delete n[s]:n[s]=wt[s];var t=[];for(var s in n)t.push(`${s}=${n[s]}`);ft.strings=t}return ft.strings},Zn=(e,n)=>{var s=0,t=0;for(var c of ft()){var i=n+s;Pe[e+t>>2]=i,s+=tt(c,i,1/0)+1,t+=4}return 0},er=(e,n)=>{var s=ft();Pe[e>>2]=s.length;var t=0;for(var c of s)t+=dt(c)+1;return Pe[n>>2]=t,0};function tr(e){try{var n=he.getStreamFromFD(e);return a.close(n),0}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return s.errno}}function nr(e,n){try{var s=0,t=0,c=0,i=he.getStreamFromFD(e),r=i.tty?2:a.isDir(i.mode)?3:a.isLink(i.mode)?7:4;return ze[n]=r,at[n+2>>1]=c,je[n+8>>3]=BigInt(s),je[n+16>>3]=BigInt(t),0}catch(u){if(typeof a>"u"||u.name!=="ErrnoError")throw u;return u.errno}}var rr=(e,n,s,t)=>{for(var c=0,i=0;i<s;i++){var r=Pe[n>>2],u=Pe[n+4>>2];n+=8;var T=a.read(e,ze,r,u,t);if(T<0)return-1;if(c+=T,T<u)break}return c};function ir(e,n,s,t){try{var c=he.getStreamFromFD(e),i=rr(c,n,s);return Pe[t>>2]=i,0}catch(r){if(typeof a>"u"||r.name!=="ErrnoError")throw r;return r.errno}}function sr(e,n,s,t){n=_t(n);try{if(isNaN(n))return 61;var c=he.getStreamFromFD(e);return a.llseek(c,n,s),je[t>>3]=BigInt(c.position),c.getdents&&n===0&&s===0&&(c.getdents=null),0}catch(i){if(typeof a>"u"||i.name!=="ErrnoError")throw i;return i.errno}}function or(e){var s;try{var n=he.getStreamFromFD(e);return(s=n.stream_ops)!=null&&s.fsync?n.stream_ops.fsync(n):0}catch(t){if(typeof a>"u"||t.name!=="ErrnoError")throw t;return t.errno}}var lr=(e,n,s,t)=>{for(var c=0,i=0;i<s;i++){var r=Pe[n>>2],u=Pe[n+4>>2];n+=8;var T=a.write(e,ze,r,u,t);if(T<0)return-1;if(c+=T,T<u)break}return c};function ar(e,n,s,t){try{var c=he.getStreamFromFD(e),i=lr(c,n,s);return Pe[t>>2]=i,0}catch(r){if(typeof a>"u"||r.name!=="ErrnoError")throw r;return r.errno}}a.createPreloadedFile=mn,a.staticInit(),Kt(),_.noExitRuntime&&_.noExitRuntime,_.preloadPlugins&&(jt=_.preloadPlugins),_.print&&(_e=_.print),_.printErr&&(Ie=_.printErr),_.wasmBinary&&(We=_.wasmBinary),_.arguments&&_.arguments,_.thisProgram&&(Ee=_.thisProgram),_.wasmMemory=$e;var Qt;function cr(e){_._sqlite3_status64=e.sqlite3_status64,_._sqlite3_status=e.sqlite3_status,_._sqlite3_db_status64=e.sqlite3_db_status64,_._sqlite3_msize=e.sqlite3_msize,_._sqlite3_db_status=e.sqlite3_db_status,_._sqlite3_vfs_find=e.sqlite3_vfs_find,_._sqlite3_initialize=e.sqlite3_initialize,_._sqlite3_malloc=e.sqlite3_malloc,_._sqlite3_free=e.sqlite3_free,_._sqlite3_vfs_register=e.sqlite3_vfs_register,_._sqlite3_vfs_unregister=e.sqlite3_vfs_unregister,_._sqlite3_malloc64=e.sqlite3_malloc64,_._sqlite3_realloc=e.sqlite3_realloc,_._sqlite3_realloc64=e.sqlite3_realloc64,_._sqlite3_value_text=e.sqlite3_value_text,_._sqlite3_randomness=e.sqlite3_randomness,_._sqlite3_stricmp=e.sqlite3_stricmp,_._sqlite3_strnicmp=e.sqlite3_strnicmp,_._sqlite3_uri_parameter=e.sqlite3_uri_parameter,_._sqlite3_uri_boolean=e.sqlite3_uri_boolean,_._sqlite3_serialize=e.sqlite3_serialize,_._sqlite3_prepare_v2=e.sqlite3_prepare_v2,_._sqlite3_step=e.sqlite3_step,_._sqlite3_column_int64=e.sqlite3_column_int64,_._sqlite3_reset=e.sqlite3_reset,_._sqlite3_exec=e.sqlite3_exec,_._sqlite3_column_int=e.sqlite3_column_int,_._sqlite3_finalize=e.sqlite3_finalize,_._sqlite3_file_control=e.sqlite3_file_control,_._sqlite3_column_name=e.sqlite3_column_name,_._sqlite3_column_text=e.sqlite3_column_text,_._sqlite3_column_type=e.sqlite3_column_type,_._sqlite3_errmsg=e.sqlite3_errmsg,_._sqlite3_deserialize=e.sqlite3_deserialize,_._sqlite3_clear_bindings=e.sqlite3_clear_bindings,_._sqlite3_value_blob=e.sqlite3_value_blob,_._sqlite3_value_bytes=e.sqlite3_value_bytes,_._sqlite3_value_double=e.sqlite3_value_double,_._sqlite3_value_int=e.sqlite3_value_int,_._sqlite3_value_int64=e.sqlite3_value_int64,_._sqlite3_value_subtype=e.sqlite3_value_subtype,_._sqlite3_value_pointer=e.sqlite3_value_pointer,_._sqlite3_value_type=e.sqlite3_value_type,_._sqlite3_value_nochange=e.sqlite3_value_nochange,_._sqlite3_value_frombind=e.sqlite3_value_frombind,_._sqlite3_value_dup=e.sqlite3_value_dup,_._sqlite3_value_free=e.sqlite3_value_free,_._sqlite3_result_blob=e.sqlite3_result_blob,_._sqlite3_result_error_toobig=e.sqlite3_result_error_toobig,_._sqlite3_result_error_nomem=e.sqlite3_result_error_nomem,_._sqlite3_result_double=e.sqlite3_result_double,_._sqlite3_result_error=e.sqlite3_result_error,_._sqlite3_result_int=e.sqlite3_result_int,_._sqlite3_result_int64=e.sqlite3_result_int64,_._sqlite3_result_null=e.sqlite3_result_null,_._sqlite3_result_pointer=e.sqlite3_result_pointer,_._sqlite3_result_subtype=e.sqlite3_result_subtype,_._sqlite3_result_text=e.sqlite3_result_text,_._sqlite3_result_zeroblob=e.sqlite3_result_zeroblob,_._sqlite3_result_zeroblob64=e.sqlite3_result_zeroblob64,_._sqlite3_result_error_code=e.sqlite3_result_error_code,_._sqlite3_user_data=e.sqlite3_user_data,_._sqlite3_context_db_handle=e.sqlite3_context_db_handle,_._sqlite3_vtab_nochange=e.sqlite3_vtab_nochange,_._sqlite3_vtab_in_first=e.sqlite3_vtab_in_first,_._sqlite3_vtab_in_next=e.sqlite3_vtab_in_next,_._sqlite3_aggregate_context=e.sqlite3_aggregate_context,_._sqlite3_get_auxdata=e.sqlite3_get_auxdata,_._sqlite3_set_auxdata=e.sqlite3_set_auxdata,_._sqlite3_column_count=e.sqlite3_column_count,_._sqlite3_data_count=e.sqlite3_data_count,_._sqlite3_column_blob=e.sqlite3_column_blob,_._sqlite3_column_bytes=e.sqlite3_column_bytes,_._sqlite3_column_double=e.sqlite3_column_double,_._sqlite3_column_value=e.sqlite3_column_value,_._sqlite3_column_decltype=e.sqlite3_column_decltype,_._sqlite3_column_database_name=e.sqlite3_column_database_name,_._sqlite3_column_table_name=e.sqlite3_column_table_name,_._sqlite3_column_origin_name=e.sqlite3_column_origin_name,_._sqlite3_bind_blob=e.sqlite3_bind_blob,_._sqlite3_bind_double=e.sqlite3_bind_double,_._sqlite3_bind_int=e.sqlite3_bind_int,_._sqlite3_bind_int64=e.sqlite3_bind_int64,_._sqlite3_bind_null=e.sqlite3_bind_null,_._sqlite3_bind_pointer=e.sqlite3_bind_pointer,_._sqlite3_bind_text=e.sqlite3_bind_text,_._sqlite3_bind_parameter_count=e.sqlite3_bind_parameter_count,_._sqlite3_bind_parameter_name=e.sqlite3_bind_parameter_name,_._sqlite3_bind_parameter_index=e.sqlite3_bind_parameter_index,_._sqlite3_db_handle=e.sqlite3_db_handle,_._sqlite3_stmt_readonly=e.sqlite3_stmt_readonly,_._sqlite3_stmt_isexplain=e.sqlite3_stmt_isexplain,_._sqlite3_stmt_explain=e.sqlite3_stmt_explain,_._sqlite3_stmt_busy=e.sqlite3_stmt_busy,_._sqlite3_stmt_status=e.sqlite3_stmt_status,_._sqlite3_sql=e.sqlite3_sql,_._sqlite3_expanded_sql=e.sqlite3_expanded_sql,_._sqlite3_preupdate_old=e.sqlite3_preupdate_old,_._sqlite3_preupdate_count=e.sqlite3_preupdate_count,_._sqlite3_preupdate_depth=e.sqlite3_preupdate_depth,_._sqlite3_preupdate_blobwrite=e.sqlite3_preupdate_blobwrite,_._sqlite3_preupdate_new=e.sqlite3_preupdate_new,_._sqlite3_value_numeric_type=e.sqlite3_value_numeric_type,_._sqlite3_set_authorizer=e.sqlite3_set_authorizer,_._sqlite3_strglob=e.sqlite3_strglob,_._sqlite3_strlike=e.sqlite3_strlike,_._sqlite3_auto_extension=e.sqlite3_auto_extension,_._sqlite3_cancel_auto_extension=e.sqlite3_cancel_auto_extension,_._sqlite3_reset_auto_extension=e.sqlite3_reset_auto_extension,_._sqlite3_prepare_v3=e.sqlite3_prepare_v3,_._sqlite3_create_module=e.sqlite3_create_module,_._sqlite3_create_module_v2=e.sqlite3_create_module_v2,_._sqlite3_drop_modules=e.sqlite3_drop_modules,_._sqlite3_declare_vtab=e.sqlite3_declare_vtab,_._sqlite3_vtab_on_conflict=e.sqlite3_vtab_on_conflict,_._sqlite3_vtab_collation=e.sqlite3_vtab_collation,_._sqlite3_vtab_in=e.sqlite3_vtab_in,_._sqlite3_vtab_rhs_value=e.sqlite3_vtab_rhs_value,_._sqlite3_vtab_distinct=e.sqlite3_vtab_distinct,_._sqlite3_keyword_name=e.sqlite3_keyword_name,_._sqlite3_keyword_count=e.sqlite3_keyword_count,_._sqlite3_keyword_check=e.sqlite3_keyword_check,_._sqlite3_complete=e.sqlite3_complete,_._sqlite3_libversion=e.sqlite3_libversion,_._sqlite3_libversion_number=e.sqlite3_libversion_number,_._sqlite3_shutdown=e.sqlite3_shutdown,_._sqlite3_last_insert_rowid=e.sqlite3_last_insert_rowid,_._sqlite3_set_last_insert_rowid=e.sqlite3_set_last_insert_rowid,_._sqlite3_changes64=e.sqlite3_changes64,_._sqlite3_changes=e.sqlite3_changes,_._sqlite3_total_changes64=e.sqlite3_total_changes64,_._sqlite3_total_changes=e.sqlite3_total_changes,_._sqlite3_txn_state=e.sqlite3_txn_state,_._sqlite3_close_v2=e.sqlite3_close_v2,_._sqlite3_busy_handler=e.sqlite3_busy_handler,_._sqlite3_progress_handler=e.sqlite3_progress_handler,_._sqlite3_busy_timeout=e.sqlite3_busy_timeout,_._sqlite3_interrupt=e.sqlite3_interrupt,_._sqlite3_is_interrupted=e.sqlite3_is_interrupted,_._sqlite3_create_function=e.sqlite3_create_function,_._sqlite3_create_function_v2=e.sqlite3_create_function_v2,_._sqlite3_create_window_function=e.sqlite3_create_window_function,_._sqlite3_overload_function=e.sqlite3_overload_function,_._sqlite3_trace_v2=e.sqlite3_trace_v2,_._sqlite3_commit_hook=e.sqlite3_commit_hook,_._sqlite3_update_hook=e.sqlite3_update_hook,_._sqlite3_rollback_hook=e.sqlite3_rollback_hook,_._sqlite3_preupdate_hook=e.sqlite3_preupdate_hook,_._sqlite3_set_errmsg=e.sqlite3_set_errmsg,_._sqlite3_error_offset=e.sqlite3_error_offset,_._sqlite3_errcode=e.sqlite3_errcode,_._sqlite3_extended_errcode=e.sqlite3_extended_errcode,_._sqlite3_errstr=e.sqlite3_errstr,_._sqlite3_limit=e.sqlite3_limit,_._sqlite3_open=e.sqlite3_open,_._sqlite3_open_v2=e.sqlite3_open_v2,_._sqlite3_create_collation=e.sqlite3_create_collation,_._sqlite3_create_collation_v2=e.sqlite3_create_collation_v2,_._sqlite3_collation_needed=e.sqlite3_collation_needed,_._sqlite3_get_autocommit=e.sqlite3_get_autocommit,_._sqlite3_table_column_metadata=e.sqlite3_table_column_metadata,_._sqlite3_extended_result_codes=e.sqlite3_extended_result_codes,_._sqlite3_uri_key=e.sqlite3_uri_key,_._sqlite3_uri_int64=e.sqlite3_uri_int64,_._sqlite3_db_name=e.sqlite3_db_name,_._sqlite3_db_filename=e.sqlite3_db_filename,_._sqlite3_db_readonly=e.sqlite3_db_readonly,_._sqlite3_compileoption_used=e.sqlite3_compileoption_used,_._sqlite3_compileoption_get=e.sqlite3_compileoption_get,_._sqlite3session_diff=e.sqlite3session_diff,_._sqlite3session_attach=e.sqlite3session_attach,_._sqlite3session_create=e.sqlite3session_create,_._sqlite3session_delete=e.sqlite3session_delete,_._sqlite3session_table_filter=e.sqlite3session_table_filter,_._sqlite3session_changeset=e.sqlite3session_changeset,_._sqlite3session_changeset_strm=e.sqlite3session_changeset_strm,_._sqlite3session_patchset_strm=e.sqlite3session_patchset_strm,_._sqlite3session_patchset=e.sqlite3session_patchset,_._sqlite3session_enable=e.sqlite3session_enable,_._sqlite3session_indirect=e.sqlite3session_indirect,_._sqlite3session_isempty=e.sqlite3session_isempty,_._sqlite3session_memory_used=e.sqlite3session_memory_used,_._sqlite3session_object_config=e.sqlite3session_object_config,_._sqlite3session_changeset_size=e.sqlite3session_changeset_size,_._sqlite3changeset_start=e.sqlite3changeset_start,_._sqlite3changeset_start_v2=e.sqlite3changeset_start_v2,_._sqlite3changeset_start_strm=e.sqlite3changeset_start_strm,_._sqlite3changeset_start_v2_strm=e.sqlite3changeset_start_v2_strm,_._sqlite3changeset_next=e.sqlite3changeset_next,_._sqlite3changeset_op=e.sqlite3changeset_op,_._sqlite3changeset_pk=e.sqlite3changeset_pk,_._sqlite3changeset_old=e.sqlite3changeset_old,_._sqlite3changeset_new=e.sqlite3changeset_new,_._sqlite3changeset_conflict=e.sqlite3changeset_conflict,_._sqlite3changeset_fk_conflicts=e.sqlite3changeset_fk_conflicts,_._sqlite3changeset_finalize=e.sqlite3changeset_finalize,_._sqlite3changeset_invert=e.sqlite3changeset_invert,_._sqlite3changeset_invert_strm=e.sqlite3changeset_invert_strm,_._sqlite3changeset_apply_v2=e.sqlite3changeset_apply_v2,_._sqlite3changeset_apply_v3=e.sqlite3changeset_apply_v3,_._sqlite3changeset_apply=e.sqlite3changeset_apply,_._sqlite3changeset_apply_v3_strm=e.sqlite3changeset_apply_v3_strm,_._sqlite3changeset_apply_v2_strm=e.sqlite3changeset_apply_v2_strm,_._sqlite3changeset_apply_strm=e.sqlite3changeset_apply_strm,_._sqlite3changegroup_new=e.sqlite3changegroup_new,_._sqlite3changegroup_add=e.sqlite3changegroup_add,_._sqlite3changegroup_output=e.sqlite3changegroup_output,_._sqlite3changegroup_add_strm=e.sqlite3changegroup_add_strm,_._sqlite3changegroup_output_strm=e.sqlite3changegroup_output_strm,_._sqlite3changegroup_delete=e.sqlite3changegroup_delete,_._sqlite3changeset_concat=e.sqlite3changeset_concat,_._sqlite3changeset_concat_strm=e.sqlite3changeset_concat_strm,_._sqlite3session_config=e.sqlite3session_config,_._sqlite3_sourceid=e.sqlite3_sourceid,_._sqlite3__wasm_pstack_ptr=e.sqlite3__wasm_pstack_ptr,_._sqlite3__wasm_pstack_restore=e.sqlite3__wasm_pstack_restore,_._sqlite3__wasm_pstack_alloc=e.sqlite3__wasm_pstack_alloc,_._sqlite3__wasm_pstack_remaining=e.sqlite3__wasm_pstack_remaining,_._sqlite3__wasm_pstack_quota=e.sqlite3__wasm_pstack_quota,_._sqlite3__wasm_test_struct=e.sqlite3__wasm_test_struct,_._sqlite3__wasm_enum_json=e.sqlite3__wasm_enum_json,_._sqlite3__wasm_vfs_unlink=e.sqlite3__wasm_vfs_unlink,_._sqlite3__wasm_db_vfs=e.sqlite3__wasm_db_vfs,_._sqlite3__wasm_db_reset=e.sqlite3__wasm_db_reset,_._sqlite3__wasm_db_export_chunked=e.sqlite3__wasm_db_export_chunked,_._sqlite3__wasm_db_serialize=e.sqlite3__wasm_db_serialize,_._sqlite3__wasm_vfs_create_file=e.sqlite3__wasm_vfs_create_file,_._sqlite3__wasm_posix_create_file=e.sqlite3__wasm_posix_create_file,_._sqlite3__wasm_kvvfsMakeKeyOnPstack=e.sqlite3__wasm_kvvfsMakeKeyOnPstack,_._sqlite3__wasm_kvvfs_methods=e.sqlite3__wasm_kvvfs_methods,_._sqlite3__wasm_vtab_config=e.sqlite3__wasm_vtab_config,_._sqlite3__wasm_db_config_ip=e.sqlite3__wasm_db_config_ip,_._sqlite3__wasm_db_config_pii=e.sqlite3__wasm_db_config_pii,_._sqlite3__wasm_db_config_s=e.sqlite3__wasm_db_config_s,_._sqlite3__wasm_config_i=e.sqlite3__wasm_config_i,_._sqlite3__wasm_config_ii=e.sqlite3__wasm_config_ii,_._sqlite3__wasm_config_j=e.sqlite3__wasm_config_j,_._sqlite3__wasm_qfmt_token=e.sqlite3__wasm_qfmt_token,_._sqlite3__wasm_init_wasmfs=e.sqlite3__wasm_init_wasmfs,_._sqlite3__wasm_test_intptr=e.sqlite3__wasm_test_intptr,_._sqlite3__wasm_test_voidptr=e.sqlite3__wasm_test_voidptr,_._sqlite3__wasm_test_int64_max=e.sqlite3__wasm_test_int64_max,_._sqlite3__wasm_test_int64_min=e.sqlite3__wasm_test_int64_min,_._sqlite3__wasm_test_int64_times2=e.sqlite3__wasm_test_int64_times2,_._sqlite3__wasm_test_int64_minmax=e.sqlite3__wasm_test_int64_minmax,_._sqlite3__wasm_test_int64ptr=e.sqlite3__wasm_test_int64ptr,_._sqlite3__wasm_test_stack_overflow=e.sqlite3__wasm_test_stack_overflow,_._sqlite3__wasm_test_str_hello=e.sqlite3__wasm_test_str_hello,_._sqlite3__wasm_SQLTester_strglob=e.sqlite3__wasm_SQLTester_strglob,_._malloc=e.malloc,_._free=e.free,_._realloc=e.realloc,Qt=e.emscripten_builtin_memalign,e._emscripten_stack_restore,e._emscripten_stack_alloc,e.emscripten_stack_get_current}var Ht={__syscall_chmod:yn,__syscall_faccessat:qn,__syscall_fchmod:vn,__syscall_fchown32:wn,__syscall_fcntl64:Sn,__syscall_fstat64:En,__syscall_ftruncate64:kn,__syscall_getcwd:Tn,__syscall_ioctl:xn,__syscall_lstat64:Fn,__syscall_mkdirat:On,__syscall_newfstatat:Pn,__syscall_openat:Ln,__syscall_readlinkat:Nn,__syscall_rmdir:Cn,__syscall_stat64:Rn,__syscall_unlinkat:Dn,__syscall_utimensat:Mn,_localtime_js:zn,_mmap_js:Qn,_munmap_js:Hn,_tzset_js:Vn,clock_time_get:$n,emscripten_date_now:Wt,emscripten_get_heap_max:Kn,emscripten_get_now:Ut,emscripten_resize_heap:Xn,environ_get:Zn,environ_sizes_get:er,fd_close:tr,fd_fdstat_get:nr,fd_read:ir,fd_seek:sr,fd_sync:or,fd_write:ar,memory:$e},lt=await ln();function St(){if(Ze>0){ct=St;return}if(Jt(),Ze>0){ct=St;return}function e(){var n;_.calledRun=!0,!nt&&(Xt(),rt==null||rt(_),(n=_.onRuntimeInitialized)==null||n.call(_),Yt())}_.setStatus?(_.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>_.setStatus(""),1),e()},1)):e()}function ur(){if(_.preInit)for(typeof _.preInit=="function"&&(_.preInit=[_.preInit]);_.preInit.length>0;)_.preInit.shift()()}return ur(),St(),_.runSQLite3PostLoadInit=function(e,n,s){if(delete n.runSQLite3PostLoadInit,globalThis.sqlite3ApiBootstrap=async function t(c=globalThis.sqlite3ApiConfig||t.defaultConfig){if(t.sqlite3)return(t.sqlite3.config||console).warn("sqlite3ApiBootstrap() called multiple times.","Config and external initializers are ignored on calls after the first."),t.sqlite3;const i=Object.assign(Object.create(null),{exports:void 0,memory:void 0,bigIntEnabled:!!globalThis.BigInt64Array,debug:console.debug.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),log:console.log.bind(console),wasmfsOpfsDir:"/opfs",useStdAlloc:!1},c||{});Object.assign(i,{allocExportName:i.useStdAlloc?"malloc":"sqlite3_malloc",deallocExportName:i.useStdAlloc?"free":"sqlite3_free",reallocExportName:i.useStdAlloc?"realloc":"sqlite3_realloc"}),["exports","memory","functionTable","wasmfsOpfsDir"].forEach(f=>{typeof i[f]=="function"&&(i[f]=i[f]())}),delete globalThis.sqlite3ApiConfig,delete t.defaultConfig;const r=Object.create(null),u=Object.create(null),T=f=>r.sqlite3_js_rc_str&&r.sqlite3_js_rc_str(f)||"Unknown result code #"+f,P=f=>typeof f=="number"&&f===(f|0)&&f<=2147483647&&f>=-2147483648;class J extends Error{constructor(...p){let y;if(p.length)if(P(p[0]))if(y=p[0],p.length===1)super(T(p[0]));else{const D=T(y);typeof p[1]=="object"?super(D,p[1]):(p[0]=D+":",super(p.join(" ")))}else p.length===2&&typeof p[1]=="object"?super(...p):super(p.join(" "));this.resultCode=y||r.SQLITE_ERROR,this.name="SQLite3Error"}}J.toss=(...f)=>{throw new J(...f)};const j=J.toss;i.wasmfsOpfsDir&&!/^\/[^/]+$/.test(i.wasmfsOpfsDir)&&j("config.wasmfsOpfsDir must be falsy or in the form '/dir-name'.");const I=function f(p){return f._max||(f._max=BigInt("0x7fffffffffffffff"),f._min=~f._max),p>=f._min&&p<=f._max},F=f=>f>=-0x7fffffffn-1n&&f<=0x7fffffffn,x=function f(p){return f._min||(f._min=Number.MIN_SAFE_INTEGER,f._max=Number.MAX_SAFE_INTEGER),p>=f._min&&p<=f._max},L=f=>f&&f.constructor&&P(f.constructor.BYTES_PER_ELEMENT)?f:!1,K=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),U=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),g=f=>K(f)||j("Value is not of a supported TypedArray type."),q=function(f){return U(f)?u.typedArrayToString(f instanceof ArrayBuffer?new Uint8Array(f):f,0,f.length):Array.isArray(f)?f.join(""):(u.isPtr(f)&&(f=u.cstrToJs(f)),f)};class w extends Error{constructor(...p){p.length===2&&typeof p[1]=="object"?super(...p):p.length?super(p.join(" ")):super("Allocation failed."),this.resultCode=r.SQLITE_NOMEM,this.name="WasmAllocError"}}w.toss=(...f)=>{throw new w(...f)},Object.assign(r,{sqlite3_bind_blob:void 0,sqlite3_bind_text:void 0,sqlite3_create_function_v2:(f,p,y,D,H,re,se,h,o)=>{},sqlite3_create_function:(f,p,y,D,H,re,se,h)=>{},sqlite3_create_window_function:(f,p,y,D,H,re,se,h,o,l)=>{},sqlite3_prepare_v3:(f,p,y,D,H,re)=>{},sqlite3_prepare_v2:(f,p,y,D,H)=>{},sqlite3_exec:(f,p,y,D,H)=>{},sqlite3_randomness:(f,p)=>{}});const O={affirmBindableTypedArray:g,flexibleString:q,bigIntFits32:F,bigIntFits64:I,bigIntFitsDouble:x,isBindableTypedArray:K,isInt32:P,isSQLableTypedArray:U,isTypedArray:L,isUIThread:()=>globalThis.window===globalThis&&!!globalThis.document,toss:function(...f){throw new Error(f.join(" "))},toss3:j,typedArrayPart:u.typedArrayPart,affirmDbHeader:function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f));const p="SQLite format 3";p.length>f.byteLength&&j("Input does not contain an SQLite3 database header.");for(let y=0;y<p.length;++y)p.charCodeAt(y)!==f[y]&&j("Input does not contain an SQLite3 database header.")},affirmIsDb:function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f));const p=f.byteLength;(p<512||p%512!==0)&&j("Byte array size",p,"is invalid for an SQLite3 db."),O.affirmDbHeader(f)}};Object.assign(u,{pointerIR:i.wasmPtrIR,bigIntEnabled:!!i.bigIntEnabled,exports:i.exports||j("Missing API config.exports (WASM module exports)."),memory:i.memory||i.exports.memory||j("API config object requires a WebAssembly.Memory object","in either config.exports.memory (exported)","or config.memory (imported)."),functionTable:i.functionTable,alloc:void 0,realloc:void 0,dealloc:void 0}),u.allocFromTypedArray=function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f)),g(f);const p=u.heapForSize(f.constructor),y=u.alloc(f.byteLength||1);return p.set(f.byteLength?f:[0],Number(y)),y};{const f=i.allocExportName,p=i.deallocExportName,y=i.reallocExportName;for(const D of[f,p,y])u.exports[D]instanceof Function||j("Missing required exports[",D,"] function.");u.alloc=function D(H){return D.impl(H)||w.toss("Failed to allocate",H," bytes.")},u.alloc.impl=u.exports[f],u.realloc=function D(H,re){const se=D.impl(u.ptr.coerce(H),re);return re?se||w.toss("Failed to reallocate",re," bytes."):u.ptr.null},u.realloc.impl=u.exports[y],u.dealloc=function D(H){D.impl(u.ptr.coerce(H))},u.dealloc.impl=u.exports[p]}u.compileOptionUsed=function f(p){if(arguments.length){if(Array.isArray(p)){const y=Object.create(null);return p.forEach(D=>{y[D]=r.sqlite3_compileoption_used(D)}),y}else if(typeof p=="object")return Object.keys(p).forEach(y=>{p[y]=r.sqlite3_compileoption_used(y)}),p}else{if(f._result)return f._result;f._opt||(f._rx=/^([^=]+)=(.+)/,f._rxInt=/^-?\d+$/,f._opt=function(se,h){const o=f._rx.exec(se);h[0]=o?o[1]:se,h[1]=o?f._rxInt.test(o[2])?+o[2]:o[2]:!0});const y=Object.create(null),D=[0,0];let H=0,re;for(;re=r.sqlite3_compileoption_get(H++);)f._opt(re,D),y[D[0]]=D[1];return f._result=y}return typeof p=="string"?!!r.sqlite3_compileoption_used(p):!1},u.pstack=Object.assign(Object.create(null),{restore:u.exports.sqlite3__wasm_pstack_restore,alloc:function(f){return typeof f=="string"&&!(f=u.sizeofIR(f))&&w.toss("Invalid value for pstack.alloc(",arguments[0],")"),u.exports.sqlite3__wasm_pstack_alloc(f)||w.toss("Could not allocate",f,"bytes from the pstack.")},allocChunks:function(f,p){typeof p=="string"&&!(p=u.sizeofIR(p))&&w.toss("Invalid size value for allocChunks(",arguments[1],")");const y=u.pstack.alloc(f*p),D=[y];let H=1,re=p;for(;H<f;++H,re+=p)D.push(u.ptr.add(y,re));return D},allocPtr:(f=1,p=!0)=>f===1?u.pstack.alloc(p?8:u.ptr.size):u.pstack.allocChunks(f,p?8:u.ptr.size),call:function(f){const p=u.pstack.pointer;try{return f(N)}finally{u.pstack.restore(p)}}}),Object.defineProperties(u.pstack,{pointer:{configurable:!1,iterable:!0,writeable:!1,get:u.exports.sqlite3__wasm_pstack_ptr},quota:{configurable:!1,iterable:!0,writeable:!1,get:u.exports.sqlite3__wasm_pstack_quota},remaining:{configurable:!1,iterable:!0,writeable:!1,get:u.exports.sqlite3__wasm_pstack_remaining}}),r.sqlite3_randomness=(...f)=>{if(f.length===1&&O.isTypedArray(f[0])&&f[0].BYTES_PER_ELEMENT===1){const p=f[0];if(p.byteLength===0)return u.exports.sqlite3_randomness(0,u.ptr.null),p;const y=u.pstack.pointer;try{let D=p.byteLength,H=0;const re=u.exports.sqlite3_randomness,se=u.heap8u(),h=D<512?D:512,o=u.pstack.alloc(h);do{const l=D>h?h:D;re(l,o),p.set(u.typedArrayPart(se,o,u.ptr.add(o,l)),H),D-=l,H+=l}while(D>0)}catch(D){i.error("Highly unexpected (and ignored!) exception in sqlite3_randomness():",D)}finally{u.pstack.restore(y)}return p}u.exports.sqlite3_randomness(...f)};let E;if(r.sqlite3_wasmfs_opfs_dir=function(){if(E!==void 0)return E;const f=i.wasmfsOpfsDir;if(!f||!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!u.exports.sqlite3__wasm_init_wasmfs)return E="";try{return f&&u.xCallWrapped("sqlite3__wasm_init_wasmfs","i32",["string"],f)===0?E=f:E=""}catch{return E=""}},r.sqlite3_wasmfs_filename_is_persistent=function(f){const p=r.sqlite3_wasmfs_opfs_dir();return p&&f?f.startsWith(p+"/"):!1},r.sqlite3_js_db_uses_vfs=function(f,p,y=0){try{const D=r.sqlite3_vfs_find(p);return D?f?D===r.sqlite3_js_db_vfs(f,y)?D:!1:D===r.sqlite3_vfs_find(0)?D:!1:!1}catch{return!1}},r.sqlite3_js_vfs_list=function(){const f=[];let p=r.sqlite3_vfs_find(u.ptr.coerce(0));for(;p;){const y=new r.sqlite3_vfs(p);f.push(u.cstrToJs(y.$zName)),p=y.$pNext,y.dispose()}return f},r.sqlite3_js_db_export=function(f,p=0){f=u.xWrap.testConvertArg("sqlite3*",f),f||j("Invalid sqlite3* argument."),u.bigIntEnabled||j("BigInt support is not enabled.");const y=u.scopedAllocPush();let D;try{const H=u.scopedAlloc(8+u.ptr.size),re=u.ptr.add(H,8),se=p?u.isPtr(p)?p:u.scopedAllocCString(""+p):u.ptr.null;let h=u.exports.sqlite3__wasm_db_serialize(f,se,re,H,0);h&&j("Database serialization failed with code",N.capi.sqlite3_js_rc_str(h)),D=u.peekPtr(re);const o=u.peek(H,"i64");return h=o?u.heap8u().slice(Number(D),Number(D)+Number(o)):new Uint8Array,h}finally{D&&u.exports.sqlite3_free(D),u.scopedAllocPop(y)}},r.sqlite3_js_db_vfs=(f,p=0)=>O.sqlite3__wasm_db_vfs(f,p),r.sqlite3_js_aggregate_context=(f,p)=>r.sqlite3_aggregate_context(f,p)||(p?w.toss("Cannot allocate",p,"bytes for sqlite3_aggregate_context()"):0),r.sqlite3_js_posix_create_file=function(f,p,y){let D;p&&u.isPtr(p)?D=p:p instanceof ArrayBuffer||p instanceof Uint8Array?(D=u.allocFromTypedArray(p),(arguments.length<3||!O.isInt32(y)||y<0)&&(y=p.byteLength)):J.toss("Invalid 2nd argument for sqlite3_js_posix_create_file().");try{(!O.isInt32(y)||y<0)&&J.toss("Invalid 3rd argument for sqlite3_js_posix_create_file().");const H=O.sqlite3__wasm_posix_create_file(f,D,y);H&&J.toss("Creation of file failed with sqlite3 result code",r.sqlite3_js_rc_str(H))}finally{D&&D!==p&&u.dealloc(D)}},r.sqlite3_js_vfs_create_file=function(f,p,y,D){i.warn("sqlite3_js_vfs_create_file() is deprecated and","should be avoided because it can lead to C-level crashes.","See its documentation for alternatives.");let H;y?u.isPtr(y)?H=y:(y instanceof ArrayBuffer&&(y=new Uint8Array(y)),y instanceof Uint8Array?(H=u.allocFromTypedArray(y),(arguments.length<4||!O.isInt32(D)||D<0)&&(D=y.byteLength)):J.toss("Invalid 3rd argument type for sqlite3_js_vfs_create_file().")):H=0,(!O.isInt32(D)||D<0)&&(H&&H!==y&&u.dealloc(H),J.toss("Invalid 4th argument for sqlite3_js_vfs_create_file()."));try{const re=O.sqlite3__wasm_vfs_create_file(f,p,H,D);re&&J.toss("Creation of file failed with sqlite3 result code",r.sqlite3_js_rc_str(re))}finally{H&&H!==y&&u.dealloc(H)}},r.sqlite3_js_sql_to_string=f=>{if(typeof f=="string")return f;const p=q(v);return p===v?void 0:p},O.isUIThread()){const f=function(p){const y=Object.create(null);return y.prefix="kvvfs-"+p,y.stores=[],(p==="session"||p==="")&&y.stores.push(globalThis.sessionStorage),(p==="local"||p==="")&&y.stores.push(globalThis.localStorage),y};r.sqlite3_js_kvvfs_clear=function(p=""){let y=0;const D=f(p);return D.stores.forEach(H=>{const re=[];let se;for(se=0;se<H.length;++se){const h=H.key(se);h.startsWith(D.prefix)&&re.push(h)}re.forEach(h=>H.removeItem(h)),y+=re.length}),y},r.sqlite3_js_kvvfs_size=function(p=""){let y=0;const D=f(p);return D.stores.forEach(H=>{let re;for(re=0;re<H.length;++re){const se=H.key(re);se.startsWith(D.prefix)&&(y+=se.length,y+=H.getItem(se).length)}}),y*2}}r.sqlite3_db_config=(function(f,p,...y){switch(p){case r.SQLITE_DBCONFIG_ENABLE_FKEY:case r.SQLITE_DBCONFIG_ENABLE_TRIGGER:case r.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER:case r.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION:case r.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE:case r.SQLITE_DBCONFIG_ENABLE_QPSG:case r.SQLITE_DBCONFIG_TRIGGER_EQP:case r.SQLITE_DBCONFIG_RESET_DATABASE:case r.SQLITE_DBCONFIG_DEFENSIVE:case r.SQLITE_DBCONFIG_WRITABLE_SCHEMA:case r.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE:case r.SQLITE_DBCONFIG_DQS_DML:case r.SQLITE_DBCONFIG_DQS_DDL:case r.SQLITE_DBCONFIG_ENABLE_VIEW:case r.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT:case r.SQLITE_DBCONFIG_TRUSTED_SCHEMA:case r.SQLITE_DBCONFIG_STMT_SCANSTATUS:case r.SQLITE_DBCONFIG_REVERSE_SCANORDER:case r.SQLITE_DBCONFIG_ENABLE_ATTACH_CREATE:case r.SQLITE_DBCONFIG_ENABLE_ATTACH_WRITE:case r.SQLITE_DBCONFIG_ENABLE_COMMENTS:return this.ip||(this.ip=u.xWrap("sqlite3__wasm_db_config_ip","int",["sqlite3*","int","int","*"])),this.ip(f,p,y[0],y[1]||0);case r.SQLITE_DBCONFIG_LOOKASIDE:return this.pii||(this.pii=u.xWrap("sqlite3__wasm_db_config_pii","int",["sqlite3*","int","*","int","int"])),this.pii(f,p,y[0],y[1],y[2]);case r.SQLITE_DBCONFIG_MAINDBNAME:return this.s||(this.s=u.xWrap("sqlite3__wasm_db_config_s","int",["sqlite3*","int","string:static"])),this.s(f,p,y[0]);default:return r.SQLITE_MISUSE}}).bind(Object.create(null)),r.sqlite3_value_to_js=function(f,p=!0){let y;const D=r.sqlite3_value_type(f);switch(D){case r.SQLITE_INTEGER:u.bigIntEnabled?(y=r.sqlite3_value_int64(f),O.bigIntFitsDouble(y)&&(y=Number(y))):y=r.sqlite3_value_double(f);break;case r.SQLITE_FLOAT:y=r.sqlite3_value_double(f);break;case r.SQLITE_TEXT:y=r.sqlite3_value_text(f);break;case r.SQLITE_BLOB:{const H=r.sqlite3_value_bytes(f),re=r.sqlite3_value_blob(f);H&&!re&&N.WasmAllocError.toss("Cannot allocate memory for blob argument of",H,"byte(s)"),y=H?u.heap8u().slice(Number(re),Number(re)+Number(H)):null;break}case r.SQLITE_NULL:y=null;break;default:p&&j(r.SQLITE_MISMATCH,"Unhandled sqlite3_value_type():",D),y=void 0}return y},r.sqlite3_values_to_js=function(f,p,y=!0){let D;const H=[];for(D=0;D<f;++D)H.push(r.sqlite3_value_to_js(u.peekPtr(u.ptr.add(p,u.ptr.size*D)),y));return H},r.sqlite3_result_error_js=function(f,p){p instanceof w?r.sqlite3_result_error_nomem(f):r.sqlite3_result_error(f,""+p,-1)},r.sqlite3_result_js=function(f,p){if(p instanceof Error){r.sqlite3_result_error_js(f,p);return}try{switch(typeof p){case"undefined":break;case"boolean":r.sqlite3_result_int(f,p?1:0);break;case"bigint":O.bigIntFits32(p)?r.sqlite3_result_int(f,Number(p)):O.bigIntFitsDouble(p)?r.sqlite3_result_double(f,Number(p)):u.bigIntEnabled?O.bigIntFits64(p)?r.sqlite3_result_int64(f,p):j("BigInt value",p.toString(),"is too BigInt for int64."):j("BigInt value",p.toString(),"is too BigInt.");break;case"number":{let y;O.isInt32(p)?y=r.sqlite3_result_int:u.bigIntEnabled&&Number.isInteger(p)&&O.bigIntFits64(BigInt(p))?y=r.sqlite3_result_int64:y=r.sqlite3_result_double,y(f,p);break}case"string":{const[y,D]=u.allocCString(p,!0);r.sqlite3_result_text(f,y,D,r.SQLITE_WASM_DEALLOC);break}case"object":if(p===null){r.sqlite3_result_null(f);break}else if(O.isBindableTypedArray(p)){const y=u.allocFromTypedArray(p);r.sqlite3_result_blob(f,y,p.byteLength,r.SQLITE_WASM_DEALLOC);break}default:j("Don't not how to handle this UDF result value:",typeof p,p)}}catch(y){r.sqlite3_result_error_js(f,y)}},r.sqlite3_column_js=function(f,p,y=!0){const D=r.sqlite3_column_value(f,p);return D===0?void 0:r.sqlite3_value_to_js(D,y)};const A=(function(f,p,y){y=r[y],this.ptr?u.pokePtr(this.ptr,0):this.ptr=u.allocPtr();const D=y(f,p,this.ptr);if(D)return J.toss(D,arguments[2]+"() failed with code "+D);const H=u.peekPtr(this.ptr);return H?r.sqlite3_value_to_js(H,!0):void 0}).bind(Object.create(null));r.sqlite3_preupdate_new_js=(f,p)=>A(f,p,"sqlite3_preupdate_new"),r.sqlite3_preupdate_old_js=(f,p)=>A(f,p,"sqlite3_preupdate_old"),r.sqlite3changeset_new_js=(f,p)=>A(f,p,"sqlite3changeset_new"),r.sqlite3changeset_old_js=(f,p)=>A(f,p,"sqlite3changeset_old");const N={WasmAllocError:w,SQLite3Error:J,capi:r,util:O,wasm:u,config:i,version:Object.create(null),client:void 0,asyncPostInit:async function f(){if(f.isReady instanceof Promise)return f.isReady;let p=t.initializersAsync;delete t.initializersAsync;const y=async()=>(N.__isUnderTest||(delete N.util,delete N.StructBinder),N),D=re=>{throw i.error("an async sqlite3 initializer failed:",re),re};if(!p||!p.length)return f.isReady=y().catch(D);p=p.map(re=>re instanceof Function?async se=>re(N):re),p.push(y);let H=Promise.resolve(N);for(;p.length;)H=H.then(p.shift());return f.isReady=H.catch(D)},scriptInfo:void 0};try{t.initializers.forEach(f=>{f(N)})}catch(f){throw console.error("sqlite3 bootstrap initializer threw:",f),f}if(delete t.initializers,t.sqlite3=N,delete globalThis.sqlite3ApiBootstrap,delete globalThis.sqlite3ApiConfig,e.debugModule("sqlite3ApiBootstrap() complete",N),N.scriptInfo=e,N.__isUnderTest=s){N.config.emscripten=n;const f=e.instantiateWasm;f&&(N.wasm.module=f.module,N.wasm.instance=f.instance,N.wasm.imports=f.imports)}return N.asyncPostInit().then(f=>(e.debugModule("sqlite3.asyncPostInit() complete",N),delete f.asyncPostInit,delete f.scriptInfo,delete f.emscripten,f))},globalThis.sqlite3ApiBootstrap.initializers=[],globalThis.sqlite3ApiBootstrap.initializersAsync=[],globalThis.sqlite3ApiBootstrap.defaultConfig=Object.create(null),globalThis.sqlite3ApiBootstrap.sqlite3=void 0,globalThis.WhWasmUtilInstaller=function(t){t.bigIntEnabled===void 0&&(t.bigIntEnabled=!!globalThis.BigInt64Array);const c=(...o)=>{throw new Error(o.join(" "))};t.pointerSize&&!t.pointerIR&&(t.pointerIR=t.pointerSize===4?"i32":"i64");const i=t.pointerIR??(t.pointerIR="i32"),r=t.pointerSize??(t.pointerSize=i==="i32"?4:i==="i64"?8:0);delete t.pointerSize,delete t.pointerIR,i!=="i32"&&i!=="i64"?c("Invalid pointerIR:",i):r!==8&&r!==4&&c("Invalid pointerSize:",r);const u=t.bigIntEnabled?o=>BigInt(o||0):o=>c("BigInt support is disabled in this build."),P=r===4?o=>Number(o||0):u,J=P(0),j=function(...o){let l=P(0);for(const d of o)l+=P(d);return l};{const o=Object.create(null);Object.defineProperty(t,"ptr",{enumerable:!0,get:()=>o,set:()=>c("The ptr property is read-only.")}),(function l(d,m){return Object.defineProperty(o,d,{enumerable:!0,get:()=>m,set:()=>c("ptr["+d+"] is read-only.")}),l})("null",J)("size",r)("ir",i)("coerce",P)("add",j)("addn",i===4?j:(...l)=>Number(j(...l)))}t.exports||Object.defineProperty(t,"exports",{enumerable:!0,configurable:!0,get:()=>{var o;return(o=t.instance)==null?void 0:o.exports}});const I=Object.create(null);I.heapSize=0,I.memory=null,I.freeFuncIndexes=[],I.scopedAlloc=[],I.scopedAlloc.pushPtr=o=>(I.scopedAlloc[I.scopedAlloc.length-1].push(o),o),I.utf8Decoder=new TextDecoder,I.utf8Encoder=new TextEncoder("utf-8"),t.sizeofIR=o=>{switch(o){case"i8":return 1;case"i16":return 2;case"i32":case"f32":case"float":return 4;case"i64":case"f64":case"double":return 8;case"*":return r;default:return(""+o).endsWith("*")?r:void 0}};const F=function(){if(!I.memory)I.memory=t.memory instanceof WebAssembly.Memory?t.memory:t.exports.memory;else if(I.heapSize===I.memory.buffer.byteLength)return I;const o=I.memory.buffer;return I.HEAP8=new Int8Array(o),I.HEAP8U=new Uint8Array(o),I.HEAP16=new Int16Array(o),I.HEAP16U=new Uint16Array(o),I.HEAP32=new Int32Array(o),I.HEAP32U=new Uint32Array(o),I.HEAP32F=new Float32Array(o),I.HEAP64F=new Float64Array(o),t.bigIntEnabled&&(typeof BigInt64Array<"u"?(I.HEAP64=new BigInt64Array(o),I.HEAP64U=new BigUint64Array(o)):c("BigInt support is enabled, but the BigInt64Array type is missing.")),I.heapSize=o.byteLength,I};t.heap8=()=>F().HEAP8,t.heap8u=()=>F().HEAP8U,t.heap16=()=>F().HEAP16,t.heap16u=()=>F().HEAP16U,t.heap32=()=>F().HEAP32,t.heap32u=()=>F().HEAP32U,t.heapForSize=function(o,l=!0){const d=I.memory&&I.heapSize===I.memory.buffer.byteLength?I:F();switch(o){case Int8Array:return d.HEAP8;case Uint8Array:return d.HEAP8U;case Int16Array:return d.HEAP16;case Uint16Array:return d.HEAP16U;case Int32Array:return d.HEAP32;case Uint32Array:return d.HEAP32U;case 8:return l?d.HEAP8U:d.HEAP8;case 16:return l?d.HEAP16U:d.HEAP16;case 32:return l?d.HEAP32U:d.HEAP32;case 64:if(d.HEAP64)return l?d.HEAP64U:d.HEAP64;break;default:if(t.bigIntEnabled){if(o===globalThis.BigUint64Array)return d.HEAP64U;if(o===globalThis.BigInt64Array)return d.HEAP64;break}}c("Invalid heapForSize() size: expecting 8, 16, 32,","or (if BigInt is enabled) 64.")};const x=t.functionTable;delete t.functionTable,t.functionTable=x?()=>x:()=>t.exports.__indirect_function_table,t.functionEntry=function(o){const l=t.functionTable();return o<l.length?l.get(P(o)):void 0},t.jsFuncToWasm=function o(l,d){if(o._||(o._={sigTypes:Object.assign(Object.create(null),{i:"i32",p:i,P:i,s:i,j:"i64",f:"f32",d:"f64"}),typeCodes:Object.assign(Object.create(null),{f64:124,f32:125,i64:126,i32:127}),uleb128Encode:(ne,G,ce)=>{ce<128?ne[G](ce):ne[G](ce%128|128,ce>>7)},rxJSig:/^(\w)\((\w*)\)$/,sigParams:ne=>{const G=o._.rxJSig.exec(ne);return G?G[2]:ne.substr(1)},letterType:ne=>o._.sigTypes[ne]||c("Invalid signature letter:",ne),pushSigType:(ne,G)=>ne.push(o._.typeCodes[o._.letterType(G)])}),typeof l=="string"){const ne=d;d=l,l=ne}const m=o._,M=m.sigParams(d),Q=[1,96];m.uleb128Encode(Q,"push",M.length);for(const ne of M)m.pushSigType(Q,ne);return d[0]==="v"?Q.push(0):(Q.push(1),m.pushSigType(Q,d[0])),m.uleb128Encode(Q,"unshift",Q.length),Q.unshift(0,97,115,109,1,0,0,0,1),Q.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(Q)),{e:{f:l}}).exports.f};const L=function(l,d,m){if(m&&!I.scopedAlloc.length&&c("No scopedAllocPush() scope is active."),typeof l=="string"){const G=d;d=l,l=G}(typeof d!="string"||!(l instanceof Function))&&c("Invalid arguments: expecting (function,signature) or (signature,function).");const M=t.functionTable(),Q=P(M.length);let ne;for(;I.freeFuncIndexes.length&&(ne=I.freeFuncIndexes.pop(),M.get(ne));){ne=null;continue}ne||(ne=P(Q),M.grow(P(1)));try{return M.set(ne,l),m&&I.scopedAlloc.pushPtr(ne),ne}catch(G){if(!(G instanceof TypeError))throw ne===Q&&I.freeFuncIndexes.push(Q),G}try{const G=t.jsFuncToWasm(l,d);M.set(ne,G),m&&I.scopedAlloc.pushPtr(ne)}catch(G){throw ne===Q&&I.freeFuncIndexes.push(Q),G}return ne};t.installFunction=(o,l)=>L(o,l,!1),t.scopedInstallFunction=(o,l)=>L(o,l,!0),t.uninstallFunction=function(o){if(!o&&o!==0)return;const l=I.freeFuncIndexes,d=t.functionTable();l.push(o);const m=d.get(o);return d.set(o,null),m},t.peek=function(l,d="i8"){d.endsWith("*")&&(d=i);const m=I.memory&&I.heapSize===I.memory.buffer.byteLength?I:F(),M=Array.isArray(l)?[]:void 0;let Q;do{switch(M&&(l=arguments[0].shift()),d){case"i1":case"i8":Q=m.HEAP8[Number(l)>>0];break;case"i16":Q=m.HEAP16[Number(l)>>1];break;case"i32":Q=m.HEAP32[Number(l)>>2];break;case"float":case"f32":Q=m.HEAP32F[Number(l)>>2];break;case"double":case"f64":Q=Number(m.HEAP64F[Number(l)>>3]);break;case"i64":if(m.HEAP64){Q=u(m.HEAP64[Number(l)>>3]);break}default:c("Invalid type for peek():",d)}M&&M.push(Q)}while(M&&arguments[0].length);return M||Q},t.poke=function(o,l,d="i8"){d.endsWith("*")&&(d=i);const m=I.memory&&I.heapSize===I.memory.buffer.byteLength?I:F();for(const M of Array.isArray(o)?o:[o])switch(d){case"i1":case"i8":m.HEAP8[Number(M)>>0]=l;continue;case"i16":m.HEAP16[Number(M)>>1]=l;continue;case"i32":m.HEAP32[Number(M)>>2]=l;continue;case"float":case"f32":m.HEAP32F[Number(M)>>2]=l;continue;case"double":case"f64":m.HEAP64F[Number(M)>>3]=l;continue;case"i64":if(m.HEAP64){m.HEAP64[Number(M)>>3]=u(l);continue}default:c("Invalid type for poke(): "+d)}return this},t.peekPtr=(...o)=>t.peek(o.length===1?o[0]:o,i),t.pokePtr=(o,l=0)=>t.poke(o,l,i),t.peek8=(...o)=>t.peek(o.length===1?o[0]:o,"i8"),t.poke8=(o,l)=>t.poke(o,l,"i8"),t.peek16=(...o)=>t.peek(o.length===1?o[0]:o,"i16"),t.poke16=(o,l)=>t.poke(o,l,"i16"),t.peek32=(...o)=>t.peek(o.length===1?o[0]:o,"i32"),t.poke32=(o,l)=>t.poke(o,l,"i32"),t.peek64=(...o)=>t.peek(o.length===1?o[0]:o,"i64"),t.poke64=(o,l)=>t.poke(o,l,"i64"),t.peek32f=(...o)=>t.peek(o.length===1?o[0]:o,"f32"),t.poke32f=(o,l)=>t.poke(o,l,"f32"),t.peek64f=(...o)=>t.peek(o.length===1?o[0]:o,"f64"),t.poke64f=(o,l)=>t.poke(o,l,"f64"),t.getMemValue=t.peek,t.getPtrValue=t.peekPtr,t.setMemValue=t.poke,t.setPtrValue=t.pokePtr,t.isPtr32=o=>typeof o=="number"&&o>=0&&o===(o|0),t.isPtr64=o=>typeof o=="bigint"?o>=0:t.isPtr32(o),t.isPtr=r===4?t.isPtr32:t.isPtr64,t.cstrlen=function(o){if(!o||!t.isPtr(o))return null;o=Number(o);const l=F().HEAP8U;let d=o;for(;l[d]!==0;++d);return Number(d-o)};const K=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,U=o=>o.buffer instanceof K;t.isSharedTypedArray=U;const g=(o,l,d)=>(r===8&&(typeof l=="bigint"&&(l=Number(l)),typeof d=="bigint"&&(d=Number(d))),U(o)?o.slice(l,d):o.subarray(l,d));t.typedArrayPart=g;const q=(o,l,d)=>I.utf8Decoder.decode(g(o,l,d));t.typedArrayToString=q,t.cstrToJs=function(o){const l=t.cstrlen(o);return l?q(F().HEAP8U,Number(o),Number(o)+l):l===null?l:""},t.jstrlen=function(o){if(typeof o!="string")return null;const l=o.length;let d=0;for(let m=0;m<l;++m){let M=o.charCodeAt(m);M>=55296&&M<=57343&&(M=65536+((M&1023)<<10)|o.charCodeAt(++m)&1023),M<=127?++d:M<=2047?d+=2:M<=65535?d+=3:d+=4}return d},t.jstrcpy=function(o,l,d=0,m=-1,M=!0){if((!l||!(l instanceof Int8Array)&&!(l instanceof Uint8Array))&&c("jstrcpy() target must be an Int8Array or Uint8Array."),m=Number(m),d=Number(d),m<0&&(m=l.length-d),!(m>0)||!(d>=0))return 0;let Q=0,ne=o.length;const G=d,ce=d+m-(M?1:0);for(;Q<ne&&d<ce;++Q){let oe=o.charCodeAt(Q);if(oe>=55296&&oe<=57343&&(oe=65536+((oe&1023)<<10)|o.charCodeAt(++Q)&1023),oe<=127){if(d>=ce)break;l[d++]=oe}else if(oe<=2047){if(d+1>=ce)break;l[d++]=192|oe>>6,l[d++]=128|oe&63}else if(oe<=65535){if(d+2>=ce)break;l[d++]=224|oe>>12,l[d++]=128|oe>>6&63,l[d++]=128|oe&63}else{if(d+3>=ce)break;l[d++]=240|oe>>18,l[d++]=128|oe>>12&63,l[d++]=128|oe>>6&63,l[d++]=128|oe&63}}return M&&(l[d++]=0),d-G},t.cstrncpy=function(o,l,d){if((!o||!l)&&c("cstrncpy() does not accept NULL strings."),d<0)d=t.cstrlen(strPtr)+1;else if(!(d>0))return 0;const m=t.heap8u();let M=0,Q;const ne=Number(o),G=Number(l);for(;M<d&&(Q=m[G+M]);++M)m[ne+M]=Q;return M<d&&(m[ne+M++]=0),M},t.jstrToUintArray=(o,l=!1)=>I.utf8Encoder.encode(l?o+"\0":o);const w=(o,l)=>{(!(o.alloc instanceof Function)||!(o.dealloc instanceof Function))&&c("Object is missing alloc() and/or dealloc() function(s)","required by",l+"().")},O=function(o,l,d,m){if(w(t,m),typeof o!="string")return null;const M=I.utf8Encoder.encode(o),Q=d(M.length+1);let ne=Q;try{const G=F().HEAP8U;return G.set(M,Number(Q)),G[j(Q,M.length)]=0,ne=J,l?[Q,M.length]:Q}finally{ne&&t.dealloc(ne)}};t.allocCString=(o,l=!1)=>O(o,l,t.alloc,"allocCString()"),t.scopedAllocPush=function(){w(t,"scopedAllocPush");const o=[];return I.scopedAlloc.push(o),o},t.scopedAllocPop=function(o){w(t,"scopedAllocPop");const l=arguments.length?I.scopedAlloc.indexOf(o):I.scopedAlloc.length-1;l<0&&c("Invalid state object for scopedAllocPop()."),arguments.length===0&&(o=I.scopedAlloc[l]),I.scopedAlloc.splice(l,1);for(let d;d=o.pop();)t.functionEntry(d)?t.uninstallFunction(d):t.dealloc(d)},t.scopedAlloc=function(o){I.scopedAlloc.length||c("No scopedAllocPush() scope is active.");const l=P(t.alloc(o));return I.scopedAlloc.pushPtr(l)},Object.defineProperty(t.scopedAlloc,"level",{configurable:!1,enumerable:!1,get:()=>I.scopedAlloc.length,set:()=>c("The 'active' property is read-only.")}),t.scopedAllocCString=(o,l=!1)=>O(o,l,t.scopedAlloc,"scopedAllocCString()");const E=function(o,l){const d=t[o?"scopedAlloc":"alloc"]((l.length+1)*t.ptr.size);let m=0;return l.forEach(M=>{t.pokePtr(j(d,t.ptr.size*m++),t[o?"scopedAllocCString":"allocCString"](""+M))}),t.pokePtr(j(d,t.ptr.size*m),0),d};t.scopedAllocMainArgv=o=>E(!0,o),t.allocMainArgv=o=>E(!1,o),t.cArgvToJs=(o,l)=>{const d=[];for(let m=0;m<o;++m){const M=t.peekPtr(j(l,t.ptr.size*m));d.push(M?t.cstrToJs(M):null)}return d},t.scopedAllocCall=function(o){t.scopedAllocPush();try{return o()}finally{t.scopedAllocPop()}};const A=function(o,l,d){w(t,d);const m=l?"i64":i;let M=t[d](o*(l?8:r));if(t.poke(M,0,m),o===1)return M;const Q=[M];for(let ne=1;ne<o;++ne)M=j(M,l?8:r),Q[ne]=M,t.poke(M,0,m);return Q};t.allocPtr=(o=1,l=!0)=>A(o,l,"alloc"),t.scopedAllocPtr=(o=1,l=!0)=>A(o,l,"scopedAlloc"),t.xGet=function(o){return t.exports[o]||c("Cannot find exported symbol:",o)};const N=(o,l)=>c(o+"() requires",l,"argument(s).");t.xCall=function(o,...l){const d=o instanceof Function?o:t.xGet(o);return d instanceof Function||c("Exported symbol",o,"is not a function."),d.length!==l.length&&N(d===o?d.name:o,d.length),arguments.length===2&&Array.isArray(arguments[1])?d.apply(null,arguments[1]):d.apply(null,l)},I.xWrap=Object.create(null),I.xWrap.convert=Object.create(null),I.xWrap.convert.arg=new Map,I.xWrap.convert.result=new Map;const f=I.xWrap.convert.arg,p=I.xWrap.convert.result,y=P;f.set("i64",u).set("i32",o=>o|0).set("i16",o=>(o|0)&65535).set("i8",o=>(o|0)&255).set("f32",o=>Number(o).valueOf()).set("float",f.get("f32")).set("f64",f.get("f32")).set("double",f.get("f64")).set("int",f.get("i32")).set("null",o=>o).set(null,f.get("null")).set("**",y).set("*",y),p.set("*",y).set("pointer",y).set("number",o=>Number(o)).set("void",o=>{}).set(void 0,p.get("void")).set("null",o=>o).set(null,p.get("null"));for(const o of["i8","i16","i32","i64","int","f32","float","f64","double"])f.set(o+"*",y),p.set(o+"*",y),p.set(o,f.get(o)||c("Maintenance required: missing arg converter for",o));const D=o=>typeof o=="string"?t.scopedAllocCString(o):P(o);f.set("string",D).set("utf8",D),p.set("string",o=>t.cstrToJs(o)).set("utf8",p.get("string")).set("string:dealloc",o=>{try{return o?t.cstrToJs(o):null}finally{t.dealloc(o)}}).set("utf8:dealloc",p.get("string:dealloc")).set("json",o=>JSON.parse(t.cstrToJs(o))).set("json:dealloc",o=>{try{return o?JSON.parse(t.cstrToJs(o)):null}finally{t.dealloc(o)}});const H=class{constructor(o){this.name=o.name||"unnamed adapter"}convertArg(o,l,d){c("AbstractArgAdapter must be subclassed.")}};f.FuncPtrAdapter=class Ke extends H{constructor(l){super(l),f.FuncPtrAdapter.warnOnUse&&console.warn("xArg.FuncPtrAdapter is an internal-only API","and is not intended to be invoked from","client-level code. Invoked with:",l),this.name=l.name||"unnamed",this.signature=l.signature,l.contextKey instanceof Function&&(this.contextKey=l.contextKey,l.bindScope||(l.bindScope="context")),this.bindScope=l.bindScope||c("FuncPtrAdapter options requires a bindScope (explicit or implied)."),Ke.bindScopes.indexOf(l.bindScope)<0&&c("Invalid options.bindScope ("+l.bindMod+") for FuncPtrAdapter. Expecting one of: ("+Ke.bindScopes.join(", ")+")"),this.isTransient=this.bindScope==="transient",this.isContext=this.bindScope==="context",this.isPermanent=this.bindScope==="permanent",this.singleton=this.bindScope==="singleton"?[]:void 0,this.callProxy=l.callProxy instanceof Function?l.callProxy:void 0}contextKey(l,d){return this}contextMap(l){const d=this.__cmap||(this.__cmap=new Map);let m=d.get(l);return m===void 0&&d.set(l,m=[]),m}convertArg(l,d,m){let M=this.singleton;if(!M&&this.isContext&&(M=this.contextMap(this.contextKey(d,m))),M&&M.length===2&&M[0]===l)return M[1];if(l instanceof Function){this.callProxy&&(l=this.callProxy(l));const Q=L(l,this.signature,this.isTransient);if(Ke.debugFuncInstall&&Ke.debugOut("FuncPtrAdapter installed",this,this.contextKey(d,m),"@"+Q,l),M){if(M[1]){Ke.debugFuncInstall&&Ke.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(d,m),"@"+M[1],l);try{I.scopedAlloc.pushPtr(M[1])}catch{}}M[0]=arguments[0]||J,M[1]=Q}return Q}else if(t.isPtr(l)||l===null||l===void 0){if(M&&M[1]&&M[1]!==l){Ke.debugFuncInstall&&Ke.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(d,m),"@"+M[1],l);try{I.scopedAlloc.pushPtr(M[1])}catch{}M[0]=M[1]=l||J}return l||J}else throw new TypeError("Invalid FuncPtrAdapter argument type. Expecting a function pointer or a "+(this.name?this.name+" ":"")+"function matching signature "+this.signature+".")}},f.FuncPtrAdapter.warnOnUse=!1,f.FuncPtrAdapter.debugFuncInstall=!1,f.FuncPtrAdapter.debugOut=console.debug.bind(console),f.FuncPtrAdapter.bindScopes=["transient","context","singleton","permanent"];const re=o=>f.get(o)||c("Argument adapter not found:",o),se=o=>p.get(o)||c("Result adapter not found:",o);I.xWrap.convertArg=(o,...l)=>re(o)(...l),I.xWrap.convertArgNoCheck=(o,...l)=>f.get(o)(...l),I.xWrap.convertResult=(o,l)=>o===null?l:o?se(o)(l):void 0,I.xWrap.convertResultNoCheck=(o,l)=>o===null?l:o?p.get(o)(l):void 0,t.xWrap=function o(l,d,...m){arguments.length===3&&Array.isArray(arguments[2])&&(m=arguments[2]),t.isPtr(l)&&(l=t.functionEntry(l)||c("Function pointer not found in WASM function table."));const M=l instanceof Function,Q=M?l:t.xGet(l);if(M&&(l=Q.name||"unnamed function"),m.length!==Q.length&&N(l,Q.length),Q.length===0&&(d===null||d==="null"))return Q;se(d);for(const G of m)G instanceof H?f.set(G,(...ce)=>G.convertArg(...ce)):re(G);const ne=I.xWrap;return Q.length===0?(...G)=>G.length?N(l,Q.length):ne.convertResult(d,Q.call(null)):function(...G){G.length!==Q.length&&N(l,Q.length);const ce=t.scopedAllocPush();try{let oe=0;for(o.debug&&console.debug("xWrap() preparing: resultType ",d,"xf",Q,"argTypes",m,"args",G);oe<G.length;++oe)G[oe]=ne.convertArgNoCheck(m[oe],G[oe],G,oe);return o.debug&&console.debug("xWrap() calling: resultType ",d,"xf",Q,"argTypes",m,"args",G),ne.convertResultNoCheck(d,Q.apply(null,G))}finally{t.scopedAllocPop(ce)}}};const h=function(o,l,d,m,M,Q){if(typeof d=="string"){if(l===1)return Q.get(d);if(l===2){if(m)m instanceof Function||c(M,"requires a function argument.");else return Q.delete(d),o;return Q.set(d,m),o}}c("Invalid arguments to",M)};return t.xWrap.resultAdapter=function o(l,d){return h(o,arguments.length,l,d,"resultAdapter()",p)},t.xWrap.argAdapter=function o(l,d){return h(o,arguments.length,l,d,"argAdapter()",f)},t.xWrap.FuncPtrAdapter=f.FuncPtrAdapter,t.xCallWrapped=function(o,l,d,...m){return Array.isArray(arguments[3])&&(m=arguments[3]),t.xWrap(o,l,d||[]).apply(null,m||[])},t.xWrap.testConvertArg=I.xWrap.convertArg,t.xWrap.testConvertResult=I.xWrap.convertResult,t},globalThis.WhWasmUtilInstaller.yawl=(function(t){const c=()=>fetch(t.uri,{credentials:"same-origin"}),i=this,r=function(T){var P,J;if(t.wasmUtilTarget){const j=(...F)=>{throw new Error(F.join(" "))},I=t.wasmUtilTarget;if(I.module=T.module,I.instance=T.instance,I.instance.exports.memory||(I.memory=((J=(P=t==null?void 0:t.imports)==null?void 0:P.env)==null?void 0:J.memory)||j("Missing 'memory' object!")),!I.alloc&&T.instance.exports.malloc){const F=T.instance.exports;I.alloc=function(x){return F.malloc(x)||j("Allocation of",x,"bytes failed.")},I.dealloc=function(x){F.free(x)}}i(I)}return T.config=t,t.onload&&t.onload(T),T};return WebAssembly.instantiateStreaming?()=>WebAssembly.instantiateStreaming(c(),t.imports||{}).then(r):()=>c().then(T=>T.arrayBuffer()).then(T=>WebAssembly.instantiate(T,t.imports||{})).then(r)}).bind(globalThis.WhWasmUtilInstaller),globalThis.Jaccwabyt=function t(c){const i=(...k)=>{throw new Error(k.join(" "))};!(c.heap instanceof WebAssembly.Memory)&&!(c.heap instanceof Function)&&i("config.heap must be WebAssembly.Memory instance or a function."),["alloc","dealloc"].forEach(function(k){c[k]instanceof Function||i("Config option '"+k+"' must be a function.")});const r=c.heap,u=t,T=r||(()=>new Uint8Array(r.buffer)),P=c.alloc,J=c.dealloc,j=c.log||console.debug.bind(console),I=c.memberPrefix||"",F=c.memberSuffix||"",x=globalThis.BigInt,L=globalThis.BigInt64Array,K=c.bigIntEnabled??!!L,U=c.pointerIR||c.ptrIR||"i32",g=c.ptrSize||(U==="i32"?4:8);U!=="i32"&&U!=="i64"&&i("Invalid pointer representation:",U),g!==4&&g!==8&&i("Invalid pointer size:",g);const q=K&&x?k=>x(k||0):k=>i("BigInt support is disabled in this build."),w=U=="i32"?Number:q,O=w(0),E=function(...k){let $=O;for(let te=0;te<k.length;++te)$+=w(k[te]);return $};u.debugFlags||(u.__makeDebugFlags=function(k=null){k&&k.__flags&&(k=k.__flags);const $=function te(ae){return arguments.length===0?te.__flags:(ae<0?(delete te.__flags.getter,delete te.__flags.setter,delete te.__flags.alloc,delete te.__flags.dealloc):(te.__flags.getter=(1&ae)!==0,te.__flags.setter=(2&ae)!==0,te.__flags.alloc=(4&ae)!==0,te.__flags.dealloc=(8&ae)!==0),te._flags)};return Object.defineProperty($,"__flags",{iterable:!1,writable:!1,value:Object.create(k)}),k||$(0),$},u.debugFlags=u.__makeDebugFlags());const A=(function(){const k=new ArrayBuffer(2);return new DataView(k).setInt16(0,256,!0),new Int16Array(k)[0]===256})(),N=k=>k[1]==="(",f=k=>k==="P",p=k=>N(k)?"p":k[0],y=function(k){switch(p(k)){case"c":case"C":return"i8";case"i":return"i32";case"p":case"P":case"s":return U;case"j":return"i64";case"f":return"float";case"d":return"double"}i("Unhandled signature IR:",k)},D=L?()=>!0:()=>i("BigInt64Array is not available."),H=function(k){switch(p(k)){case"p":case"P":case"s":{switch(g){case 4:return"getInt32";case 8:return D()&&"getBigInt64"}break}case"i":return"getInt32";case"c":return"getInt8";case"C":return"getUint8";case"j":return D()&&"getBigInt64";case"f":return"getFloat32";case"d":return"getFloat64"}i("Unhandled DataView getter for signature:",k)},re=function(k){switch(p(k)){case"p":case"P":case"s":{switch(g){case 4:return"setInt32";case 8:return D()&&"setBigInt64"}break}case"i":return"setInt32";case"c":return"setInt8";case"C":return"setUint8";case"j":return D()&&"setBigInt64";case"f":return"setFloat32";case"d":return"setFloat64"}i("Unhandled DataView setter for signature:",k)},se=function(k){switch(p(k)){case"i":case"f":case"c":case"C":case"d":return Number;case"j":return q;case"p":case"P":case"s":switch(g){case 4:return Number;case 8:return q}break}i("Unhandled DataView set wrapper for signature:",k)},h=(k,$)=>k+"::"+$,o=function(k,$){return()=>i(h(k,$),"is read-only.")},l=new WeakMap,d="(pointer-is-external)",m=k=>typeof k=="number"&&k===(k|0)&&k>=0,Q=g===4?m:k=>typeof k=="bigint"&&k>=0||m(k),ne=function(k,$,te){if(te||(te=l.get($)),te){if(l.delete($),Array.isArray($.ondispose)){let ae;for(;ae=$.ondispose.shift();)try{ae instanceof Function?ae.call($):ae instanceof Y?ae.dispose():Q(ae)&&J(ae)}catch(we){console.warn("ondispose() for",k.structName,"@",te,"threw. NOT propagating it.",we)}}else if($.ondispose instanceof Function)try{$.ondispose()}catch(ae){console.warn("ondispose() for",k.structName,"@",te,"threw. NOT propagating it.",ae)}delete $.ondispose,k.debugFlags.__flags.dealloc&&j("debug.dealloc:",$[d]?"EXTERNAL":"",k.structName,"instance:",k.structInfo.sizeof,"bytes @"+te),$[d]||J(te)}},G=k=>({configurable:!1,writable:!1,iterable:!1,value:k}),ce=function(k,$,te){let ae=!te;te?Object.defineProperty($,d,G(te)):(te=P(k.structInfo.sizeof),te||i("Allocation of",k.structName,"structure failed."));try{k.debugFlags.__flags.alloc&&j("debug.alloc:",ae?"":"EXTERNAL",k.structName,"instance:",k.structInfo.sizeof,"bytes @"+te),ae&&T().fill(0,Number(te),Number(te)+k.structInfo.sizeof),l.set($,te)}catch(we){throw ne(k,$,te),we}},oe=function(){const k=this.pointer;return k?new Uint8Array(T().slice(Number(k),Number(k)+this.structInfo.sizeof)):null},pe=G(k=>I+k+F),ye=function(k,$,te=!0){let ae=k.members[$];if(!ae&&(I||F)){for(const we of Object.values(k.members))if(we.key===$){ae=we;break}!ae&&te&&i(h(k.name,$),"is not a mapped struct member.")}return ae},Ne=function k($,te,ae=!1){k._||(k._=Ce=>Ce.replace(/[^vipPsjrdcC]/g,"").replace(/[pPscC]/g,"i"));const we=ye($.structInfo,te,!0);return ae?k._(we.signature):we.signature},S={configurable:!1,enumerable:!1,get:function(){return l.get(this)},set:()=>i("Cannot assign the 'pointer' property of a struct.")},B=G(function(){const k=[];for(const $ of Object.keys(this.structInfo.members))k.push(this.memberKey($));return k}),W=new TextDecoder("utf-8"),Z=new TextEncoder,X=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,ue=function(k,$,te){return g===8&&($=Number($),te=Number(te)),W.decode(k.buffer instanceof X?k.slice($,te):k.subarray($,te))},le=function(k,$,te=!1){const ae=ye(k.structInfo,$,te);return ae&&ae.signature.length===1&&ae.signature[0]==="s"?ae:!1},R=function(k){k.signature!=="s"&&i("Invalid member type signature for C-string value:",JSON.stringify(k))},b=function($,te){const ae=ye($.structInfo,te,!0);R(ae);const we=$[ae.key];if(!we)return null;let Ce=we;const Re=T();for(;Re[Ce]!==0;++Ce);return we===Ce?"":ue(Re,we,Ce)},C=function(k,...$){k.ondispose?Array.isArray(k.ondispose)||(k.ondispose=[k.ondispose]):k.ondispose=[],k.ondispose.push(...$)},z=function(k){const $=Z.encode(k),te=P($.length+1);te||i("Allocation error while duplicating string:",k);const ae=T();return ae.set($,Number(te)),ae[E(te,$.length)]=0,te},V=function(k,$,te){const ae=ye(k.structInfo,$,!0);R(ae);const we=z(te);return k[ae.key]=we,C(k,we),k},Y=function($,te){arguments[2]!==G&&i("Do not call the StructType constructor","from client-level code."),Object.defineProperties(this,{structName:G($),structInfo:G(te)})};Y.prototype=Object.create(null,{dispose:G(function(){ne(this.constructor,this)}),lookupMember:G(function(k,$=!0){return ye(this.structInfo,k,$)}),memberToJsString:G(function(k){return b(this,k)}),memberIsString:G(function(k,$=!0){return le(this,k,$)}),memberKey:pe,memberKeys:B,memberSignature:G(function(k,$=!1){return Ne(this,k,$)}),memoryDump:G(oe),pointer:S,setMemberCString:G(function(k,$){return V(this,k,$)})}),Object.assign(Y.prototype,{addOnDispose:function(...k){return C(this,...k),this}}),Object.defineProperties(Y,{allocCString:G(z),isA:G(k=>k instanceof Y),hasExternalPointer:G(k=>k instanceof Y&&!!k[d]),memberKey:pe});const fe=function k($,te,ae){if(!k._){k._={getters:{},setters:{},sw:{}};const Be=["i","c","C","p","P","s","f","d","v()"];K&&Be.push("j"),Be.forEach(function(Ge){k._.getters[Ge]=H(Ge),k._.setters[Ge]=re(Ge),k._.sw[Ge]=se(Ge)});const _r=/^[ipPsjfdcC]$/,fr=/^[vipPsjfdcC]\([ipPsjfdcC]*\)$/;k.sigCheck=function(Ge,dr,Gt,Et){Object.prototype.hasOwnProperty.call(Ge,Gt)&&i(Ge.structName,"already has a property named",Gt+"."),_r.test(Et)||fr.test(Et)||i("Malformed signature for",h(Ge.structName,dr)+":",Et)}}const we=$.memberKey(te);k.sigCheck($.prototype,te,we,ae.signature),ae.key=we,ae.name=te;const Ce=p(ae.signature),Re=h($.prototype.structName,we),xe=$.prototype.debugFlags.__flags,Se=Object.create(null);Se.configurable=!1,Se.enumerable=!1,Se.get=function(){xe.getter&&j("debug.getter:",k._.getters[Ce],"for",y(Ce),Re,"@",this.pointer,"+",ae.offset,"sz",ae.sizeof);let Be=new DataView(T().buffer,Number(this.pointer)+ae.offset,ae.sizeof)[k._.getters[Ce]](0,A);return xe.getter&&j("debug.getter:",Re,"result =",Be),Be},ae.readOnly?Se.set=o($.prototype.structName,we):Se.set=function(Be){if(xe.setter&&j("debug.setter:",k._.setters[Ce],"for",y(Ce),Re,"@",this.pointer,"+",ae.offset,"sz",ae.sizeof,Be),this.pointer||i("Cannot set struct property on disposed instance."),Be===null)Be=O;else for(;!Q(Be);){if(f(ae.signature)&&Be instanceof Y){Be=Be.pointer||O,xe.setter&&j("debug.setter:",Re,"resolved to",Be);break}i("Invalid value for pointer-type",Re+".")}new DataView(T().buffer,Number(this.pointer)+ae.offset,ae.sizeof)[k._.setters[Ce]](0,k._.sw[Ce](Be),A)},Object.defineProperty($.prototype,we,Se)},be=function k($,te){arguments.length===1?(te=$,$=te.name):te.name||(te.name=$),$||i("Struct name is required.");let ae=!1;Object.keys(te.members).forEach(xe=>{const Se=te.members[xe];Se.sizeof?Se.sizeof===1?Se.signature==="c"||Se.signature==="C"||i("Unexpected sizeof==1 member",h(te.name,xe),"with signature",Se.signature):(Se.sizeof%4!==0&&(console.warn("Invalid struct member description =",Se,"from",te),i($,"member",xe,"sizeof is not aligned. sizeof="+Se.sizeof)),Se.offset%4!==0&&(console.warn("Invalid struct member description =",Se,"from",te),i($,"member",xe,"offset is not aligned. offset="+Se.offset))):i($,"member",xe,"is missing sizeof."),(!ae||ae.offset<Se.offset)&&(ae=Se)}),ae?te.sizeof<ae.offset+ae.sizeof&&i("Invalid struct config:",$,"max member offset ("+ae.offset+") ","extends past end of struct (sizeof="+te.sizeof+")."):i("No member property descriptions found.");const we=G(u.__makeDebugFlags(k.debugFlags)),Ce=w(0),Re=function xe(Se){Se=w(Se),this instanceof xe?arguments.length?((Number.isNaN(Se)||Se<=Ce)&&i("Invalid pointer value",arguments[0],"for",$,"constructor."),ce(xe,this,Se)):ce(xe,this):i("The",$,"constructor may only be called via 'new'.")};return Object.defineProperties(Re,{debugFlags:we,isA:G(xe=>xe instanceof Re),memberKey:pe,memberKeys:B,methodInfoForKey:G(function(xe){}),structInfo:G(te),structName:G($)}),Re.prototype=new Y($,te,G),Object.defineProperties(Re.prototype,{debugFlags:we,constructor:G(Re)}),Object.keys(te.members).forEach(xe=>fe(Re,xe,te.members[xe])),Re};return be.StructType=Y,be.config=c,be.allocCString=z,be.debugFlags||(be.debugFlags=u.__makeDebugFlags(u.debugFlags)),be},globalThis.sqlite3ApiBootstrap.initializers.push(function(t){const c=(...g)=>{throw new Error(g.join(" "))},i=t.capi,r=t.wasm,u=t.util;globalThis.WhWasmUtilInstaller(r),delete globalThis.WhWasmUtilInstaller;const T={core:[["sqlite3_aggregate_context","void*","sqlite3_context*","int"],["sqlite3_bind_double","int","sqlite3_stmt*","int","f64"],["sqlite3_bind_int","int","sqlite3_stmt*","int","int"],["sqlite3_bind_null",void 0,"sqlite3_stmt*","int"],["sqlite3_bind_parameter_count","int","sqlite3_stmt*"],["sqlite3_bind_parameter_index","int","sqlite3_stmt*","string"],["sqlite3_bind_parameter_name","string","sqlite3_stmt*","int"],["sqlite3_bind_pointer","int","sqlite3_stmt*","int","*","string:static","*"],["sqlite3_busy_handler","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({signature:"i(pi)",contextKey:(g,q)=>g[0]}),"*"]],["sqlite3_busy_timeout","int","sqlite3*","int"],["sqlite3_changes","int","sqlite3*"],["sqlite3_clear_bindings","int","sqlite3_stmt*"],["sqlite3_collation_needed","int","sqlite3*","*","*"],["sqlite3_column_blob","*","sqlite3_stmt*","int"],["sqlite3_column_bytes","int","sqlite3_stmt*","int"],["sqlite3_column_count","int","sqlite3_stmt*"],["sqlite3_column_decltype","string","sqlite3_stmt*","int"],["sqlite3_column_double","f64","sqlite3_stmt*","int"],["sqlite3_column_int","int","sqlite3_stmt*","int"],["sqlite3_column_name","string","sqlite3_stmt*","int"],["sqlite3_column_text","string","sqlite3_stmt*","int"],["sqlite3_column_type","int","sqlite3_stmt*","int"],["sqlite3_column_value","sqlite3_value*","sqlite3_stmt*","int"],["sqlite3_commit_hook","void*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_commit_hook",signature:"i(p)",contextKey:g=>g[0]}),"*"]],["sqlite3_compileoption_get","string","int"],["sqlite3_compileoption_used","int","string"],["sqlite3_complete","int","string:flexible"],["sqlite3_context_db_handle","sqlite3*","sqlite3_context*"],["sqlite3_data_count","int","sqlite3_stmt*"],["sqlite3_db_filename","string","sqlite3*","string"],["sqlite3_db_handle","sqlite3*","sqlite3_stmt*"],["sqlite3_db_name","string","sqlite3*","int"],["sqlite3_db_readonly","int","sqlite3*","string"],["sqlite3_db_status","int","sqlite3*","int","*","*","int"],["sqlite3_errcode","int","sqlite3*"],["sqlite3_errmsg","string","sqlite3*"],["sqlite3_error_offset","int","sqlite3*"],["sqlite3_errstr","string","int"],["sqlite3_exec","int",["sqlite3*","string:flexible",new r.xWrap.FuncPtrAdapter({signature:"i(pipp)",bindScope:"transient",callProxy:g=>{let q;return(w,O,E,A)=>{try{const N=r.cArgvToJs(O,E);return q||(q=r.cArgvToJs(O,A)),g(N,q)|0}catch(N){return N.resultCode||i.SQLITE_ERROR}}}}),"*","**"]],["sqlite3_expanded_sql","string","sqlite3_stmt*"],["sqlite3_extended_errcode","int","sqlite3*"],["sqlite3_extended_result_codes","int","sqlite3*","int"],["sqlite3_file_control","int","sqlite3*","string","int","*"],["sqlite3_finalize","int","sqlite3_stmt*"],["sqlite3_free",void 0,"*"],["sqlite3_get_autocommit","int","sqlite3*"],["sqlite3_get_auxdata","*","sqlite3_context*","int"],["sqlite3_initialize",void 0],["sqlite3_interrupt",void 0,"sqlite3*"],["sqlite3_is_interrupted","int","sqlite3*"],["sqlite3_keyword_count","int"],["sqlite3_keyword_name","int",["int","**","*"]],["sqlite3_keyword_check","int",["string","int"]],["sqlite3_libversion","string"],["sqlite3_libversion_number","int"],["sqlite3_limit","int",["sqlite3*","int","int"]],["sqlite3_malloc","*","int"],["sqlite3_open","int","string","*"],["sqlite3_open_v2","int","string","*","int","string"],["sqlite3_realloc","*","*","int"],["sqlite3_reset","int","sqlite3_stmt*"],["sqlite3_result_blob",void 0,"sqlite3_context*","*","int","*"],["sqlite3_result_double",void 0,"sqlite3_context*","f64"],["sqlite3_result_error",void 0,"sqlite3_context*","string","int"],["sqlite3_result_error_code",void 0,"sqlite3_context*","int"],["sqlite3_result_error_nomem",void 0,"sqlite3_context*"],["sqlite3_result_error_toobig",void 0,"sqlite3_context*"],["sqlite3_result_int",void 0,"sqlite3_context*","int"],["sqlite3_result_null",void 0,"sqlite3_context*"],["sqlite3_result_pointer",void 0,"sqlite3_context*","*","string:static","*"],["sqlite3_result_subtype",void 0,"sqlite3_value*","int"],["sqlite3_result_text",void 0,"sqlite3_context*","string","int","*"],["sqlite3_result_zeroblob",void 0,"sqlite3_context*","int"],["sqlite3_rollback_hook","void*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_rollback_hook",signature:"v(p)",contextKey:g=>g[0]}),"*"]],["sqlite3_set_auxdata",void 0,["sqlite3_context*","int","*","*"]],["sqlite3_set_errmsg","int","sqlite3*","int","string"],["sqlite3_shutdown",void 0],["sqlite3_sourceid","string"],["sqlite3_sql","string","sqlite3_stmt*"],["sqlite3_status","int","int","*","*","int"],["sqlite3_step","int","sqlite3_stmt*"],["sqlite3_stmt_busy","int","sqlite3_stmt*"],["sqlite3_stmt_readonly","int","sqlite3_stmt*"],["sqlite3_stmt_status","int","sqlite3_stmt*","int","int"],["sqlite3_strglob","int","string","string"],["sqlite3_stricmp","int","string","string"],["sqlite3_strlike","int","string","string","int"],["sqlite3_strnicmp","int","string","string","int"],["sqlite3_table_column_metadata","int","sqlite3*","string","string","string","**","**","*","*","*"],["sqlite3_total_changes","int","sqlite3*"],["sqlite3_trace_v2","int",["sqlite3*","int",new r.xWrap.FuncPtrAdapter({name:"sqlite3_trace_v2::callback",signature:"i(ippp)",contextKey:(g,q)=>g[0]}),"*"]],["sqlite3_txn_state","int",["sqlite3*","string"]],["sqlite3_uri_boolean","int","sqlite3_filename","string","int"],["sqlite3_uri_key","string","sqlite3_filename","int"],["sqlite3_uri_parameter","string","sqlite3_filename","string"],["sqlite3_user_data","void*","sqlite3_context*"],["sqlite3_value_blob","*","sqlite3_value*"],["sqlite3_value_bytes","int","sqlite3_value*"],["sqlite3_value_double","f64","sqlite3_value*"],["sqlite3_value_dup","sqlite3_value*","sqlite3_value*"],["sqlite3_value_free",void 0,"sqlite3_value*"],["sqlite3_value_frombind","int","sqlite3_value*"],["sqlite3_value_int","int","sqlite3_value*"],["sqlite3_value_nochange","int","sqlite3_value*"],["sqlite3_value_numeric_type","int","sqlite3_value*"],["sqlite3_value_pointer","*","sqlite3_value*","string:static"],["sqlite3_value_subtype","int","sqlite3_value*"],["sqlite3_value_text","string","sqlite3_value*"],["sqlite3_value_type","int","sqlite3_value*"],["sqlite3_vfs_find","*","string"],["sqlite3_vfs_register","int","sqlite3_vfs*","int"],["sqlite3_vfs_unregister","int","sqlite3_vfs*"]],int64:[["sqlite3_bind_int64","int",["sqlite3_stmt*","int","i64"]],["sqlite3_changes64","i64",["sqlite3*"]],["sqlite3_column_int64","i64",["sqlite3_stmt*","int"]],["sqlite3_deserialize","int","sqlite3*","string","*","i64","i64","int"],["sqlite3_last_insert_rowid","i64",["sqlite3*"]],["sqlite3_malloc64","*","i64"],["sqlite3_msize","i64","*"],["sqlite3_overload_function","int",["sqlite3*","string","int"]],["sqlite3_realloc64","*","*","i64"],["sqlite3_result_int64",void 0,"*","i64"],["sqlite3_result_zeroblob64","int","*","i64"],["sqlite3_serialize","*","sqlite3*","string","*","int"],["sqlite3_set_last_insert_rowid",void 0,["sqlite3*","i64"]],["sqlite3_status64","int","int","*","*","int"],["sqlite3_db_status64","int","sqlite3*","int","*","*","int"],["sqlite3_total_changes64","i64",["sqlite3*"]],["sqlite3_update_hook","*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_update_hook::callback",signature:"v(pippj)",contextKey:g=>g[0],callProxy:g=>(q,w,O,E,A)=>{g(q,w,r.cstrToJs(O),r.cstrToJs(E),A)}}),"*"]],["sqlite3_uri_int64","i64",["sqlite3_filename","string","i64"]],["sqlite3_value_int64","i64","sqlite3_value*"]],wasmInternal:[["sqlite3__wasm_db_reset","int","sqlite3*"],["sqlite3__wasm_db_vfs","sqlite3_vfs*","sqlite3*","string"],["sqlite3__wasm_vfs_create_file","int","sqlite3_vfs*","string","*","int"],["sqlite3__wasm_posix_create_file","int","string","*","int"],["sqlite3__wasm_vfs_unlink","int","sqlite3_vfs*","string"],["sqlite3__wasm_qfmt_token","string:dealloc","string","int"]]};if(r.exports.sqlite3_progress_handler&&T.core.push(["sqlite3_progress_handler",void 0,["sqlite3*","int",new r.xWrap.FuncPtrAdapter({name:"xProgressHandler",signature:"i(p)",bindScope:"context",contextKey:(g,q)=>g[0]}),"*"]]),r.exports.sqlite3_stmt_explain&&T.core.push(["sqlite3_stmt_explain","int","sqlite3_stmt*","int"],["sqlite3_stmt_isexplain","int","sqlite3_stmt*"]),r.exports.sqlite3_set_authorizer&&T.core.push(["sqlite3_set_authorizer","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_set_authorizer::xAuth",signature:"i(pissss)",contextKey:(g,q)=>g[0],callProxy:g=>(q,w,O,E,A,N)=>{try{return O=O&&r.cstrToJs(O),E=E&&r.cstrToJs(E),A=A&&r.cstrToJs(A),N=N&&r.cstrToJs(N),g(q,w,O,E,A,N)|0}catch(f){return f.resultCode||i.SQLITE_ERROR}}}),"*"]]),r.exports.sqlite3_column_origin_name&&T.core.push(["sqlite3_column_database_name","string","sqlite3_stmt*","int"],["sqlite3_column_origin_name","string","sqlite3_stmt*","int"],["sqlite3_column_table_name","string","sqlite3_stmt*","int"]),r.bigIntEnabled&&r.exports.sqlite3_declare_vtab&&T.int64.push(["sqlite3_create_module","int",["sqlite3*","string","sqlite3_module*","*"]],["sqlite3_create_module_v2","int",["sqlite3*","string","sqlite3_module*","*","*"]],["sqlite3_declare_vtab","int",["sqlite3*","string:flexible"]],["sqlite3_drop_modules","int",["sqlite3*","**"]],["sqlite3_vtab_collation","string","sqlite3_index_info*","int"],["sqlite3_vtab_distinct","int","sqlite3_index_info*"],["sqlite3_vtab_in","int","sqlite3_index_info*","int","int"],["sqlite3_vtab_in_first","int","sqlite3_value*","**"],["sqlite3_vtab_in_next","int","sqlite3_value*","**"],["sqlite3_vtab_nochange","int","sqlite3_context*"],["sqlite3_vtab_on_conflict","int","sqlite3*"],["sqlite3_vtab_rhs_value","int","sqlite3_index_info*","int","**"]),r.bigIntEnabled&&r.exports.sqlite3_preupdate_hook&&T.int64.push(["sqlite3_preupdate_blobwrite","int","sqlite3*"],["sqlite3_preupdate_count","int","sqlite3*"],["sqlite3_preupdate_depth","int","sqlite3*"],["sqlite3_preupdate_hook","*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_preupdate_hook",signature:"v(ppippjj)",contextKey:g=>g[0],callProxy:g=>(q,w,O,E,A,N,f)=>{g(q,w,O,r.cstrToJs(E),r.cstrToJs(A),N,f)}}),"*"]],["sqlite3_preupdate_new","int",["sqlite3*","int","**"]],["sqlite3_preupdate_old","int",["sqlite3*","int","**"]]),r.bigIntEnabled&&r.exports.sqlite3changegroup_add&&r.exports.sqlite3session_create&&r.exports.sqlite3_preupdate_hook){const g={signature:"i(ps)",callProxy:q=>(w,O)=>{try{return q(w,r.cstrToJs(O))|0}catch(E){return E.resultCode||i.SQLITE_ERROR}}};T.int64.push(["sqlite3changegroup_add","int",["sqlite3_changegroup*","int","void*"]],["sqlite3changegroup_add_strm","int",["sqlite3_changegroup*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changegroup_delete",void 0,["sqlite3_changegroup*"]],["sqlite3changegroup_new","int",["**"]],["sqlite3changegroup_output","int",["sqlite3_changegroup*","int*","**"]],["sqlite3changegroup_output_strm","int",["sqlite3_changegroup*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...g}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...g}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_v2","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...g}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v2_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...g}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_concat","int",["int","void*","int","void*","int*","**"]],["sqlite3changeset_concat_strm","int",[new r.xWrap.FuncPtrAdapter({name:"xInputA",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xInputB",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_conflict","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_finalize","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_fk_conflicts","int",["sqlite3_changeset_iter*","int*"]],["sqlite3changeset_invert","int",["int","void*","int*","**"]],["sqlite3changeset_invert_strm","int",[new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_new","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_next","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_old","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_op","int",["sqlite3_changeset_iter*","**","int*","int*","int*"]],["sqlite3changeset_pk","int",["sqlite3_changeset_iter*","**","int*"]],["sqlite3changeset_start","int",["**","int","*"]],["sqlite3changeset_start_strm","int",["**",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changeset_start_v2","int",["**","int","*","int"]],["sqlite3changeset_start_v2_strm","int",["**",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*","int"]],["sqlite3session_attach","int",["sqlite3_session*","string"]],["sqlite3session_changeset","int",["sqlite3_session*","int*","**"]],["sqlite3session_changeset_size","i64",["sqlite3_session*"]],["sqlite3session_changeset_strm","int",["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_config","int",["int","void*"]],["sqlite3session_create","int",["sqlite3*","string","**"]],["sqlite3session_diff","int",["sqlite3_session*","string","string","**"]],["sqlite3session_enable","int",["sqlite3_session*","int"]],["sqlite3session_indirect","int",["sqlite3_session*","int"]],["sqlite3session_isempty","int",["sqlite3_session*"]],["sqlite3session_memory_used","i64",["sqlite3_session*"]],["sqlite3session_object_config","int",["sqlite3_session*","int","void*"]],["sqlite3session_patchset","int",["sqlite3_session*","*","**"]],["sqlite3session_patchset_strm","int",["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_table_filter",void 0,["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xFilter",...g,contextKey:(q,w)=>q[0]}),"*"]])}t.StructBinder=globalThis.Jaccwabyt({heap:r.heap8u,alloc:r.alloc,dealloc:r.dealloc,bigIntEnabled:r.bigIntEnabled,pointerIR:r.ptr.ir,memberPrefix:"$"}),delete globalThis.Jaccwabyt;{const g=r.xWrap.argAdapter("string");r.xWrap.argAdapter("string:flexible",E=>g(u.flexibleString(E))),r.xWrap.argAdapter("string:static",(function(E){return r.isPtr(E)?E:(E=""+E,this[E]||(this[E]=r.allocCString(E)))}).bind(Object.create(null)));const q=r.xWrap.argAdapter("*"),w=function(){};r.xWrap.argAdapter("sqlite3_filename",q)("sqlite3_context*",q)("sqlite3_value*",q)("void*",q)("sqlite3_changegroup*",q)("sqlite3_changeset_iter*",q)("sqlite3_session*",q)("sqlite3_stmt*",E=>{var A;return q(E instanceof(((A=t==null?void 0:t.oo1)==null?void 0:A.Stmt)||w)?E.pointer:E)})("sqlite3*",E=>{var A;return q(E instanceof(((A=t==null?void 0:t.oo1)==null?void 0:A.DB)||w)?E.pointer:E)})("sqlite3_vfs*",E=>typeof E=="string"?i.sqlite3_vfs_find(E)||t.SQLite3Error.toss(i.SQLITE_NOTFOUND,"Unknown sqlite3_vfs name:",E):q(E instanceof(i.sqlite3_vfs||w)?E.pointer:E)),r.exports.sqlite3_declare_vtab&&r.xWrap.argAdapter("sqlite3_index_info*",E=>q(E instanceof(i.sqlite3_index_info||w)?E.pointer:E))("sqlite3_module*",E=>q(E instanceof(i.sqlite3_module||w)?E.pointer:E));const O=r.xWrap.resultAdapter("*");r.xWrap.resultAdapter("sqlite3*",O)("sqlite3_context*",O)("sqlite3_stmt*",O)("sqlite3_value*",O)("sqlite3_vfs*",O)("void*",O);for(const E of T.core)i[E[0]]=r.xWrap.apply(null,E);for(const E of T.wasmInternal)u[E[0]]=r.xWrap.apply(null,E);for(const E of T.int64)i[E[0]]=r.bigIntEnabled?r.xWrap.apply(null,E):()=>c(E[0]+"() is unavailable due to lack","of BigInt support in this build.");delete T.core,delete T.int64,delete T.wasmInternal,u.sqlite3__wasm_db_error=function(E,A,N){return E?(A instanceof t.WasmAllocError?(A=i.SQLITE_NOMEM,N=0):A instanceof Error&&(N=N||""+A,A=A.resultCode||i.SQLITE_ERROR),i.sqlite3_set_errmsg(E,A,N)||A):i.SQLITE_MISUSE}}{const g=r.xCall("sqlite3__wasm_enum_json");g||c("Maintenance required: increase sqlite3__wasm_enum_json()'s","static buffer size!"),r.ctype=JSON.parse(r.cstrToJs(g));const q=["access","authorizer","blobFinalizers","changeset","config","dataTypes","dbConfig","dbStatus","encodings","fcntl","flock","ioCap","limits","openFlags","prepareFlags","resultCodes","sqlite3Status","stmtStatus","syncFlags","trace","txnState","udfFlags","version"];r.bigIntEnabled&&q.push("serialize","session","vtab");for(const E of q)for(const A of Object.entries(r.ctype[E]))i[A[0]]=A[1];r.functionEntry(i.SQLITE_WASM_DEALLOC)||c("Internal error: cannot resolve exported function","entry SQLITE_WASM_DEALLOC (=="+i.SQLITE_WASM_DEALLOC+").");const w=Object.create(null);for(const E of["resultCodes"])for(const A of Object.entries(r.ctype[E]))w[A[1]]=A[0];i.sqlite3_js_rc_str=E=>w[E];const O=Object.assign(Object.create(null),{WasmTestStruct:!0,sqlite3_kvvfs_methods:!u.isUIThread(),sqlite3_index_info:!r.bigIntEnabled,sqlite3_index_constraint:!r.bigIntEnabled,sqlite3_index_orderby:!r.bigIntEnabled,sqlite3_index_constraint_usage:!r.bigIntEnabled});for(const E of r.ctype.structs)O[E.name]||(i[E.name]=t.StructBinder(E));if(i.sqlite3_index_info){for(const E of["sqlite3_index_constraint","sqlite3_index_orderby","sqlite3_index_constraint_usage"])i.sqlite3_index_info[E]=i[E],delete i[E];i.sqlite3_vtab_config=r.xWrap("sqlite3__wasm_vtab_config","int",["sqlite3*","int","int"])}}const P=(g,q,w)=>u.sqlite3__wasm_db_error(g,i.SQLITE_MISUSE,q+"() requires "+w+" argument"+(w===1?"":"s")+"."),J=g=>u.sqlite3__wasm_db_error(g,i.SQLITE_FORMAT,"SQLITE_UTF8 is the only supported encoding."),j=g=>r.xWrap.argAdapter("sqlite3*")(g),I=g=>r.isPtr(g)?r.cstrToJs(g):g,F=(function(g,q){g=j(g);let w=this.dbMap.get(g);if(q)!w&&q>0&&this.dbMap.set(g,w=Object.create(null));else return this.dbMap.delete(g),w;return w}).bind(Object.assign(Object.create(null),{dbMap:new Map}));F.addCollation=function(g,q){const w=F(g,1);w.collation||(w.collation=new Set),w.collation.add(I(q).toLowerCase())},F._addUDF=function(g,q,w,O){q=I(q).toLowerCase();let E=O.get(q);E||O.set(q,E=new Set),E.add(w<0?-1:w)},F.addFunction=function(g,q,w){const O=F(g,1);O.udf||(O.udf=new Map),this._addUDF(g,q,w,O.udf)},r.exports.sqlite3_create_window_function&&(F.addWindowFunc=function(g,q,w){const O=F(g,1);O.wudf||(O.wudf=new Map),this._addUDF(g,q,w,O.wudf)}),F.cleanup=function(g){g=j(g);for(const O of[["sqlite3_busy_handler",3],["sqlite3_commit_hook",3],["sqlite3_preupdate_hook",3],["sqlite3_progress_handler",4],["sqlite3_rollback_hook",3],["sqlite3_set_authorizer",3],["sqlite3_trace_v2",4],["sqlite3_update_hook",3]]){const[E,A]=O;if(!r.exports[E])continue;const f=[g];f.length=A;try{i[E](...f)}catch(p){t.config.warn("close-time call of",E+"(",f,") threw:",p)}}const q=F(g,0);if(!q)return;if(q.collation){for(const O of q.collation)try{i.sqlite3_create_collation_v2(g,O,i.SQLITE_UTF8,0,0,0)}catch{}delete q.collation}let w;for(w=0;w<2;++w){const O=w?q.wudf:q.udf;if(!O)continue;const E=w?i.sqlite3_create_window_function:i.sqlite3_create_function_v2;for(const A of O){const N=A[0],f=A[1],p=[g,N,0,i.SQLITE_UTF8,0,0,0,0,0];w&&p.push(0);for(const y of f)try{p[2]=y,E.apply(null,p)}catch{}f.clear()}O.clear()}delete q.udf,delete q.wudf};{const g=r.xWrap("sqlite3_close_v2","int","sqlite3*");i.sqlite3_close_v2=function(q){if(arguments.length!==1)return P(q,"sqlite3_close_v2",1);if(q)try{F.cleanup(q)}catch{}return g(q)}}if(i.sqlite3session_create){const g=r.xWrap("sqlite3session_delete",void 0,["sqlite3_session*"]);i.sqlite3session_delete=function(q){if(arguments.length!==1)return P(pDb,"sqlite3session_delete",1);q&&i.sqlite3session_table_filter(q,0,0),g(q)}}{const g=(w,O)=>"argv["+O+"]:"+w[0]+":"+r.cstrToJs(w[1]).toLowerCase(),q=r.xWrap("sqlite3_create_collation_v2","int",["sqlite3*","string","int","*",new r.xWrap.FuncPtrAdapter({name:"xCompare",signature:"i(pipip)",contextKey:g}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",signature:"v(p)",contextKey:g})]);i.sqlite3_create_collation_v2=function(w,O,E,A,N,f){if(arguments.length!==6)return P(w,"sqlite3_create_collation_v2",6);if((E&15)===0)E|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(E&15))return J(w);try{const p=q(w,O,E,A,N,f);return p===0&&N instanceof Function&&F.addCollation(w,O),p}catch(p){return u.sqlite3__wasm_db_error(w,p)}},i.sqlite3_create_collation=(w,O,E,A,N)=>arguments.length===5?i.sqlite3_create_collation_v2(w,O,E,A,N,0):P(w,"sqlite3_create_collation",5)}{const g=function(E,A){return E[0]+":"+(E[2]<0?-1:E[2])+":"+A+":"+r.cstrToJs(E[1]).toLowerCase()},q=Object.assign(Object.create(null),{xInverseAndStep:{signature:"v(pip)",contextKey:g,callProxy:E=>(A,N,f)=>{try{E(A,...i.sqlite3_values_to_js(N,f))}catch(p){i.sqlite3_result_error_js(A,p)}}},xFinalAndValue:{signature:"v(p)",contextKey:g,callProxy:E=>A=>{try{i.sqlite3_result_js(A,E(A))}catch(N){i.sqlite3_result_error_js(A,N)}}},xFunc:{signature:"v(pip)",contextKey:g,callProxy:E=>(A,N,f)=>{try{i.sqlite3_result_js(A,E(A,...i.sqlite3_values_to_js(N,f)))}catch(p){i.sqlite3_result_error_js(A,p)}}},xDestroy:{signature:"v(p)",contextKey:g,callProxy:E=>A=>{try{E(A)}catch(N){console.error("UDF xDestroy method threw:",N)}}}}),w=r.xWrap("sqlite3_create_function_v2","int",["sqlite3*","string","int","int","*",new r.xWrap.FuncPtrAdapter({name:"xFunc",...q.xFunc}),new r.xWrap.FuncPtrAdapter({name:"xStep",...q.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xFinal",...q.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",...q.xDestroy})]),O=r.exports.sqlite3_create_window_function?r.xWrap("sqlite3_create_window_function","int",["sqlite3*","string","int","int","*",new r.xWrap.FuncPtrAdapter({name:"xStep",...q.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xFinal",...q.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xValue",...q.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xInverse",...q.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",...q.xDestroy})]):void 0;i.sqlite3_create_function_v2=function E(A,N,f,p,y,D,H,re,se){if(E.length!==arguments.length)return P(A,"sqlite3_create_function_v2",E.length);if((p&15)===0)p|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(p&15))return J(A);try{const h=w(A,N,f,p,y,D,H,re,se);return h===0&&(D instanceof Function||H instanceof Function||re instanceof Function||se instanceof Function)&&F.addFunction(A,N,f),h}catch(h){return console.error("sqlite3_create_function_v2() setup threw:",h),u.sqlite3__wasm_db_error(A,h,"Creation of UDF threw: "+h)}},i.sqlite3_create_function=function E(A,N,f,p,y,D,H,re){return E.length===arguments.length?i.sqlite3_create_function_v2(A,N,f,p,y,D,H,re,0):P(A,"sqlite3_create_function",E.length)},O?i.sqlite3_create_window_function=function E(A,N,f,p,y,D,H,re,se,h){if(E.length!==arguments.length)return P(A,"sqlite3_create_window_function",E.length);if((p&15)===0)p|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(p&15))return J(A);try{const o=O(A,N,f,p,y,D,H,re,se,h);return o===0&&(D instanceof Function||H instanceof Function||re instanceof Function||se instanceof Function||h instanceof Function)&&F.addWindowFunc(A,N,f),o}catch(o){return console.error("sqlite3_create_window_function() setup threw:",o),u.sqlite3__wasm_db_error(A,o,"Creation of UDF threw: "+o)}}:delete i.sqlite3_create_window_function,i.sqlite3_create_function_v2.udfSetResult=i.sqlite3_create_function.udfSetResult=i.sqlite3_result_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfSetResult=i.sqlite3_result_js),i.sqlite3_create_function_v2.udfConvertArgs=i.sqlite3_create_function.udfConvertArgs=i.sqlite3_values_to_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfConvertArgs=i.sqlite3_values_to_js),i.sqlite3_create_function_v2.udfSetError=i.sqlite3_create_function.udfSetError=i.sqlite3_result_error_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfSetError=i.sqlite3_result_error_js)}{const g=(w,O)=>(typeof w=="string"?O=-1:u.isSQLableTypedArray(w)?(O=w.byteLength,w=r.typedArrayToString(w instanceof ArrayBuffer?new Uint8Array(w):w)):Array.isArray(w)&&(w=w.join(""),O=-1),[w,O]),q={basic:r.xWrap("sqlite3_prepare_v3","int",["sqlite3*","string","int","int","**","**"]),full:r.xWrap("sqlite3_prepare_v3","int",["sqlite3*","*","int","int","**","**"])};i.sqlite3_prepare_v3=function w(O,E,A,N,f,p){if(w.length!==arguments.length)return P(O,"sqlite3_prepare_v3",w.length);const[y,D]=g(E,Number(A));switch(typeof y){case"string":return q.basic(O,y,D,N,f,null);case typeof r.ptr.null:return q.full(O,r.ptr.coerce(y),D,N,f,p);default:return u.sqlite3__wasm_db_error(O,i.SQLITE_MISUSE,"Invalid SQL argument type for sqlite3_prepare_v2/v3(). typeof="+typeof y)}},i.sqlite3_prepare_v2=function w(O,E,A,N,f){return w.length===arguments.length?i.sqlite3_prepare_v3(O,E,A,0,N,f):P(O,"sqlite3_prepare_v2",w.length)}}{const g=r.xWrap("sqlite3_bind_text","int",["sqlite3_stmt*","int","string","int","*"]),q=r.xWrap("sqlite3_bind_blob","int",["sqlite3_stmt*","int","*","int","*"]);i.sqlite3_bind_text=function w(O,E,A,N,f){if(w.length!==arguments.length)return P(i.sqlite3_db_handle(O),"sqlite3_bind_text",w.length);if(r.isPtr(A)||A===null)return g(O,E,A,N,f);A instanceof ArrayBuffer?A=new Uint8Array(A):Array.isArray(pMem)&&(A=pMem.join(""));let p,y;try{if(u.isSQLableTypedArray(A))p=r.allocFromTypedArray(A),y=A.byteLength;else if(typeof A=="string")[p,y]=r.allocCString(A);else return u.sqlite3__wasm_db_error(i.sqlite3_db_handle(O),i.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_text().");return g(O,E,p,y,i.SQLITE_WASM_DEALLOC)}catch(D){return r.dealloc(p),u.sqlite3__wasm_db_error(i.sqlite3_db_handle(O),D)}},i.sqlite3_bind_blob=function w(O,E,A,N,f){if(w.length!==arguments.length)return P(i.sqlite3_db_handle(O),"sqlite3_bind_blob",w.length);if(r.isPtr(A)||A===null)return q(O,E,A,N,f);A instanceof ArrayBuffer?A=new Uint8Array(A):Array.isArray(A)&&(A=A.join(""));let p,y;try{if(u.isBindableTypedArray(A))p=r.allocFromTypedArray(A),y=N>=0?N:A.byteLength;else if(typeof A=="string")[p,y]=r.allocCString(A);else return u.sqlite3__wasm_db_error(i.sqlite3_db_handle(O),i.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_blob().");return q(O,E,p,y,i.SQLITE_WASM_DEALLOC)}catch(D){return r.dealloc(p),u.sqlite3__wasm_db_error(i.sqlite3_db_handle(O),D)}}}i.sqlite3_config=function(g,...q){if(arguments.length<2)return i.SQLITE_MISUSE;switch(g){case i.SQLITE_CONFIG_COVERING_INDEX_SCAN:case i.SQLITE_CONFIG_MEMSTATUS:case i.SQLITE_CONFIG_SMALL_MALLOC:case i.SQLITE_CONFIG_SORTERREF_SIZE:case i.SQLITE_CONFIG_STMTJRNL_SPILL:case i.SQLITE_CONFIG_URI:return r.exports.sqlite3__wasm_config_i(g,q[0]);case i.SQLITE_CONFIG_LOOKASIDE:return r.exports.sqlite3__wasm_config_ii(g,q[0],q[1]);case i.SQLITE_CONFIG_MEMDB_MAXSIZE:return r.exports.sqlite3__wasm_config_j(g,q[0]);case i.SQLITE_CONFIG_GETMALLOC:case i.SQLITE_CONFIG_GETMUTEX:case i.SQLITE_CONFIG_GETPCACHE2:case i.SQLITE_CONFIG_GETPCACHE:case i.SQLITE_CONFIG_HEAP:case i.SQLITE_CONFIG_LOG:case i.SQLITE_CONFIG_MALLOC:case i.SQLITE_CONFIG_MMAP_SIZE:case i.SQLITE_CONFIG_MULTITHREAD:case i.SQLITE_CONFIG_MUTEX:case i.SQLITE_CONFIG_PAGECACHE:case i.SQLITE_CONFIG_PCACHE2:case i.SQLITE_CONFIG_PCACHE:case i.SQLITE_CONFIG_PCACHE_HDRSZ:case i.SQLITE_CONFIG_PMASZ:case i.SQLITE_CONFIG_SERIALIZED:case i.SQLITE_CONFIG_SINGLETHREAD:case i.SQLITE_CONFIG_SQLLOG:case i.SQLITE_CONFIG_WIN32_HEAPSIZE:default:return i.SQLITE_NOTFOUND}};{const g=new Set;i.sqlite3_auto_extension=function(q){if(q instanceof Function)q=r.installFunction("i(ppp)",q);else if(arguments.length!==1||!r.isPtr(q))return i.SQLITE_MISUSE;const w=r.exports.sqlite3_auto_extension(q);return q!==arguments[0]&&(w===0?g.add(q):r.uninstallFunction(q)),w},i.sqlite3_cancel_auto_extension=function(q){return!q||arguments.length!==1||!r.isPtr(q)?0:r.exports.sqlite3_cancel_auto_extension(q)},i.sqlite3_reset_auto_extension=function(){r.exports.sqlite3_reset_auto_extension();for(const q of g)r.uninstallFunction(q);g.clear()}}const x=i.sqlite3_vfs_find("kvvfs");if(x)if(u.isUIThread()){const g=new i.sqlite3_kvvfs_methods(r.exports.sqlite3__wasm_kvvfs_methods());delete i.sqlite3_kvvfs_methods;const q=r.exports.sqlite3__wasm_kvvfsMakeKeyOnPstack,w=r.pstack,O=A=>r.peek(A)===115?sessionStorage:localStorage,E={xRead:(A,N,f,p)=>{const y=w.pointer,D=r.scopedAllocPush();try{const H=q(A,N);if(!H)return-3;const re=r.cstrToJs(H),se=O(A).getItem(re);if(!se)return-1;const h=se.length;if(p<=0)return h;if(p===1)return r.poke(f,0),h;const o=r.scopedAllocCString(se);return p>h+1&&(p=h+1),r.heap8u().copyWithin(Number(f),Number(o),r.ptr.addn(o,p,-1)),r.poke(r.ptr.add(f,p,-1),0),p-1}catch(H){return t.config.error("kvstorageRead()",H),-2}finally{w.restore(y),r.scopedAllocPop(D)}},xWrite:(A,N,f)=>{const p=w.pointer;try{const y=q(A,N);if(!y)return 1;const D=r.cstrToJs(y);return O(A).setItem(D,r.cstrToJs(f)),0}catch(y){return t.config.error("kvstorageWrite()",y),i.SQLITE_IOERR}finally{w.restore(p)}},xDelete:(A,N)=>{const f=w.pointer;try{const p=q(A,N);return p?(O(A).removeItem(r.cstrToJs(p)),0):1}catch(p){return t.config.error("kvstorageDelete()",p),i.SQLITE_IOERR}finally{w.restore(f)}}};for(const A of Object.keys(E))g[g.memberKey(A)]=r.installFunction(g.memberSignature(A),E[A])}else i.sqlite3_vfs_unregister(x);r.xWrap.FuncPtrAdapter.warnOnUse=!0;const L=t.StructBinder,K=function g(q,w,O,E=g.installMethodArgcCheck){if(q instanceof L.StructType?!(O instanceof Function)&&!r.isPtr(O)&&c("Usage error: expecting a Function or WASM pointer to one."):c("Usage error: target object is-not-a StructType."),arguments.length===1)return(p,y)=>g(q,p,y,E);g.argcProxy||(g.argcProxy=function(p,y,D,H){return function(...re){return D.length!==arguments.length&&c("Argument mismatch for",p.structInfo.name+"::"+y+": Native signature is:",H),D.apply(this,re)}},g.removeFuncList=function(){this.ondispose.__removeFuncList&&(this.ondispose.__removeFuncList.forEach((p,y)=>{if(r.isPtr(p))try{r.uninstallFunction(p)}catch{}}),delete this.ondispose.__removeFuncList)});const A=q.memberSignature(w);A.length<2&&c("Member",w,"does not have a function pointer signature:",A);const N=q.memberKey(w),f=E&&!r.isPtr(O)?g.argcProxy(q,N,O,A):O;if(r.isPtr(f))f&&!r.functionEntry(f)&&c("Pointer",f,"is not a WASM function table entry."),q[N]=f;else{const p=r.installFunction(f,q.memberSignature(w));q[N]=p,(!q.ondispose||!q.ondispose.__removeFuncList)&&(q.addOnDispose("ondispose.__removeFuncList handler",g.removeFuncList),q.ondispose.__removeFuncList=[]),q.ondispose.__removeFuncList.push(N,p)}return(p,y)=>g(q,p,y,E)};K.installMethodArgcCheck=!1;const U=function(g,q,w=K.installMethodArgcCheck){const O=new Map;for(const E of Object.keys(q)){const A=q[E],N=O.get(A);if(N){const f=g.memberKey(E);g[f]=g[g.memberKey(N)]}else K(g,E,A,w),O.set(A,E)}return g};L.StructType.prototype.installMethod=function(q,w,O=K.installMethodArgcCheck){return arguments.length<3&&q&&typeof q=="object"?U(this,...arguments):K(this,...arguments)},L.StructType.prototype.installMethods=function(g,q=K.installMethodArgcCheck){return U(this,g,q)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(t){t.version={libVersion:"3.51.0",libVersionNumber:3051e3,sourceId:"2025-11-04 19:38:17 fb2c931ae597f8d00a37574ff67aeed3eced4e5547f9120744ae4bfa8e74527b",downloadVersion:351e4,scm:{"sha3-256":"fb2c931ae597f8d00a37574ff67aeed3eced4e5547f9120744ae4bfa8e74527b",branch:"trunk",tags:"release major-release version-3.51.0",datetime:"2025-11-04T19:38:17.314Z"}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(t){const c=(...h)=>{throw new t.SQLite3Error(...h)},i=t.capi,r=t.wasm,u=t.util,T=new WeakMap,P=new Set,J=new WeakMap,j=(h,o,l)=>{const d=Object.getOwnPropertyDescriptor(h,o);return d?d.value:l},I=function(h,o){return o&&(h instanceof K&&(h=h.pointer),c(o,"sqlite3 result code",o+":",h?i.sqlite3_errmsg(h):i.sqlite3_errstr(o))),arguments[0]},F=r.installFunction("i(ippp)",(function(h,o,l,d){i.SQLITE_TRACE_STMT===h&&console.log("SQL TRACE #"+ ++this.counter+" via sqlite3@"+o+":",r.cstrToJs(d))}).bind({counter:0})),x=Object.create(null),L=function h(...o){if(!h._name2vfs){h._name2vfs=Object.create(null);const m=typeof importScripts=="function"?M=>c("The VFS for",M,"is only available in the main window thread."):!1;h._name2vfs[":localStorage:"]={vfs:"kvvfs",filename:m||(()=>"local")},h._name2vfs[":sessionStorage:"]={vfs:"kvvfs",filename:m||(()=>"session")}}const l=h.normalizeArgs(...o);let d;if(d=l["sqlite3*"])l["sqlite3*:takeOwnership"]||P.add(this),this.filename=i.sqlite3_db_filename(d,"main");else{let m=l.filename,M=l.vfs,Q=l.flags;(typeof m!="string"&&!r.isPtr(m)||typeof Q!="string"||M&&typeof M!="string"&&!r.isPtr(M))&&(t.config.error("Invalid DB ctor args",l,arguments),c("Invalid arguments for DB constructor:",arguments,"opts:",l));let ne=r.isPtr(m)?r.cstrToJs(m):m;const G=h._name2vfs[ne];G&&(M=G.vfs,m=ne=G.filename(ne));let ce=0;Q.indexOf("c")>=0&&(ce|=i.SQLITE_OPEN_CREATE|i.SQLITE_OPEN_READWRITE),Q.indexOf("w")>=0&&(ce|=i.SQLITE_OPEN_READWRITE),ce===0&&(ce|=i.SQLITE_OPEN_READONLY),ce|=i.SQLITE_OPEN_EXRESCODE;const oe=r.pstack.pointer;try{const me=r.pstack.allocPtr();let pe=i.sqlite3_open_v2(m,me,ce,M||r.ptr.null);d=r.peekPtr(me),I(d,pe),i.sqlite3_extended_result_codes(d,1),Q.indexOf("t")>=0&&i.sqlite3_trace_v2(d,i.SQLITE_TRACE_STMT,F,d)}catch(me){throw d&&i.sqlite3_close_v2(d),me}finally{r.pstack.restore(oe)}this.filename=ne}if(T.set(this,d),J.set(this,Object.create(null)),!l["sqlite3*"])try{const m=i.sqlite3_js_db_vfs(d)||c("Internal error: cannot get VFS for new db handle."),M=x[m];M&&(M instanceof Function?M(this,t):I(d,i.sqlite3_exec(d,M,0,0,0)))}catch(m){throw this.close(),m}};L.setVfsPostOpenCallback=function(h,o){o instanceof Function||c("dbCtorHelper.setVfsPostOpenCallback() should not be used with a non-function argument.",arguments),x[h]=o},L.normalizeArgs=function(h=":memory:",o="c",l=null){const d={};return arguments.length===1&&arguments[0]&&typeof arguments[0]=="object"?(Object.assign(d,arguments[0]),d.flags===void 0&&(d.flags="c"),d.vfs===void 0&&(d.vfs=null),d.filename===void 0&&(d.filename=":memory:")):(d.filename=h,d.flags=o,d.vfs=l),d};const K=function(...h){L.apply(this,h)};K.dbCtorHelper=L;const U={null:1,number:2,string:3,boolean:4,blob:5};r.bigIntEnabled&&(U.bigint=U.number);const g=function(){U!==arguments[2]&&c(i.SQLITE_MISUSE,"Do not call the Stmt constructor directly. Use DB.prepare()."),this.db=arguments[0],T.set(this,arguments[1]),arguments.length>3&&!arguments[3]&&P.add(this)},q=function(h){return h.pointer||c("DB has been closed."),h},w=function(h,o){return(o!==(o|0)||o<0||o>=h.columnCount)&&c("Column index",o,"is out of range."),h},O=function(h,o){const l=Object.create(null);switch(l.opt=Object.create(null),o.length){case 1:typeof o[0]=="string"||u.isSQLableTypedArray(o[0])||Array.isArray(o[0])?l.sql=o[0]:o[0]&&typeof o[0]=="object"&&(l.opt=o[0],l.sql=l.opt.sql);break;case 2:l.sql=o[0],l.opt=o[1];break;default:c("Invalid argument count for exec().")}l.sql=u.flexibleString(l.sql),typeof l.sql!="string"&&c("Missing SQL argument or unsupported SQL value type.");const d=l.opt;switch(d.returnValue){case"resultRows":d.resultRows||(d.resultRows=[]),l.returnVal=()=>d.resultRows;break;case"saveSql":d.saveSql||(d.saveSql=[]),l.returnVal=()=>d.saveSql;break;case void 0:case"this":l.returnVal=()=>h;break;default:c("Invalid returnValue value:",d.returnValue)}if(!d.callback&&!d.returnValue&&d.rowMode!==void 0&&(d.resultRows||(d.resultRows=[]),l.returnVal=()=>d.resultRows),d.callback||d.resultRows)switch(d.rowMode===void 0?"array":d.rowMode){case"object":l.cbArg=(m,M)=>{M.columnNames||(M.columnNames=m.getColumnNames([]));const Q=m.get([]),ne=Object.create(null);for(const G in M.columnNames)ne[M.columnNames[G]]=Q[G];return ne};break;case"array":l.cbArg=m=>m.get([]);break;case"stmt":Array.isArray(d.resultRows)&&c("exec(): invalid rowMode for a resultRows array: must","be one of 'array', 'object',","a result column number, or column name reference."),l.cbArg=m=>m;break;default:if(u.isInt32(d.rowMode)){l.cbArg=m=>m.get(d.rowMode);break}else if(typeof d.rowMode=="string"&&d.rowMode.length>1&&d.rowMode[0]==="$"){const m=d.rowMode.substr(1);l.cbArg=M=>{const Q=M.get(Object.create(null))[m];return Q===void 0?c(i.SQLITE_NOTFOUND,"exec(): unknown result column:",m):Q};break}c("Invalid rowMode:",d.rowMode)}return l},E=(h,o,l,...d)=>{const m=h.prepare(o);try{const M=m.bind(l).step()?m.get(...d):void 0;return m.reset(),M}finally{m.finalize()}},A=(h,o,l,d)=>h.exec({sql:o,bind:l,rowMode:d,returnValue:"resultRows"});K.checkRc=(h,o)=>I(h,o),K.prototype={isOpen:function(){return!!this.pointer},affirmOpen:function(){return q(this)},close:function(){const h=this.pointer;if(h){if(this.onclose&&this.onclose.before instanceof Function)try{this.onclose.before(this)}catch{}if(Object.keys(J.get(this)).forEach((o,l)=>{if(l&&l.pointer)try{l.finalize()}catch{}}),T.delete(this),J.delete(this),P.delete(this)||i.sqlite3_close_v2(h),this.onclose&&this.onclose.after instanceof Function)try{this.onclose.after(this)}catch{}delete this.filename}},changes:function(h=!1,o=!1){const l=q(this).pointer;return h?o?i.sqlite3_total_changes64(l):i.sqlite3_total_changes(l):o?i.sqlite3_changes64(l):i.sqlite3_changes(l)},dbFilename:function(h="main"){return i.sqlite3_db_filename(q(this).pointer,h)},dbName:function(h=0){return i.sqlite3_db_name(q(this).pointer,h)},dbVfsName:function(h=0){let o;const l=i.sqlite3_js_db_vfs(q(this).pointer,h);if(l){const d=new i.sqlite3_vfs(l);try{o=r.cstrToJs(d.$zName)}finally{d.dispose()}}return o},prepare:function(h){q(this);const o=r.pstack.pointer;let l,d;try{l=r.pstack.alloc(8),K.checkRc(this,i.sqlite3_prepare_v2(this.pointer,h,-1,l,null)),d=r.peekPtr(l)}finally{r.pstack.restore(o)}d||c("Cannot prepare empty SQL.");const m=new g(this,d,U);return J.get(this)[d]=m,m},exec:function(){q(this);const h=O(this,arguments);if(!h.sql)return c("exec() requires an SQL string.");const o=h.opt,l=o.callback,d=Array.isArray(o.resultRows)?o.resultRows:void 0;let m,M=o.bind,Q=!!(h.cbArg||o.columnNames||d);const ne=r.scopedAllocPush(),G=Array.isArray(o.saveSql)?o.saveSql:void 0;try{const ce=u.isSQLableTypedArray(h.sql);let oe=ce?h.sql.byteLength:r.jstrlen(h.sql);const me=r.scopedAlloc(2*r.ptr.size+(oe+1)),pe=r.ptr.add(me,r.ptr.size);let ye=r.ptr.add(pe,r.ptr.size);const Ne=r.ptr.add(ye,oe);for(ce?r.heap8().set(h.sql,ye):r.jstrcpy(h.sql,r.heap8(),ye,oe,!1),r.poke(r.ptr.add(ye,oe),0);ye&&r.peek(ye,"i8");){r.pokePtr([me,pe],0),K.checkRc(this,i.sqlite3_prepare_v3(this.pointer,ye,oe,0,me,pe));const S=r.peekPtr(me);if(ye=r.peekPtr(pe),oe=Number(r.ptr.add(Ne,-ye)),!!S){if(G&&G.push(i.sqlite3_sql(S).trim()),m=new g(this,S,U),M&&m.parameterCount&&(m.bind(M),M=null),Q&&m.columnCount){let B=Array.isArray(o.columnNames)?0:1;if(Q=!1,h.cbArg||d){const W=Object.create(null);for(;m.step();D.delete(m)){B++===0&&m.getColumnNames(W.columnNames=o.columnNames||[]),D.add(m);const Z=h.cbArg(m,W);if(d&&d.push(Z),l&&l.call(o,Z,m)===!1)break}D.delete(m)}B===0&&m.getColumnNames(o.columnNames)}else m.step();m.reset().finalize(),m=null}}}finally{r.scopedAllocPop(ne),m&&(D.delete(m),m.finalize())}return h.returnVal()},createFunction:function(o,l,d){const m=W=>W instanceof Function;switch(arguments.length){case 1:d=o,o=d.name,l=d.xFunc||0;break;case 2:m(l)||(d=l,l=d.xFunc||0);break}d||(d={}),typeof o!="string"&&c("Invalid arguments: missing function name.");let M=d.xStep||0,Q=d.xFinal||0;const ne=d.xValue||0,G=d.xInverse||0;let ce;m(l)?(ce=!1,(m(M)||m(Q))&&c("Ambiguous arguments: scalar or aggregate?"),M=Q=null):m(M)?(m(Q)||c("Missing xFinal() callback for aggregate or window UDF."),l=null):m(Q)?c("Missing xStep() callback for aggregate or window UDF."):c("Missing function-type properties."),ce===!1?(m(ne)||m(G))&&c("xValue and xInverse are not permitted for non-window UDFs."):m(ne)?(m(G)||c("xInverse must be provided if xValue is."),ce=!0):m(G)&&c("xValue must be provided if xInverse is.");const oe=d.pApp;oe!=null&&!r.isPtr(oe)&&c("Invalid value for pApp property. Must be a legal WASM pointer value.");const me=d.xDestroy||0;me&&!m(me)&&c("xDestroy property must be a function.");let pe=0;j(d,"deterministic")&&(pe|=i.SQLITE_DETERMINISTIC),j(d,"directOnly")&&(pe|=i.SQLITE_DIRECTONLY),j(d,"innocuous")&&(pe|=i.SQLITE_INNOCUOUS),o=o.toLowerCase();const ye=l||M,Ne=j(d,"arity"),S=typeof Ne=="number"?Ne:ye.length?ye.length-1:0;let B;return ce?B=i.sqlite3_create_window_function(this.pointer,o,S,i.SQLITE_UTF8|pe,oe||0,M,Q,ne,G,me):B=i.sqlite3_create_function_v2(this.pointer,o,S,i.SQLITE_UTF8|pe,oe||0,l,M,Q,me),K.checkRc(this,B),this},selectValue:function(h,o,l){return E(this,h,o,0,l)},selectValues:function(h,o,l){const d=this.prepare(h),m=[];try{for(d.bind(o);d.step();)m.push(d.get(0,l));d.reset()}finally{d.finalize()}return m},selectArray:function(h,o){return E(this,h,o,[])},selectObject:function(h,o){return E(this,h,o,{})},selectArrays:function(h,o){return A(this,h,o,"array")},selectObjects:function(h,o){return A(this,h,o,"object")},openStatementCount:function(){return this.pointer?Object.keys(J.get(this)).length:0},transaction:function(h){let o="BEGIN";arguments.length>1&&(/[^a-zA-Z]/.test(arguments[0])&&c(i.SQLITE_MISUSE,"Invalid argument for BEGIN qualifier."),o+=" "+arguments[0],h=arguments[1]),q(this).exec(o);try{const l=h(this);return this.exec("COMMIT"),l}catch(l){throw this.exec("ROLLBACK"),l}},savepoint:function(h){q(this).exec("SAVEPOINT oo1");try{const o=h(this);return this.exec("RELEASE oo1"),o}catch(o){throw this.exec("ROLLBACK to SAVEPOINT oo1; RELEASE SAVEPOINT oo1"),o}},checkRc:function(h){return I(this,h)}},K.wrapHandle=function(h,o=!1){if(!h||!r.isPtr(h))throw new t.SQLite3Error(i.SQLITE_MISUSE,"Argument must be a WASM sqlite3 pointer");return new K({"sqlite3*":h,"sqlite3*:takeOwnership":!!o})};const N=function(h){return h.pointer||c("Stmt has been closed."),h},f=function(h){let o=U[h==null?"null":typeof h];switch(o){case U.boolean:case U.null:case U.number:case U.string:return o;case U.bigint:return r.bigIntEnabled?o:void 0;default:return u.isBindableTypedArray(h)?U.blob:void 0}},p=function(h){return f(h)||c("Unsupported bind() argument type:",typeof h)},y=function(h,o){const l=typeof o=="number"?o:i.sqlite3_bind_parameter_index(h.pointer,o);return l===0||!u.isInt32(l)?c("Invalid bind() parameter name: "+o):(l<1||l>h.parameterCount)&&c("Bind index",o,"is out of range."),l},D=new Set,H=new Set,re=function(h,o){return D.has(h)&&c("Operation is illegal when statement is locked:",o),h},se=function h(o,l,d,m){re(N(o),"bind()"),h._||(h._tooBigInt=Q=>c("BigInt value is too big to store without precision loss:",Q),h._={string:function(Q,ne,G,ce){const[oe,me]=r.allocCString(G,!0);return(ce?i.sqlite3_bind_blob:i.sqlite3_bind_text)(Q.pointer,ne,oe,me,i.SQLITE_WASM_DEALLOC)}}),p(m),l=y(o,l);let M=0;switch(m==null?U.null:d){case U.null:M=i.sqlite3_bind_null(o.pointer,l);break;case U.string:M=h._.string(o,l,m,!1);break;case U.number:{let Q;u.isInt32(m)?Q=i.sqlite3_bind_int:typeof m=="bigint"?u.bigIntFits64(m)?r.bigIntEnabled?Q=i.sqlite3_bind_int64:u.bigIntFitsDouble(m)?(m=Number(m),Q=i.sqlite3_bind_double):h._tooBigInt(m):h._tooBigInt(m):(m=Number(m),r.bigIntEnabled&&Number.isInteger(m)?Q=i.sqlite3_bind_int64:Q=i.sqlite3_bind_double),M=Q(o.pointer,l,m);break}case U.boolean:M=i.sqlite3_bind_int(o.pointer,l,m?1:0);break;case U.blob:{if(typeof m=="string"){M=h._.string(o,l,m,!0);break}else m instanceof ArrayBuffer?m=new Uint8Array(m):u.isBindableTypedArray(m)||c("Binding a value as a blob requires","that it be a string, Uint8Array, Int8Array, or ArrayBuffer.");const Q=r.alloc(m.byteLength||1);r.heap8().set(m.byteLength?m:[0],Number(Q)),M=i.sqlite3_bind_blob(o.pointer,l,Q,m.byteLength,i.SQLITE_WASM_DEALLOC);break}default:t.config.warn("Unsupported bind() argument type:",m),c("Unsupported bind() argument type: "+typeof m)}return M&&K.checkRc(o.db.pointer,M),o};g.prototype={finalize:function(){const h=this.pointer;if(h){re(this,"finalize()");const o=P.delete(this)?0:i.sqlite3_finalize(h);return delete J.get(this.db)[h],T.delete(this),D.delete(this),H.delete(this),delete this.parameterCount,delete this.db,o}},clearBindings:function(){return re(N(this),"clearBindings()"),i.sqlite3_clear_bindings(this.pointer),H.delete(this),this},reset:function(h){re(this,"reset()"),h&&this.clearBindings();const o=i.sqlite3_reset(N(this).pointer);return H.delete(this),I(this.db,o),this},bind:function(){N(this);let h,o;switch(arguments.length){case 1:h=1,o=arguments[0];break;case 2:h=arguments[0],o=arguments[1];break;default:c("Invalid bind() arguments.")}return o===void 0?this:(this.parameterCount||c("This statement has no bindable parameters."),H.delete(this),o===null?se(this,h,U.null,o):Array.isArray(o)?(arguments.length!==1&&c("When binding an array, an index argument is not permitted."),o.forEach((l,d)=>se(this,d+1,p(l),l)),this):(o instanceof ArrayBuffer&&(o=new Uint8Array(o)),typeof o=="object"&&!u.isBindableTypedArray(o)?(arguments.length!==1&&c("When binding an object, an index argument is not permitted."),Object.keys(o).forEach(l=>se(this,l,p(o[l]),o[l])),this):se(this,h,p(o),o)))},bindAsBlob:function(h,o){N(this),arguments.length===1&&(o=h,h=1);const l=p(o);return U.string!==l&&U.blob!==l&&U.null!==l&&c("Invalid value type for bindAsBlob()"),se(this,h,U.blob,o)},step:function(){re(this,"step()");const h=i.sqlite3_step(N(this).pointer);switch(h){case i.SQLITE_DONE:return H.delete(this),!1;case i.SQLITE_ROW:return H.add(this),!0;default:H.delete(this),t.config.warn("sqlite3_step() rc=",h,i.sqlite3_js_rc_str(h),"SQL =",i.sqlite3_sql(this.pointer)),K.checkRc(this.db.pointer,h)}},stepReset:function(){return this.step(),this.reset()},stepFinalize:function(){try{const h=this.step();return this.reset(),h}finally{try{this.finalize()}catch{}}},get:function(h,o){if(H.has(N(this))||c("Stmt.step() has not (recently) returned true."),Array.isArray(h)){let l=0;const d=this.columnCount;for(;l<d;)h[l]=this.get(l++);return h}else if(h&&typeof h=="object"){let l=0;const d=this.columnCount;for(;l<d;)h[i.sqlite3_column_name(this.pointer,l)]=this.get(l++);return h}switch(w(this,h),o===void 0?i.sqlite3_column_type(this.pointer,h):o){case i.SQLITE_NULL:return null;case i.SQLITE_INTEGER:if(r.bigIntEnabled){const l=i.sqlite3_column_int64(this.pointer,h);return l>=Number.MIN_SAFE_INTEGER&&l<=Number.MAX_SAFE_INTEGER?Number(l).valueOf():l}else{const l=i.sqlite3_column_double(this.pointer,h);return(l>Number.MAX_SAFE_INTEGER||l<Number.MIN_SAFE_INTEGER)&&c("Integer is out of range for JS integer range: "+l),u.isInt32(l)?l|0:l}case i.SQLITE_FLOAT:return i.sqlite3_column_double(this.pointer,h);case i.SQLITE_TEXT:return i.sqlite3_column_text(this.pointer,h);case i.SQLITE_BLOB:{const l=i.sqlite3_column_bytes(this.pointer,h),d=i.sqlite3_column_blob(this.pointer,h),m=new Uint8Array(l);return l&&(m.set(r.heap8u().slice(Number(d),Number(d)+l),0),this.db._blobXfer instanceof Array&&this.db._blobXfer.push(m.buffer)),m}default:c("Don't know how to translate","type of result column #"+h+".")}c("Not reached.")},getInt:function(h){return this.get(h,i.SQLITE_INTEGER)},getFloat:function(h){return this.get(h,i.SQLITE_FLOAT)},getString:function(h){return this.get(h,i.SQLITE_TEXT)},getBlob:function(h){return this.get(h,i.SQLITE_BLOB)},getJSON:function(h){const o=this.get(h,i.SQLITE_STRING);return o===null?o:JSON.parse(o)},getColumnName:function(h){return i.sqlite3_column_name(w(N(this),h).pointer,h)},getColumnNames:function(h=[]){w(N(this),0);const o=this.columnCount;for(let l=0;l<o;++l)h.push(i.sqlite3_column_name(this.pointer,l));return h},getParamIndex:function(h){return N(this).parameterCount?i.sqlite3_bind_parameter_index(this.pointer,h):void 0},getParamName:function(h){return N(this).parameterCount?i.sqlite3_bind_parameter_name(this.pointer,h):void 0},isBusy:function(){return i.sqlite3_stmt_busy(N(this))!==0},isReadOnly:function(){return i.sqlite3_stmt_readonly(N(this))!==0}};{const h={enumerable:!0,get:function(){return T.get(this)},set:()=>c("The pointer property is read-only.")};Object.defineProperty(g.prototype,"pointer",h),Object.defineProperty(K.prototype,"pointer",h)}if(Object.defineProperty(g.prototype,"columnCount",{enumerable:!1,get:function(){return i.sqlite3_column_count(this.pointer)},set:()=>c("The columnCount property is read-only.")}),Object.defineProperty(g.prototype,"parameterCount",{enumerable:!1,get:function(){return i.sqlite3_bind_parameter_count(this.pointer)},set:()=>c("The parameterCount property is read-only.")}),g.wrapHandle=function(h,o,l=!1){if(!(h instanceof K)||!h.pointer)throw new t.SQLite3Error(t.SQLITE_MISUSE,"First argument must be an opened sqlite3.oo1.DB instance");if(!o||!r.isPtr(o))throw new t.SQLite3Error(t.SQLITE_MISUSE,"Second argument must be a WASM sqlite3_stmt pointer");return new g(h,o,U,!!l)},t.oo1={DB:K,Stmt:g},u.isUIThread()){t.oo1.JsStorageDb=function(o="session"){const l=L.normalizeArgs(...arguments);o=l.filename,o!=="session"&&o!=="local"&&c("JsStorageDb db name must be one of 'session' or 'local'."),l.vfs="kvvfs",L.call(this,l)};const h=t.oo1.JsStorageDb;h.prototype=Object.create(K.prototype),h.clearStorage=i.sqlite3_js_kvvfs_clear,h.prototype.clearStorage=function(){return h.clearStorage(q(this).filename)},h.storageSize=i.sqlite3_js_kvvfs_size,h.prototype.storageSize=function(){return h.storageSize(q(this).filename)}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(t){const c=t.util;t.initWorker1API=(function(){const i=(...x)=>{throw new Error(x.join(" "))};globalThis.WorkerGlobalScope instanceof Function||i("initWorker1API() must be run from a Worker thread.");const r=this.sqlite3||i("Missing this.sqlite3 object."),u=r.oo1.DB,T=function(x){let L=P.idMap.get(x);return L||(L="db#"+ ++P.idSeq+":"+Math.floor(Math.random()*1e8)+":"+Math.floor(Math.random()*1e8),P.idMap.set(x,L),L)},P={dbList:[],idSeq:0,idMap:new WeakMap,xfer:[],open:function(x){const L=new u(x);return this.dbs[T(L)]=L,this.dbList.indexOf(L)<0&&this.dbList.push(L),L},close:function(x,L){if(x){delete this.dbs[T(x)];const K=x.filename,U=c.sqlite3__wasm_db_vfs(x.pointer,0);x.close();const g=this.dbList.indexOf(x);g>=0&&this.dbList.splice(g,1),L&&K&&U&&c.sqlite3__wasm_vfs_unlink(U,K)}},post:function(x,L){L&&L.length?(globalThis.postMessage(x,Array.from(L)),L.length=0):globalThis.postMessage(x)},dbs:Object.create(null),getDb:function(x,L=!0){return this.dbs[x]||(L?i("Unknown (or closed) DB ID:",x):void 0)}},J=function(x=P.dbList[0]){return x&&x.pointer?x:i("DB is not opened.")},j=function(x,L=!0){const K=P.getDb(x.dbId,!1)||P.dbList[0];return L?J(K):K},I=function(){return P.dbList[0]&&T(P.dbList[0])},F={open:function(x){const L=Object.create(null),K=x.args||Object.create(null);K.simulateError&&i("Throwing because of simulateError flag.");const U=Object.create(null);L.vfs=K.vfs,L.filename=K.filename||"";const g=P.open(L);return U.filename=g.filename,U.persistent=!!r.capi.sqlite3_js_db_uses_vfs(g.pointer,"opfs"),U.dbId=T(g),U.vfs=g.dbVfsName(),U},close:function(x){const L=j(x,!1),K={filename:L&&L.filename};if(L){const U=x.args&&typeof x.args=="object"?!!x.args.unlink:!1;P.close(L,U)}return K},exec:function(x){const L=typeof x.args=="string"?{sql:x.args}:x.args||Object.create(null);L.rowMode==="stmt"?i("Invalid rowMode for 'exec': stmt mode","does not work in the Worker API."):L.sql||i("'exec' requires input SQL.");const K=j(x);(L.callback||Array.isArray(L.resultRows))&&(K._blobXfer=P.xfer);const U=L.callback;let g=0;const q=!!L.columnNames;typeof U=="string"&&(q||(L.columnNames=[]),L.callback=function(w,O){P.post({type:U,columnNames:L.columnNames,rowNumber:++g,row:w},P.xfer)});try{const w=L.countChanges?K.changes(!0,L.countChanges===64):void 0;K.exec(L),w!==void 0&&(L.changeCount=K.changes(!0,L.countChanges===64)-w);const O=L.lastInsertRowId?r.capi.sqlite3_last_insert_rowid(K):void 0;O!==void 0&&(L.lastInsertRowId=O),L.callback instanceof Function&&(L.callback=U,P.post({type:U,columnNames:L.columnNames,rowNumber:null,row:void 0}))}finally{delete K._blobXfer,L.callback&&(L.callback=U)}return L},"config-get":function(){const x=Object.create(null),L=r.config;return["bigIntEnabled"].forEach(function(K){Object.getOwnPropertyDescriptor(L,K)&&(x[K]=L[K])}),x.version=r.version,x.vfsList=r.capi.sqlite3_js_vfs_list(),x},export:function(x){const L=j(x),K={byteArray:r.capi.sqlite3_js_db_export(L.pointer),filename:L.filename,mimetype:"application/x-sqlite3"};return P.xfer.push(K.byteArray.buffer),K},toss:function(x){i("Testing worker exception")}};globalThis.onmessage=async function(x){x=x.data;let L,K=x.dbId,U=x.type;const g=performance.now();try{F.hasOwnProperty(U)&&F[U]instanceof Function?L=await F[U](x):i("Unknown db worker message type:",x.type)}catch(q){U="error",L={operation:x.type,message:q.message,errorClass:q.name,input:x},q.stack&&(L.stack=typeof q.stack=="string"?q.stack.split(/\n\s*/):q.stack)}K||(K=L.dbId||I()),P.post({type:U,dbId:K,messageId:x.messageId,workerReceivedTime:g,workerRespondTime:performance.now(),departureTime:x.departureTime,result:L},P.xfer)},globalThis.postMessage({type:"sqlite3-api",result:"worker1-ready"})}).bind({sqlite3:t})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(t){const c=t.wasm,i=t.capi,r=t.util.toss3,u=Object.create(null);t.vfs=u,i.sqlite3_vfs.prototype.registerVfs=function(T=!1){this instanceof t.capi.sqlite3_vfs||r("Expecting a sqlite3_vfs-type argument.");const P=i.sqlite3_vfs_register(this,T?1:0);return P&&r("sqlite3_vfs_register(",this,") failed with rc",P),this.pointer!==i.sqlite3_vfs_find(this.$zName)&&r("BUG: sqlite3_vfs_find(vfs.$zName) failed for just-installed VFS",this),this},u.installVfs=function(T){let P=0;const J=["io","vfs"];for(const j of J){const I=T[j];I&&(++P,I.struct.installMethods(I.methods,!!I.applyArgcCheck),j==="vfs"&&(!I.struct.$zName&&typeof I.name=="string"&&I.struct.addOnDispose(I.struct.$zName=c.allocCString(I.name)),I.struct.registerVfs(!!I.asDefault)))}return P||r("Misuse: installVfs() options object requires at least","one of:",J),this}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(t){if(!t.wasm.exports.sqlite3_declare_vtab)return;const c=t.wasm,i=t.capi,r=t.util.toss3,u=Object.create(null);t.vtab=u;const T=i.sqlite3_index_info;T.prototype.nthConstraint=function(j,I=!1){if(j<0||j>=this.$nConstraint)return!1;const F=c.ptr.add(this.$aConstraint,T.sqlite3_index_constraint.structInfo.sizeof*j);return I?F:new T.sqlite3_index_constraint(F)},T.prototype.nthConstraintUsage=function(j,I=!1){if(j<0||j>=this.$nConstraint)return!1;const F=c.ptr.add(this.$aConstraintUsage,T.sqlite3_index_constraint_usage.structInfo.sizeof*j);return I?F:new T.sqlite3_index_constraint_usage(F)},T.prototype.nthOrderBy=function(j,I=!1){if(j<0||j>=this.$nOrderBy)return!1;const F=c.ptr.add(this.$aOrderBy,T.sqlite3_index_orderby.structInfo.sizeof*j);return I?F:new T.sqlite3_index_orderby(F)};const P=function(j,I){return(function(F,x=!1){if(arguments.length===0&&(F=new I),F instanceof I)return this.set(F.pointer,F),F;c.isPtr(F)||t.SQLite3Error.toss("Invalid argument to",j+"()");let L=this.get(F);return x&&this.delete(F),L}).bind(new Map)},J=function(j,I){const F=P(j,I);return Object.assign(Object.create(null),{StructType:I,create:x=>{const L=F();return c.pokePtr(x,L.pointer),L},get:x=>F(x),unget:x=>F(x,!0),dispose:x=>{const L=F(x,!0);L&&L.dispose()}})};u.xVtab=J("xVtab",i.sqlite3_vtab),u.xCursor=J("xCursor",i.sqlite3_vtab_cursor),u.xIndexInfo=j=>new i.sqlite3_index_info(j),u.xError=function j(I,F,x){if(j.errorReporter instanceof Function)try{j.errorReporter("sqlite3_module::"+I+"(): "+F.message)}catch{}let L;return F instanceof t.WasmAllocError?L=i.SQLITE_NOMEM:arguments.length>2?L=x:F instanceof t.SQLite3Error&&(L=F.resultCode),L||i.SQLITE_ERROR},u.xError.errorReporter=t.config.error.bind(t.config),u.xRowid=(j,I)=>c.poke(j,I,"i64"),u.setupModule=function(j){let I=!1;const F=this instanceof i.sqlite3_module?this:j.struct||(I=new i.sqlite3_module);try{const x=j.methods||r("Missing 'methods' object.");for(const L of Object.entries({xConnect:"xCreate",xDisconnect:"xDestroy"})){const K=L[0],U=L[1];x[K]===!0?x[K]=x[U]:x[U]===!0&&(x[U]=x[K])}if(j.catchExceptions){const L=function(g,q){return["xConnect","xCreate"].indexOf(g)>=0?function(w,O,E,A,N,f){try{return q(...arguments)||0}catch(p){return p instanceof t.WasmAllocError||(c.dealloc(c.peekPtr(f)),c.pokePtr(f,c.allocCString(p.message))),u.xError(g,p)}}:function(...w){try{return q(...w)||0}catch(O){return u.xError(g,O)}}},K=["xCreate","xConnect","xBestIndex","xDisconnect","xDestroy","xOpen","xClose","xFilter","xNext","xEof","xColumn","xRowid","xUpdate","xBegin","xSync","xCommit","xRollback","xFindFunction","xRename","xSavepoint","xRelease","xRollbackTo","xShadowName"],U=Object.create(null);for(const g of K){const q=x[g];if(q instanceof Function)g==="xConnect"&&x.xCreate===q?U[g]=x.xCreate:g==="xCreate"&&x.xConnect===q?U[g]=x.xConnect:U[g]=L(g,q);else continue}F.installMethods(U,!1)}else F.installMethods(x,!!j.applyArgcCheck);if(F.$iVersion===0){let L;typeof j.iVersion=="number"?L=j.iVersion:F.$xIntegrity?L=4:F.$xShadowName?L=3:F.$xSavePoint||F.$xRelease||F.$xRollbackTo?L=2:L=1,F.$iVersion=L}}catch(x){throw I&&I.dispose(),x}return F},i.sqlite3_module.prototype.setupModule=function(j){return u.setupModule.call(this,j)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(t){const c=function i(r){var P;if(!globalThis.SharedArrayBuffer||!globalThis.Atomics)return Promise.reject(new Error("Cannot install OPFS: Missing SharedArrayBuffer and/or Atomics. The server must emit the COOP/COEP response headers to enable those. See https://sqlite.org/wasm/doc/trunk/persistence.md#coop-coep"));if(typeof WorkerGlobalScope>"u")return Promise.reject(new Error("The OPFS sqlite3_vfs cannot run in the main thread because it requires Atomics.wait()."));if(!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!((P=navigator==null?void 0:navigator.storage)!=null&&P.getDirectory))return Promise.reject(new Error("Missing required OPFS APIs."));(!r||typeof r!="object")&&(r=Object.create(null));const u=new URL(globalThis.location.href).searchParams;return u.has("opfs-disable")?Promise.resolve(t):(r.verbose===void 0&&(r.verbose=u.has("opfs-verbose")?+u.get("opfs-verbose")||2:1),r.sanityChecks===void 0&&(r.sanityChecks=u.has("opfs-sanity-check")),r.proxyUri===void 0&&(r.proxyUri=i.defaultProxyUri),typeof r.proxyUri=="function"&&(r.proxyUri=r.proxyUri()),new Promise(function(J,j){const I=[t.config.error,t.config.warn,t.config.log],F=(S,...B)=>{r.verbose>S&&I[S]("OPFS syncer:",...B)},x=(...S)=>F(2,...S),L=(...S)=>F(1,...S),K=(...S)=>F(0,...S),U=t.util.toss,g=t.capi,q=t.util,w=t.wasm,O=g.sqlite3_vfs,E=g.sqlite3_file,A=g.sqlite3_io_methods,N=Object.create(null),f=()=>{var S;return globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&((S=navigator==null?void 0:navigator.storage)==null?void 0:S.getDirectory)};N.metrics={dump:function(){let S,B=0,W=0,Z=0;for(S in l.opIds){const X=d[S];B+=X.count,W+=X.time,Z+=X.wait,X.avgTime=X.count&&X.time?X.time/X.count:0,X.avgWait=X.count&&X.wait?X.wait/X.count:0}t.config.log(globalThis.location.href,"metrics for",globalThis.location.href,":",d,`
Total of`,B,"op(s) for",W,"ms (incl. "+Z+" ms of waiting on the async side)"),t.config.log("Serialization metrics:",d.s11n),se.postMessage({type:"opfs-async-metrics"})},reset:function(){let S;const B=Z=>Z.count=Z.time=Z.wait=0;for(S in l.opIds)B(d[S]=Object.create(null));let W=d.s11n=Object.create(null);W=W.serialize=Object.create(null),W.count=W.time=0,W=d.s11n.deserialize=Object.create(null),W.count=W.time=0}};const p=new A,y=new O().addOnDispose(()=>p.dispose());let D;const H=S=>(D=!0,y.dispose(),j(S)),re=()=>(D=!1,J(t)),se=new Worker(new URL(r.proxyUri,self.location.href));setTimeout(()=>{D===void 0&&H(new Error("Timeout while waiting for OPFS async proxy worker."))},4e3),se._originalOnError=se.onerror,se.onerror=function(S){K("Error initializing OPFS asyncer:",S),H(new Error("Loading OPFS async Worker failed for unknown reasons."))};const h=g.sqlite3_vfs_find(null),o=h?new O(h):null;p.$iVersion=1,y.$iVersion=2,y.$szOsFile=g.sqlite3_file.structInfo.sizeof,y.$mxPathname=1024,y.$zName=w.allocCString("opfs"),y.$xDlOpen=y.$xDlError=y.$xDlSym=y.$xDlClose=null,y.addOnDispose("$zName",y.$zName,"cleanup default VFS wrapper",()=>o?o.dispose():null);const l=Object.create(null);l.verbose=r.verbose,l.littleEndian=(()=>{const S=new ArrayBuffer(2);return new DataView(S).setInt16(0,256,!0),new Int16Array(S)[0]===256})(),l.asyncIdleWaitTime=150,l.asyncS11nExceptions=1,l.fileBufferSize=1024*64,l.sabS11nOffset=l.fileBufferSize,l.sabS11nSize=y.$mxPathname*2,l.sabIO=new SharedArrayBuffer(l.fileBufferSize+l.sabS11nSize),l.opIds=Object.create(null);const d=Object.create(null);{let S=0;l.opIds.whichOp=S++,l.opIds.rc=S++,l.opIds.xAccess=S++,l.opIds.xClose=S++,l.opIds.xDelete=S++,l.opIds.xDeleteNoWait=S++,l.opIds.xFileSize=S++,l.opIds.xLock=S++,l.opIds.xOpen=S++,l.opIds.xRead=S++,l.opIds.xSleep=S++,l.opIds.xSync=S++,l.opIds.xTruncate=S++,l.opIds.xUnlock=S++,l.opIds.xWrite=S++,l.opIds.mkdir=S++,l.opIds["opfs-async-metrics"]=S++,l.opIds["opfs-async-shutdown"]=S++,l.opIds.retry=S++,l.sabOP=new SharedArrayBuffer(S*4),N.metrics.reset()}l.sq3Codes=Object.create(null),["SQLITE_ACCESS_EXISTS","SQLITE_ACCESS_READWRITE","SQLITE_BUSY","SQLITE_CANTOPEN","SQLITE_ERROR","SQLITE_IOERR","SQLITE_IOERR_ACCESS","SQLITE_IOERR_CLOSE","SQLITE_IOERR_DELETE","SQLITE_IOERR_FSYNC","SQLITE_IOERR_LOCK","SQLITE_IOERR_READ","SQLITE_IOERR_SHORT_READ","SQLITE_IOERR_TRUNCATE","SQLITE_IOERR_UNLOCK","SQLITE_IOERR_WRITE","SQLITE_LOCK_EXCLUSIVE","SQLITE_LOCK_NONE","SQLITE_LOCK_PENDING","SQLITE_LOCK_RESERVED","SQLITE_LOCK_SHARED","SQLITE_LOCKED","SQLITE_MISUSE","SQLITE_NOTFOUND","SQLITE_OPEN_CREATE","SQLITE_OPEN_DELETEONCLOSE","SQLITE_OPEN_MAIN_DB","SQLITE_OPEN_READONLY"].forEach(S=>{(l.sq3Codes[S]=g[S])===void 0&&U("Maintenance required: not found:",S)}),l.opfsFlags=Object.assign(Object.create(null),{OPFS_UNLOCK_ASAP:1,OPFS_UNLINK_BEFORE_OPEN:2,defaultUnlockAsap:!1});const m=(S,...B)=>{const W=l.opIds[S]||U("Invalid op ID:",S);l.s11n.serialize(...B),Atomics.store(l.sabOPView,l.opIds.rc,-1),Atomics.store(l.sabOPView,l.opIds.whichOp,W),Atomics.notify(l.sabOPView,l.opIds.whichOp);const Z=performance.now();for(;Atomics.wait(l.sabOPView,l.opIds.rc,-1)!=="not-equal";);const X=Atomics.load(l.sabOPView,l.opIds.rc);if(d[S].wait+=performance.now()-Z,X&&l.asyncS11nExceptions){const ue=l.s11n.deserialize();ue&&K(S+"() async error:",...ue)}return X};N.debug={asyncShutdown:()=>{L("Shutting down OPFS async listener. The OPFS VFS will no longer work."),m("opfs-async-shutdown")},asyncRestart:()=>{L("Attempting to restart OPFS VFS async listener. Might work, might not."),se.postMessage({type:"opfs-async-restart"})}};const M=()=>{if(l.s11n)return l.s11n;const S=new TextDecoder,B=new TextEncoder("utf-8"),W=new Uint8Array(l.sabIO,l.sabS11nOffset,l.sabS11nSize),Z=new DataView(l.sabIO,l.sabS11nOffset,l.sabS11nSize);l.s11n=Object.create(null);const X=Object.create(null);X.number={id:1,size:8,getter:"getFloat64",setter:"setFloat64"},X.bigint={id:2,size:8,getter:"getBigInt64",setter:"setBigInt64"},X.boolean={id:3,size:4,getter:"getInt32",setter:"setInt32"},X.string={id:4};const ue=R=>X[typeof R]||U("Maintenance required: this value type cannot be serialized.",R),le=R=>{switch(R){case X.number.id:return X.number;case X.bigint.id:return X.bigint;case X.boolean.id:return X.boolean;case X.string.id:return X.string;default:U("Invalid type ID:",R)}};return l.s11n.deserialize=function(R=!1){++d.s11n.deserialize.count;const b=performance.now(),C=W[0],z=C?[]:null;if(C){const V=[];let Y=1,fe,be,k;for(fe=0;fe<C;++fe,++Y)V.push(le(W[Y]));for(fe=0;fe<C;++fe){const $=V[fe];$.getter?(k=Z[$.getter](Y,l.littleEndian),Y+=$.size):(be=Z.getInt32(Y,l.littleEndian),Y+=4,k=S.decode(W.slice(Y,Y+be)),Y+=be),z.push(k)}}return R&&(W[0]=0),d.s11n.deserialize.time+=performance.now()-b,z},l.s11n.serialize=function(...R){const b=performance.now();if(++d.s11n.serialize.count,R.length){const C=[];let z=0,V=1;for(W[0]=R.length&255;z<R.length;++z,++V)C.push(ue(R[z])),W[V]=C[z].id;for(z=0;z<R.length;++z){const Y=C[z];if(Y.setter)Z[Y.setter](V,R[z],l.littleEndian),V+=Y.size;else{const fe=B.encode(R[z]);Z.setInt32(V,fe.byteLength,l.littleEndian),V+=4,W.set(fe,V),V+=fe.byteLength}}}else W[0]=0;d.s11n.serialize.time+=performance.now()-b},l.s11n},Q=function S(B=16){S._chars||(S._chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012346789",S._n=S._chars.length);const W=[];let Z=0;for(;Z<B;++Z){const X=Math.random()*(S._n*64)%S._n|0;W[Z]=S._chars[X]}return W.join("")},ne=Object.create(null),G=Object.create(null);G.op=void 0,G.start=void 0;const ce=S=>{G.start=performance.now(),G.op=S,++d[S].count},oe=()=>d[G.op].time+=performance.now()-G.start,me={xCheckReservedLock:function(S,B){return w.poke(B,0,"i32"),0},xClose:function(S){ce("xClose");let B=0;const W=ne[S];return W&&(delete ne[S],B=m("xClose",S),W.sq3File&&W.sq3File.dispose()),oe(),B},xDeviceCharacteristics:function(S){return g.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(S,B,W){return g.SQLITE_NOTFOUND},xFileSize:function(S,B){ce("xFileSize");let W=m("xFileSize",S);if(W==0)try{const Z=l.s11n.deserialize()[0];w.poke(B,Z,"i64")}catch(Z){K("Unexpected error reading xFileSize() result:",Z),W=l.sq3Codes.SQLITE_IOERR}return oe(),W},xLock:function(S,B){ce("xLock");const W=ne[S];let Z=0;return W.lockType?W.lockType=B:(Z=m("xLock",S,B),Z===0&&(W.lockType=B)),oe(),Z},xRead:function(S,B,W,Z){ce("xRead");const X=ne[S];let ue;try{ue=m("xRead",S,W,Number(Z)),(ue===0||g.SQLITE_IOERR_SHORT_READ===ue)&&w.heap8u().set(X.sabView.subarray(0,W),Number(B))}catch(le){K("xRead(",arguments,") failed:",le,X),ue=g.SQLITE_IOERR_READ}return oe(),ue},xSync:function(S,B){ce("xSync"),++d.xSync.count;const W=m("xSync",S,B);return oe(),W},xTruncate:function(S,B){ce("xTruncate");const W=m("xTruncate",S,Number(B));return oe(),W},xUnlock:function(S,B){ce("xUnlock");const W=ne[S];let Z=0;return g.SQLITE_LOCK_NONE===B&&W.lockType&&(Z=m("xUnlock",S,B)),Z===0&&(W.lockType=B),oe(),Z},xWrite:function(S,B,W,Z){ce("xWrite");const X=ne[S];let ue;try{X.sabView.set(w.heap8u().subarray(Number(B),Number(B)+W)),ue=m("xWrite",S,W,Number(Z))}catch(le){K("xWrite(",arguments,") failed:",le,X),ue=g.SQLITE_IOERR_WRITE}return oe(),ue}},pe={xAccess:function(S,B,W,Z){ce("xAccess");const X=m("xAccess",w.cstrToJs(B));return w.poke(Z,X?0:1,"i32"),oe(),0},xCurrentTime:function(S,B){return w.poke(B,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(S,B){return w.poke(B,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(S,B,W){ce("xDelete");const Z=m("xDelete",w.cstrToJs(B),W,!1);return oe(),Z},xFullPathname:function(S,B,W,Z){return w.cstrncpy(Z,B,W)<W?0:g.SQLITE_CANTOPEN},xGetLastError:function(S,B,W){return L("OPFS xGetLastError() has nothing sensible to return."),0},xOpen:function(B,W,Z,X,ue){ce("xOpen");let le=0;W===0?W=Q():w.isPtr(W)&&(g.sqlite3_uri_boolean(W,"opfs-unlock-asap",0)&&(le|=l.opfsFlags.OPFS_UNLOCK_ASAP),g.sqlite3_uri_boolean(W,"delete-before-open",0)&&(le|=l.opfsFlags.OPFS_UNLINK_BEFORE_OPEN),W=w.cstrToJs(W));const R=Object.create(null);R.fid=Z,R.filename=W,R.sab=new SharedArrayBuffer(l.fileBufferSize),R.flags=X,R.readOnly=!(t.SQLITE_OPEN_CREATE&X)&&!!(X&g.SQLITE_OPEN_READONLY);const b=m("xOpen",Z,W,X,le);return b||(R.readOnly&&w.poke(ue,g.SQLITE_OPEN_READONLY,"i32"),ne[Z]=R,R.sabView=l.sabFileBufView,R.sq3File=new E(Z),R.sq3File.$pMethods=p.pointer,R.lockType=g.SQLITE_LOCK_NONE),oe(),b}};o&&(y.$xRandomness=o.$xRandomness,y.$xSleep=o.$xSleep),y.$xRandomness||(pe.xRandomness=function(S,B,W){const Z=w.heap8u();let X=0;const ue=Number(W);for(;X<B;++X)Z[ue+X]=Math.random()*255e3&255;return X}),y.$xSleep||(pe.xSleep=function(S,B){return Atomics.wait(l.sabOPView,l.opIds.xSleep,0,B),0}),N.getResolvedPath=function(S,B){const W=new URL(S,"file://irrelevant").pathname;return B?W.split("/").filter(Z=>!!Z):W},N.getDirForFilename=async function(B,W=!1){const Z=N.getResolvedPath(B,!0),X=Z.pop();let ue=N.rootDirectory;for(const le of Z)le&&(ue=await ue.getDirectoryHandle(le,{create:!!W}));return[ue,X]},N.mkdir=async function(S){try{return await N.getDirForFilename(S+"/filepart",!0),!0}catch{return!1}},N.entryExists=async function(S){try{const[B,W]=await N.getDirForFilename(S);return await B.getFileHandle(W),!0}catch{return!1}},N.randomFilename=Q,N.treeList=async function(){const S=async function W(Z,X){X.name=Z.name,X.dirs=[],X.files=[];for await(const ue of Z.values())if(ue.kind==="directory"){const le=Object.create(null);X.dirs.push(le),await W(ue,le)}else X.files.push(ue.name)},B=Object.create(null);return await S(N.rootDirectory,B),B},N.rmfr=async function(){const S=N.rootDirectory,B={recurse:!0};for await(const W of S.values())S.removeEntry(W.name,B)},N.unlink=async function(S,B=!1,W=!1){try{const[Z,X]=await N.getDirForFilename(S,!1);return await Z.removeEntry(X,{recursive:B}),!0}catch(Z){if(W)throw new Error("unlink(",arguments[0],") failed: "+Z.message,{cause:Z});return!1}},N.traverse=async function(S){const B={recursive:!0,directory:N.rootDirectory};typeof S=="function"&&(S={callback:S}),S=Object.assign(B,S||{}),async function Z(X,ue){for await(const le of X.values()){if(S.callback(le,X,ue)===!1)return!1;if(S.recursive&&le.kind==="directory"&&await Z(le,ue+1)===!1)break}}(S.directory,0)};const ye=async function(S,B){const[W,Z]=await N.getDirForFilename(S,!0);let ue=await(await W.getFileHandle(Z,{create:!0})).createSyncAccessHandle(),le=0,R,b=!1;try{for(ue.truncate(0);(R=await B())!==void 0;)R instanceof ArrayBuffer&&(R=new Uint8Array(R)),!b&&le===0&&R.byteLength>=15&&(q.affirmDbHeader(R),b=!0),ue.write(R,{at:le}),le+=R.byteLength;if((le<512||le%512!==0)&&U("Input size",le,"is not correct for an SQLite database."),!b){const C=new Uint8Array(20);ue.read(C,{at:0}),q.affirmDbHeader(C)}return ue.write(new Uint8Array([1,1]),{at:18}),le}catch(C){throw await ue.close(),ue=void 0,await W.removeEntry(Z).catch(()=>{}),C}finally{ue&&await ue.close()}};if(N.importDb=async function(S,B){if(B instanceof Function)return ye(S,B);B instanceof ArrayBuffer&&(B=new Uint8Array(B)),q.affirmIsDb(B);const W=B.byteLength,[Z,X]=await N.getDirForFilename(S,!0);let ue,le=0;try{return ue=await(await Z.getFileHandle(X,{create:!0})).createSyncAccessHandle(),ue.truncate(0),le=ue.write(B,{at:0}),le!=W&&U("Expected to write "+W+" bytes but wrote "+le+"."),ue.write(new Uint8Array([1,1]),{at:18}),le}catch(R){throw ue&&(await ue.close(),ue=void 0),await Z.removeEntry(X).catch(()=>{}),R}finally{ue&&await ue.close()}},t.oo1){const S=function(...B){const W=t.oo1.DB.dbCtorHelper.normalizeArgs(...B);W.vfs=y.$zName,t.oo1.DB.dbCtorHelper.call(this,W)};S.prototype=Object.create(t.oo1.DB.prototype),t.oo1.OpfsDb=S,S.importDb=N.importDb,t.oo1.DB.dbCtorHelper.setVfsPostOpenCallback(y.pointer,function(B,W){W.capi.sqlite3_busy_timeout(B,1e4)})}const Ne=function(){const S=w.scopedAllocPush(),B=new E;try{const W=B.pointer,Z=g.SQLITE_OPEN_CREATE|g.SQLITE_OPEN_READWRITE|g.SQLITE_OPEN_MAIN_DB,X=w.scopedAlloc(8),ue="/sanity/check/file"+Q(8),le=w.scopedAllocCString(ue);let R;if(l.s11n.serialize("This is  string."),R=l.s11n.deserialize(),x("deserialize() says:",R),R[0]!=="This is  string."&&U("String d13n error."),pe.xAccess(y.pointer,le,0,X),R=w.peek(X,"i32"),x("xAccess(",ue,") exists ?=",R),R=pe.xOpen(y.pointer,le,W,Z,X),x("open rc =",R,"state.sabOPView[xOpen] =",l.sabOPView[l.opIds.xOpen]),R!==0){K("open failed with code",R);return}pe.xAccess(y.pointer,le,0,X),R=w.peek(X,"i32"),R||U("xAccess() failed to detect file."),R=me.xSync(B.pointer,0),R&&U("sync failed w/ rc",R),R=me.xTruncate(B.pointer,1024),R&&U("truncate failed w/ rc",R),w.poke(X,0,"i64"),R=me.xFileSize(B.pointer,X),R&&U("xFileSize failed w/ rc",R),x("xFileSize says:",w.peek(X,"i64")),R=me.xWrite(B.pointer,le,10,1),R&&U("xWrite() failed!");const b=w.scopedAlloc(16);R=me.xRead(B.pointer,b,6,2),w.poke(b+6,0);let C=w.cstrToJs(b);x("xRead() got:",C),C!=="sanity"&&U("Unexpected xRead() value."),pe.xSleep&&(x("xSleep()ing before close()ing..."),pe.xSleep(y.pointer,2e3),x("waking up from xSleep()")),R=me.xClose(W),x("xClose rc =",R,"sabOPView =",l.sabOPView),x("Deleting file:",ue),pe.xDelete(y.pointer,le,4660),pe.xAccess(y.pointer,le,0,X),R=w.peek(X,"i32"),R&&U("Expecting 0 from xAccess(",ue,") after xDelete()."),L("End of OPFS sanity checks.")}finally{B.dispose(),w.scopedAllocPop(S)}};se.onmessage=function({data:S}){switch(S.type){case"opfs-unavailable":H(new Error(S.payload.join(" ")));break;case"opfs-async-loaded":se.postMessage({type:"opfs-async-init",args:l});break;case"opfs-async-inited":{if(D===!0)break;try{t.vfs.installVfs({io:{struct:p,methods:me},vfs:{struct:y,methods:pe}}),l.sabOPView=new Int32Array(l.sabOP),l.sabFileBufView=new Uint8Array(l.sabIO,0,l.fileBufferSize),l.sabS11nView=new Uint8Array(l.sabIO,l.sabS11nOffset,l.sabS11nSize),M(),r.sanityChecks&&(L("Running sanity checks because of opfs-sanity-check URL arg..."),Ne()),f()?navigator.storage.getDirectory().then(B=>{se.onerror=se._originalOnError,delete se._originalOnError,t.opfs=N,N.rootDirectory=B,x("End of OPFS sqlite3_vfs setup.",y),re()}).catch(H):re()}catch(B){K(B),H(B)}break}default:{const B="Unexpected message from the OPFS async worker: "+JSON.stringify(S);K(B),H(new Error(B));break}}}}))};c.defaultProxyUri="sqlite3-opfs-async-proxy.js",globalThis.sqlite3ApiBootstrap.initializersAsync.push(async i=>{try{let r=c.defaultProxyUri;return i.scriptInfo.sqlite3Dir&&(c.defaultProxyUri=i.scriptInfo.sqlite3Dir+r),c().catch(u=>{i.config.warn("Ignoring inability to install OPFS sqlite3_vfs:",u.message)})}catch(r){return i.config.error("installOpfsVfs() exception:",r),Promise.reject(r)}})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(t){var G,ce,oe,me,pe,ye,Ne,S,B,W,Z,X,mt,le;const c=t.util.toss,i=t.util.toss3,r=Object.create(null),u=t.capi,T=t.util,P=t.wasm,J=4096,j=512,I=4,F=8,x=j+I,L=j,K=x,U=J,g=u.SQLITE_OPEN_MAIN_DB|u.SQLITE_OPEN_MAIN_JOURNAL|u.SQLITE_OPEN_SUPER_JOURNAL|u.SQLITE_OPEN_WAL,q=u.SQLITE_OPEN_MEMORY,w=".opaque",O=()=>Math.random().toString(36).slice(2),E=new TextDecoder,A=new TextEncoder,N=Object.assign(Object.create(null),{name:"opfs-sahpool",directory:void 0,initialCapacity:6,clearOnInit:!1,verbosity:2,forceReinitIfPreviouslyFailed:!1}),f=[t.config.error,t.config.warn,t.config.log];t.config.log;const p=t.config.warn;t.config.error;const y=new Map,D=R=>y.get(R),H=(R,b)=>{b?y.set(R,b):y.delete(R)},re=new Map,se=R=>re.get(R),h=(R,b)=>{b?re.set(R,b):re.delete(R)},o={xCheckReservedLock:function(R,b){const C=se(R);return C.log("xCheckReservedLock"),C.storeErr(),P.poke32(b,1),0},xClose:function(R){const b=se(R);b.storeErr();const C=b.getOFileForS3File(R);if(C)try{b.log(`xClose ${C.path}`),b.mapS3FileToOFile(R,!1),C.sah.flush(),C.flags&u.SQLITE_OPEN_DELETEONCLOSE&&b.deletePath(C.path)}catch(z){return b.storeErr(z,u.SQLITE_IOERR)}return 0},xDeviceCharacteristics:function(R){return u.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(R,b,C){return u.SQLITE_NOTFOUND},xFileSize:function(R,b){const C=se(R);C.log("xFileSize");const V=C.getOFileForS3File(R).sah.getSize()-U;return P.poke64(b,BigInt(V)),0},xLock:function(R,b){const C=se(R);C.log(`xLock ${b}`),C.storeErr();const z=C.getOFileForS3File(R);return z.lockType=b,0},xRead:function(R,b,C,z){const V=se(R);V.storeErr();const Y=V.getOFileForS3File(R);V.log(`xRead ${Y.path} ${C} @ ${z}`);try{const fe=Y.sah.read(P.heap8u().subarray(Number(b),Number(b)+C),{at:U+Number(z)});return fe<C?(P.heap8u().fill(0,Number(b)+fe,Number(b)+C),u.SQLITE_IOERR_SHORT_READ):0}catch(fe){return V.storeErr(fe,u.SQLITE_IOERR)}},xSectorSize:function(R){return J},xSync:function(R,b){const C=se(R);C.log(`xSync ${b}`),C.storeErr();const z=C.getOFileForS3File(R);try{return z.sah.flush(),0}catch(V){return C.storeErr(V,u.SQLITE_IOERR)}},xTruncate:function(R,b){const C=se(R);C.log(`xTruncate ${b}`),C.storeErr();const z=C.getOFileForS3File(R);try{return z.sah.truncate(U+Number(b)),0}catch(V){return C.storeErr(V,u.SQLITE_IOERR)}},xUnlock:function(R,b){const C=se(R);C.log("xUnlock");const z=C.getOFileForS3File(R);return z.lockType=b,0},xWrite:function(R,b,C,z){const V=se(R);V.storeErr();const Y=V.getOFileForS3File(R);V.log(`xWrite ${Y.path} ${C} ${z}`);try{const fe=Y.sah.write(P.heap8u().subarray(Number(b),Number(b)+C),{at:U+Number(z)});return C===fe?0:c("Unknown write() failure.")}catch(fe){return V.storeErr(fe,u.SQLITE_IOERR)}}},l=new u.sqlite3_io_methods;l.$iVersion=1,t.vfs.installVfs({io:{struct:l,methods:o}});const d={xAccess:function(R,b,C,z){const V=D(R);V.storeErr();try{const Y=V.getPath(b);P.poke32(z,V.hasFilename(Y)?1:0)}catch{P.poke32(z,0)}return 0},xCurrentTime:function(R,b){return P.poke(b,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(R,b){return P.poke(b,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(R,b,C){const z=D(R);z.log(`xDelete ${P.cstrToJs(b)}`),z.storeErr();try{return z.deletePath(z.getPath(b)),0}catch(V){return z.storeErr(V),u.SQLITE_IOERR_DELETE}},xFullPathname:function(R,b,C,z){return P.cstrncpy(z,b,C)<C?0:u.SQLITE_CANTOPEN},xGetLastError:function(R,b,C){const z=D(R),V=z.popErr();if(z.log(`xGetLastError ${b} e =`,V),V){const Y=P.scopedAllocPush();try{const[fe,be]=P.scopedAllocCString(V.message,!0);P.cstrncpy(C,fe,b),be>b&&P.poke8(C+b-1,0)}catch{return u.SQLITE_NOMEM}finally{P.scopedAllocPop(Y)}}return V?V.sqlite3Rc||u.SQLITE_IOERR:0},xOpen:function(b,C,z,V,Y){const fe=D(b);try{V&=~q,fe.log(`xOpen ${P.cstrToJs(C)} ${V}`);const be=C&&P.peek8(C)?fe.getPath(C):O();let k=fe.getSAHForPath(be);!k&&V&u.SQLITE_OPEN_CREATE&&(fe.getFileCount()<fe.getCapacity()?(k=fe.nextAvailableSAH(),fe.setAssociatedPath(k,be,V)):c("SAH pool is full. Cannot create file",be)),k||c("file not found:",be);const $={path:be,flags:V,sah:k};fe.mapS3FileToOFile(z,$),$.lockType=u.SQLITE_LOCK_NONE;const te=new u.sqlite3_file(z);return te.$pMethods=l.pointer,te.dispose(),P.poke32(Y,V),0}catch(be){return fe.storeErr(be),u.SQLITE_CANTOPEN}}},m=function(R){t.capi.sqlite3_vfs_find(R)&&i("VFS name is already registered:",R);const b=new u.sqlite3_vfs,C=u.sqlite3_vfs_find(null),z=C?new u.sqlite3_vfs(C):null;return b.$iVersion=2,b.$szOsFile=u.sqlite3_file.structInfo.sizeof,b.$mxPathname=j,b.addOnDispose(b.$zName=P.allocCString(R),()=>H(b.pointer,0)),z&&(b.$xRandomness=z.$xRandomness,b.$xSleep=z.$xSleep,z.dispose()),!b.$xRandomness&&!d.xRandomness&&(d.xRandomness=function(V,Y,fe){const be=P.heap8u();let k=0;const $=Number(fe);for(;k<Y;++k)be[$+k]=Math.random()*255e3&255;return k}),!b.$xSleep&&!d.xSleep&&(d.xSleep=(V,Y)=>0),t.vfs.installVfs({vfs:{struct:b,methods:d}}),b};class M{constructor(b=Object.create(null)){Ue(this,X);Qe(this,"vfsDir");Ue(this,G);Ue(this,ce);Ue(this,oe);Ue(this,me,new Map);Ue(this,pe,new Map);Ue(this,ye,new Set);Ue(this,Ne,new Map);Ue(this,S,new Uint8Array(x));Ue(this,B);Ue(this,W);Ue(this,Z);He(this,Z,b.verbosity??N.verbosity),this.vfsName=b.name||N.name,He(this,W,m(this.vfsName)),H(ee(this,W).pointer,this),this.vfsDir=b.directory||"."+this.vfsName,He(this,B,new DataView(ee(this,S).buffer,ee(this,S).byteOffset)),this.isReady=this.reset(!!(b.clearOnInit??N.clearOnInit)).then(()=>{if(this.$error)throw this.$error;return this.getCapacity()?Promise.resolve(void 0):this.addCapacity(b.initialCapacity||N.initialCapacity)})}log(...b){ht(this,X,mt).call(this,2,...b)}warn(...b){ht(this,X,mt).call(this,1,...b)}error(...b){ht(this,X,mt).call(this,0,...b)}getVfs(){return ee(this,W)}getCapacity(){return ee(this,me).size}getFileCount(){return ee(this,pe).size}getFileNames(){const b=[];for(const C of ee(this,pe).keys())b.push(C);return b}async addCapacity(b){for(let C=0;C<b;++C){const z=O(),Y=await(await ee(this,ce).getFileHandle(z,{create:!0})).createSyncAccessHandle();ee(this,me).set(Y,z),this.setAssociatedPath(Y,"",0)}return this.getCapacity()}async reduceCapacity(b){let C=0;for(const z of Array.from(ee(this,ye))){if(C===b||this.getFileCount()===this.getCapacity())break;const V=ee(this,me).get(z);z.close(),await ee(this,ce).removeEntry(V),ee(this,me).delete(z),ee(this,ye).delete(z),++C}return C}releaseAccessHandles(){for(const b of ee(this,me).keys())b.close();ee(this,me).clear(),ee(this,pe).clear(),ee(this,ye).clear()}async acquireAccessHandles(b=!1){const C=[];for await(const[z,V]of ee(this,ce))V.kind==="file"&&C.push([z,V]);return Promise.all(C.map(async([z,V])=>{try{const Y=await V.createSyncAccessHandle();if(ee(this,me).set(Y,z),b)Y.truncate(U),this.setAssociatedPath(Y,"",0);else{const fe=this.getAssociatedPath(Y);fe?ee(this,pe).set(fe,Y):ee(this,ye).add(Y)}}catch(Y){throw this.storeErr(Y),this.releaseAccessHandles(),Y}}))}getAssociatedPath(b){b.read(ee(this,S),{at:0});const C=ee(this,B).getUint32(L);if(ee(this,S)[0]&&(C&u.SQLITE_OPEN_DELETEONCLOSE||(C&g)===0))return p(`Removing file with unexpected flags ${C.toString(16)}`,ee(this,S)),this.setAssociatedPath(b,"",0),"";const z=new Uint32Array(F/4);b.read(z,{at:K});const V=this.computeDigest(ee(this,S),C);if(z.every((Y,fe)=>Y===V[fe])){const Y=ee(this,S).findIndex(fe=>fe===0);return Y===0&&b.truncate(U),Y?E.decode(ee(this,S).subarray(0,Y)):""}else return p("Disassociating file with bad digest."),this.setAssociatedPath(b,"",0),""}setAssociatedPath(b,C,z){const V=A.encodeInto(C,ee(this,S));j<=V.written+1&&c("Path too long:",C),C&&z&&(z|=q),ee(this,S).fill(0,V.written,j),ee(this,B).setUint32(L,z);const Y=this.computeDigest(ee(this,S),z);b.write(ee(this,S),{at:0}),b.write(Y,{at:K}),b.flush(),C?(ee(this,pe).set(C,b),ee(this,ye).delete(b)):(b.truncate(U),ee(this,ye).add(b))}computeDigest(b,C){if(C&q){let z=3735928559,V=1103547991;for(const Y of b)z=Math.imul(z^Y,2654435761),V=Math.imul(V^Y,104729);return new Uint32Array([z>>>0,V>>>0])}else return new Uint32Array([0,0])}async reset(b){await this.isReady;let C=await navigator.storage.getDirectory(),z;for(const V of this.vfsDir.split("/"))V&&(z=C,C=await C.getDirectoryHandle(V,{create:!0}));return He(this,G,C),He(this,oe,z),He(this,ce,await ee(this,G).getDirectoryHandle(w,{create:!0})),this.releaseAccessHandles(),this.acquireAccessHandles(b)}getPath(b){return P.isPtr(b)&&(b=P.cstrToJs(b)),(b instanceof URL?b:new URL(b,"file://localhost/")).pathname}deletePath(b){const C=ee(this,pe).get(b);return C&&(ee(this,pe).delete(b),this.setAssociatedPath(C,"",0)),!!C}storeErr(b,C){return b&&(b.sqlite3Rc=C||u.SQLITE_IOERR,this.error(b)),this.$error=b,C}popErr(){const b=this.$error;return this.$error=void 0,b}nextAvailableSAH(){const[b]=ee(this,ye).keys();return b}getOFileForS3File(b){return ee(this,Ne).get(b)}mapS3FileToOFile(b,C){C?(ee(this,Ne).set(b,C),h(b,this)):(ee(this,Ne).delete(b),h(b,!1))}hasFilename(b){return ee(this,pe).has(b)}getSAHForPath(b){return ee(this,pe).get(b)}async removeVfs(){if(!ee(this,W).pointer||!ee(this,ce))return!1;u.sqlite3_vfs_unregister(ee(this,W).pointer),ee(this,W).dispose(),delete r[this.vfsName];try{this.releaseAccessHandles(),await ee(this,G).removeEntry(w,{recursive:!0}),He(this,ce,void 0),await ee(this,oe).removeEntry(ee(this,G).name,{recursive:!0}),He(this,G,He(this,oe,void 0))}catch(b){t.config.error(this.vfsName,"removeVfs() failed with no recovery strategy:",b)}return!0}pauseVfs(){return ee(this,Ne).size>0&&t.SQLite3Error.toss(u.SQLITE_MISUSE,"Cannot pause VFS",this.vfsName,"because it has opened files."),ee(this,me).size>0&&(u.sqlite3_vfs_unregister(this.vfsName),this.releaseAccessHandles()),this}isPaused(){return ee(this,me).size===0}async unpauseVfs(){return ee(this,me).size===0?this.acquireAccessHandles(!1).then(()=>u.sqlite3_vfs_register(ee(this,W),0),this):this}exportFile(b){const C=ee(this,pe).get(b)||c("File not found:",b),z=C.getSize()-U,V=new Uint8Array(z>0?z:0);if(z>0){const Y=C.read(V,{at:U});Y!=z&&c("Expected to read "+z+" bytes but read "+Y+".")}return V}async importDbChunked(b,C){const z=ee(this,pe).get(b)||this.nextAvailableSAH()||c("No available handles to import to.");z.truncate(0);let V=0,Y,fe=!1;try{for(;(Y=await C())!==void 0;)Y instanceof ArrayBuffer&&(Y=new Uint8Array(Y)),!fe&&V===0&&Y.byteLength>=15&&(T.affirmDbHeader(Y),fe=!0),z.write(Y,{at:U+V}),V+=Y.byteLength;if((V<512||V%512!==0)&&c("Input size",V,"is not correct for an SQLite database."),!fe){const be=new Uint8Array(20);z.read(be,{at:0}),T.affirmDbHeader(be)}z.write(new Uint8Array([1,1]),{at:U+18})}catch(be){throw this.setAssociatedPath(z,"",0),be}return this.setAssociatedPath(z,b,u.SQLITE_OPEN_MAIN_DB),V}importDb(b,C){if(C instanceof ArrayBuffer)C=new Uint8Array(C);else if(C instanceof Function)return this.importDbChunked(b,C);const z=ee(this,pe).get(b)||this.nextAvailableSAH()||c("No available handles to import to."),V=C.byteLength;(V<512||V%512!=0)&&c("Byte array size is invalid for an SQLite db.");const Y="SQLite format 3";for(let be=0;be<Y.length;++be)Y.charCodeAt(be)!==C[be]&&c("Input does not contain an SQLite database header.");const fe=z.write(C,{at:U});return fe!=V?(this.setAssociatedPath(z,"",0),c("Expected to write "+V+" bytes but wrote "+fe+".")):(z.write(new Uint8Array([1,1]),{at:U+18}),this.setAssociatedPath(z,b,u.SQLITE_OPEN_MAIN_DB)),fe}}G=new WeakMap,ce=new WeakMap,oe=new WeakMap,me=new WeakMap,pe=new WeakMap,ye=new WeakMap,Ne=new WeakMap,S=new WeakMap,B=new WeakMap,W=new WeakMap,Z=new WeakMap,X=new WeakSet,mt=function(b,...C){ee(this,Z)>b&&f[b](this.vfsName+":",...C)};class Q{constructor(b){Ue(this,le);He(this,le,b),this.vfsName=b.vfsName}async addCapacity(b){return ee(this,le).addCapacity(b)}async reduceCapacity(b){return ee(this,le).reduceCapacity(b)}getCapacity(){return ee(this,le).getCapacity(ee(this,le))}getFileCount(){return ee(this,le).getFileCount()}getFileNames(){return ee(this,le).getFileNames()}async reserveMinimumCapacity(b){const C=ee(this,le).getCapacity();return C<b?ee(this,le).addCapacity(b-C):C}exportFile(b){return ee(this,le).exportFile(b)}importDb(b,C){return ee(this,le).importDb(b,C)}async wipeFiles(){return ee(this,le).reset(!0)}unlink(b){return ee(this,le).deletePath(b)}async removeVfs(){return ee(this,le).removeVfs()}pauseVfs(){return ee(this,le).pauseVfs(),this}async unpauseVfs(){return ee(this,le).unpauseVfs().then(()=>this)}isPaused(){return ee(this,le).isPaused()}}le=new WeakMap;const ne=async()=>{const R=await navigator.storage.getDirectory(),b=".opfs-sahpool-sync-check-"+O(),V=(await(await R.getFileHandle(b,{create:!0})).createSyncAccessHandle()).close();return await V,await R.removeEntry(b),V!=null&&V.then&&c("The local OPFS API is too old for opfs-sahpool:","it has an async FileSystemSyncAccessHandle.close() method."),!0};t.installOpfsSAHPoolVfs=async function(R=Object.create(null)){var C;R=Object.assign(Object.create(null),N,R||{});const b=R.name;if(R.$testThrowPhase1)throw R.$testThrowPhase1;if(r[b])try{return await r[b]}catch(z){if(R.forceReinitIfPreviouslyFailed)delete r[b];else throw z}return!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!((C=navigator==null?void 0:navigator.storage)!=null&&C.getDirectory)?r[b]=Promise.reject(new Error("Missing required OPFS APIs.")):r[b]=ne().then(async function(){if(R.$testThrowPhase2)throw R.$testThrowPhase2;const z=new M(R);return z.isReady.then(async()=>{const V=new Q(z);if(t.oo1){const Y=t.oo1,fe=z.getVfs(),be=function(...k){const $=Y.DB.dbCtorHelper.normalizeArgs(...k);$.vfs=fe.$zName,Y.DB.dbCtorHelper.call(this,$)};be.prototype=Object.create(Y.DB.prototype),V.OpfsSAHPoolDb=be}return z.log("VFS initialized."),V}).catch(async V=>{throw await z.removeVfs().catch(()=>{}),V})}).catch(z=>r[b]=Promise.reject(z))}}),typeof n>"u")throw console.warn("This is not running in the context of Module.runSQLite3PostLoadInit()"),new Error("sqlite3-api-cleanup.js expects to be running in the context of its Emscripten module loader.");try{const t=Object.assign(Object.create(null),globalThis.sqlite3ApiBootstrap.defaultConfig,globalThis.sqlite3ApiConfig||{},{memory:typeof $e<"u"?$e:n.wasmMemory,exports:typeof lt<"u"?lt:Object.prototype.hasOwnProperty.call(n,"wasmExports")?n.wasmExports:n.asm});t.wasmPtrIR=typeof t.exports.sqlite3_libversion()=="number"?"i32":"i64";const c=e;c.debugModule("Bootstrapping lib config",c);const i=globalThis.sqlite3ApiBootstrap(t);return delete globalThis.sqlite3ApiBootstrap,i}catch(t){throw console.error("sqlite3ApiBootstrap() error:",t),t}throw new Error("Maintenance required: this line should never be reached")},kt?ie=_:ie=new Promise((e,n)=>{rt=e,it=n}),ie}ve=(function(){var Oe,Le;const Te=ve;if(!Te)throw new Error("Expecting globalThis.sqlite3InitModule to be defined by the Emscripten build.");const ie=globalThis.sqlite3InitModuleState=Object.assign(Object.create(null),{moduleScript:(Oe=globalThis==null?void 0:globalThis.document)==null?void 0:Oe.currentScript,isWorker:typeof WorkerGlobalScope<"u",location:globalThis.location,urlParams:(Le=globalThis==null?void 0:globalThis.location)!=null&&Le.href?new URL(globalThis.location.href).searchParams:new URLSearchParams,wasmFilename:"sqlite3.wasm"});if(ie.debugModule=ie.urlParams.has("sqlite3.debugModule")?(...Ee)=>console.warn("sqlite3.debugModule:",...Ee):()=>{},ie.urlParams.has("sqlite3.dir"))ie.sqlite3Dir=ie.urlParams.get("sqlite3.dir")+"/";else if(ie.moduleScript){const Ee=ie.moduleScript.src.split("/");Ee.pop(),ie.sqlite3Dir=Ee.join("/")+"/"}const _=globalThis.sqlite3InitModule=function Ee(...Ae){return Te(...Ae).then(Me=>{ie.debugModule("sqlite3InitModule() sIMS =",ie),ie.debugModule("sqlite3InitModule() EmscriptenModule =",Me);const Je=Me.runSQLite3PostLoadInit(ie,Me,!!Ee.__isUnderTest);return ie.debugModule("sqlite3InitModule() sqlite3 =",Je),Je}).catch(Me=>{throw console.error("Exception loading sqlite3 module:",Me),Me})};if(_.ready=Te.ready,ie.moduleScript){let Ee=ie.moduleScript.src.split("/");Ee.pop(),ie.scriptDir=Ee.join("/")+"/"}return ie.debugModule("extern-post-js.c-pp.js sqlite3InitModuleState =",ie),_})();var Fe=ve;globalThis.sqlite3Worker1Promiser=function Te(ie=Te.defaultConfig){if(arguments.length===1&&typeof arguments[0]=="function"){const _e=ie;ie=Object.assign(Object.create(null),Te.defaultConfig),ie.onready=_e}else ie=Object.assign(Object.create(null),Te.defaultConfig,ie);const _=Object.create(null),Oe=function(){},Le=ie.onerror||Oe,Ee=ie.debug||Oe,Ae=ie.generateMessageId?void 0:Object.create(null),Me=ie.generateMessageId||function(_e){return _e.type+"#"+(Ae[_e.type]=(Ae[_e.type]||0)+1)},Je=(..._e)=>{throw new Error(_e.join(" "))};ie.worker||(ie.worker=Te.defaultConfig.worker),typeof ie.worker=="function"&&(ie.worker=ie.worker());let Ve,Xe;return ie.worker.onmessage=function(_e){_e=_e.data,Ee("worker1.onmessage",_e);let Ie=_[_e.messageId];if(!Ie){if(_e&&_e.type==="sqlite3-api"&&_e.result==="worker1-ready"){ie.onready&&ie.onready(Xe);return}if(Ie=_[_e.type],Ie&&Ie.onrow){Ie.onrow(_e);return}ie.onunhandled?ie.onunhandled(arguments[0]):Le("sqlite3Worker1Promiser() unhandled worker message:",_e);return}switch(delete _[_e.messageId],_e.type){case"error":Ie.reject(_e);return;case"open":Ve||(Ve=_e.dbId);break;case"close":_e.dbId===Ve&&(Ve=void 0);break}try{Ie.resolve(_e)}catch(We){Ie.reject(We)}},Xe=function(){let _e;arguments.length===1?_e=arguments[0]:arguments.length===2?(_e=Object.create(null),_e.type=arguments[0],_e.args=arguments[1],_e.dbId=_e.args.dbId):Je("Invalid arguments for sqlite3Worker1Promiser()-created factory."),!_e.dbId&&_e.type!=="open"&&(_e.dbId=Ve),_e.messageId=Me(_e),_e.departureTime=performance.now();const Ie=Object.create(null);Ie.message=_e;let We;_e.type==="exec"&&_e.args&&(typeof _e.args.callback=="function"?(We=_e.messageId+":row",Ie.onrow=_e.args.callback,_e.args.callback=We,_[We]=Ie):typeof _e.args.callback=="string"&&Je("exec callback may not be a string when using the Promise interface."));let nt=new Promise(function(rt,it){Ie.resolve=rt,Ie.reject=it,_[_e.messageId]=Ie,Ee("Posting",_e.type,"message to Worker dbId="+(Ve||"default")+":",_e),ie.worker.postMessage(_e)});return We&&(nt=nt.finally(()=>delete _[We])),nt}},globalThis.sqlite3Worker1Promiser.defaultConfig={worker:function(){return new Worker(new URL(""+new URL("sqlite3-worker1-SjBAs1pq.js",self.location.href).href,self.location.href))},onerror:(...Te)=>console.error("worker1 promiser error",...Te)},globalThis.sqlite3Worker1Promiser.v2=(function Te(ie=Te.defaultConfig){let _;typeof ie=="function"?(_=ie,ie={}):typeof(ie==null?void 0:ie.onready)=="function"&&(_=ie.onready,delete ie.onready);const Oe=Object.create(null);ie=Object.assign(ie||Object.create(null),{onready:async function(Ee){try{_&&await _(Ee),Oe.resolve(Ee)}catch(Ae){Oe.reject(Ae)}}});const Le=new Promise(function(Ee,Ae){Oe.resolve=Ee,Oe.reject=Ae});try{this.original(ie)}catch(Ee){Oe.reject(Ee)}return Le}).bind({original:sqlite3Worker1Promiser}),globalThis.sqlite3Worker1Promiser.v2.defaultConfig=globalThis.sqlite3Worker1Promiser.defaultConfig,sqlite3Worker1Promiser.v2;let De=null;const It=async()=>{if(!De)try{const Te=await fetch("/sqlite3.wasm").then(_=>{if(!_.ok)throw new Error(`Failed to fetch WASM: ${_.status} ${_.statusText}`);return _.arrayBuffer()}),ie=await Fe({print:console.log,printErr:console.error,wasmBinary:Te});ie.capi.sqlite3_vfs_find("opfs")?(De=new ie.oo1.OpfsDb("/nimo.sqlite3"),console.log("Running SQLite3 with OPFS backend")):(De=new ie.oo1.JsStorageDb("local"),console.log("Running SQLite3 with JsStorageDb (KVVFS/LocalStorage) backend")),De.exec(`
      CREATE TABLE IF NOT EXISTS fragments (
        id TEXT PRIMARY KEY,
        date TEXT NOT NULL,
        content TEXT NOT NULL,
        timestamp INTEGER NOT NULL,
        tags TEXT
      );
      
      CREATE TABLE IF NOT EXISTS diary_entries (
        date TEXT PRIMARY KEY,
        title TEXT NOT NULL,
        content TEXT NOT NULL,
        mood TEXT NOT NULL,
        reflection TEXT NOT NULL,
        tags TEXT NOT NULL,
        created_at INTEGER
      );
      
      CREATE INDEX IF NOT EXISTS idx_fragments_date ON fragments(date);
      CREATE INDEX IF NOT EXISTS idx_fragments_timestamp ON fragments(timestamp);
    `),console.log("Database schema initialized")}catch(Te){throw console.error("Failed to initialize SQLite worker:",Te),Te}};self.onmessage=async Te=>{const{id:ie,type:_,sql:Oe,params:Le,method:Ee}=Te.data;if(_==="init"){try{await It();const Ae=De&&De.constructor.name==="OpfsDb";self.postMessage({id:ie,type:"init_result",success:!0,backend:Ae?"OPFS":"KVVFS/LocalStorage"})}catch(Ae){self.postMessage({id:ie,type:"init_result",success:!1,error:Ae.message})}return}De||await It();try{let Ae;switch(Ee){case"run":De.exec({sql:Oe,bind:Le}),Ae=[];break;case"all":Ae=De.exec({sql:Oe,bind:Le,returnValue:"resultRows",rowMode:"object"})||[];break;case"get":Ae=De.exec({sql:Oe,bind:Le,returnValue:"resultRows",rowMode:"object"})[0]||null;break;case"values":Ae=De.exec({sql:Oe,bind:Le,returnValue:"resultRows",rowMode:"array"})||[];break;default:Ae=De.exec({sql:Oe,bind:Le,returnValue:"resultRows",rowMode:"object"})||[]}self.postMessage({id:ie,success:!0,data:Ae})}catch(Ae){console.error("Worker SQL Error:",Ae),self.postMessage({id:ie,success:!1,error:Ae.message})}}})();
